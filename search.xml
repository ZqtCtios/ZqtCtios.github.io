<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>02_æµ…å±‚ç¥ç»ç½‘ç»œ(Shallow neural networks)</title>
      <link href="2020/12/14/machinelearning/andrew-ng-deeplearning/02-shallow-neural-networks/"/>
      <url>2020/12/14/machinelearning/andrew-ng-deeplearning/02-shallow-neural-networks/</url>
      
        <content type="html"><![CDATA[<h1 id="æµ…å±‚ç¥ç»ç½‘ç»œï¼ˆShallow-neural-networksï¼‰"><a href="#æµ…å±‚ç¥ç»ç½‘ç»œï¼ˆShallow-neural-networksï¼‰" class="headerlink" title="æµ…å±‚ç¥ç»ç½‘ç»œï¼ˆShallow neural networksï¼‰"></a>æµ…å±‚ç¥ç»ç½‘ç»œï¼ˆShallow neural networksï¼‰</h1><h2 id="1-ç¥ç»ç½‘ç»œæ¦‚è¿°ï¼ˆNeural-Network-Overviewï¼‰"><a href="#1-ç¥ç»ç½‘ç»œæ¦‚è¿°ï¼ˆNeural-Network-Overviewï¼‰" class="headerlink" title="1.ç¥ç»ç½‘ç»œæ¦‚è¿°ï¼ˆNeural Network Overviewï¼‰"></a>1.ç¥ç»ç½‘ç»œæ¦‚è¿°ï¼ˆNeural Network Overviewï¼‰</h2><p>ç¥ç»ç½‘ç»œçœ‹èµ·æ¥æ˜¯å¦‚ä¸‹è¿™ä¸ªæ ·å­</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214164209143.png" alt="Neural Network"></p><p>ä½ å¯ä»¥æŠŠè®¸å¤šsigmoid å•å…ƒå †å èµ·æ¥å½¢æˆä¸€ä¸ªç¥ç»ç½‘ç»œã€‚å¯¹äºå›¾ä¸­çš„èŠ‚ç‚¹ï¼Œå®ƒåŒ…å«äº†ä¹‹å‰è®²çš„è®¡ç®—çš„ä¸¤ä¸ªæ­¥éª¤</p><ul><li><p>é¦–å…ˆé€šè¿‡è®¡ç®—å‡ºå€¼$ğ‘§$</p></li><li><p>ç„¶åé€šè¿‡$\sigma(z)$è®¡ç®—å€¼$ğ‘$ã€‚</p><script type="math/tex; mode=display">\left.\begin{array}{l}x \\w \\b\end{array}\right\} \Longrightarrow z=w^{T} x+b \Longrightarrow a=\sigma(z)</script></li></ul><h2 id="2-ç¥ç»ç½‘ç»œçš„è¡¨ç¤ºï¼ˆNeural-Network-Representationï¼‰"><a href="#2-ç¥ç»ç½‘ç»œçš„è¡¨ç¤ºï¼ˆNeural-Network-Representationï¼‰" class="headerlink" title="2.ç¥ç»ç½‘ç»œçš„è¡¨ç¤ºï¼ˆNeural Network Representationï¼‰"></a>2.ç¥ç»ç½‘ç»œçš„è¡¨ç¤ºï¼ˆNeural Network Representationï¼‰</h2><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214164452683.png" alt="Neural Network"></p><ul><li>è¾“å…¥å±‚ï¼šåŒ…å«äº†ç¥ç»ç½‘ç»œçš„è¾“å…¥ï¼Œä¾‹å¦‚é€”ä¸­è¾“å…¥ç‰¹å¾$ğ‘¥_1$ ã€$ğ‘¥_2$ ã€$ğ‘¥_3$ ï¼Œå®ƒä»¬è¢«ç«–ç›´åœ°å †å èµ·æ¥</li><li>éšè—å±‚ï¼šè¾“å…¥å±‚ä¸è¾“å‡ºå±‚ä¹‹é—´èŠ‚ç‚¹</li><li>è¾“å‡ºå±‚ï¼šè´Ÿè´£äº§ç”Ÿé¢„æµ‹å€¼</li></ul><p>ç¬¦å·è¡¨ç¤ºï¼š</p><ul><li>$ğ‘¥$ï¼šè¡¨ç¤ºè¾“å…¥ç‰¹å¾ï¼Œå¯ä»¥ç”¨$ğ‘^{[0]}$è¡¨ç¤º</li><li>$a_j^{[i]}$ï¼šç¬¬$i$å±‚èŠ‚ç‚¹çš„ç¬¬$j$ä¸ªèŠ‚ç‚¹</li><li>å‚æ•°$ğ‘Š$ å’Œ$ğ‘$ ï¼š$ğ‘Š$æ˜¯ä¸€ä¸ª 4x3 çš„çŸ©é˜µï¼Œè€Œ$ğ‘$æ˜¯ä¸€ä¸ª 4x1 çš„å‘é‡</li></ul><h2 id="3-è®¡ç®—ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼ˆComputingaNeuralNetworkâ€™s-outputï¼‰"><a href="#3-è®¡ç®—ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼ˆComputingaNeuralNetworkâ€™s-outputï¼‰" class="headerlink" title="3.è®¡ç®—ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼ˆComputingaNeuralNetworkâ€™s outputï¼‰"></a>3.è®¡ç®—ä¸€ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼ˆComputingaNeuralNetworkâ€™s outputï¼‰</h2><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214165233518.png" alt="ä¸¤å±‚ç½‘ç»œç»“æ„"></p><p>ğ‘¥è¡¨ç¤ºè¾“å…¥ç‰¹å¾ï¼Œğ‘è¡¨ç¤ºæ¯ä¸ªç¥ç»å…ƒçš„è¾“å‡ºï¼Œğ‘Šè¡¨ç¤ºç‰¹å¾çš„æƒé‡ï¼Œä¸Šæ ‡è¡¨ç¤ºç¥ç»ç½‘ç»œçš„å±‚æ•°ï¼Œä¸‹æ ‡è¡¨ç¤ºè¯¥å±‚çš„ç¬¬å‡ ä¸ªç¥ç»å…ƒã€‚è¿™æ˜¯ç¥ç»ç½‘ç»œçš„ç¬¦å·æƒ¯ä¾‹ï¼Œä¸‹åŒã€‚</p><h3 id="ç¥ç»ç½‘ç»œçš„è®¡ç®—"><a href="#ç¥ç»ç½‘ç»œçš„è®¡ç®—" class="headerlink" title="ç¥ç»ç½‘ç»œçš„è®¡ç®—"></a>ç¥ç»ç½‘ç»œçš„è®¡ç®—</h3><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214165343752.png" alt="image-20201214165343752"></p><p>å›åˆ°ä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬ä»éšè—å±‚çš„ç¬¬ä¸€ä¸ªç¥ç»å…ƒå¼€å§‹è®¡ç®—ï¼Œå¦‚ä¸Šå›¾ç¬¬ä¸€ä¸ªæœ€ä¸Šé¢çš„ç®­å¤´æ‰€æŒ‡ã€‚ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œè¾“å…¥ä¸é€»è¾‘å›å½’ç›¸ä¼¼ï¼Œè¿™ä¸ªç¥ç»å…ƒçš„è®¡ç®—ä¸é€»è¾‘å›å½’ä¸€æ ·åˆ†ä¸ºä¸¤æ­¥ï¼Œå°åœ†åœˆä»£è¡¨äº†è®¡ç®—çš„ä¸¤ä¸ªæ­¥éª¤ã€‚</p><ul><li>ç¬¬ä¸€æ­¥ï¼Œ è®¡ç®— $z_{1}^{[1]}, z_{1}^{[1]}=w_{1}^{[1] T} x+b_{1}^{[1]}$</li><li>ç¬¬äºŒæ­¥ï¼Œé€šè¿‡æ¿€æ´»å‡½æ•°è®¡ç®— $a_{1}^{[1]}, a_{1}^{[1]}=\sigma\left(z_{1}^{[1]}\right)$ ã€‚</li></ul><p>éšè—å±‚çš„ç¬¬äºŒä¸ªä»¥åŠåé¢ä¸¤ä¸ªç¥ç»å…ƒçš„è®¡ç®—è¿‡ç¨‹ä¸€æ ·ï¼Œåªæ˜¯æ³¨æ„ç¬¦å·è¡¨ç¤ºä¸åŒï¼Œæœ€ç»ˆåˆ†åˆ«å¾—åˆ° $a_{2}^{[1]}, a_{3}^{[1]}, a_{4}^{[1]},$ è¯¦ç»†ç»“æœè§ä¸‹:</p><script type="math/tex; mode=display">\begin{array}{l}z_{1}^{[1]}=w_{1}^{[1] T} x+b_{1}^{[1]}, a_{1}^{[1]}=\sigma\left(z_{1}^{[1]}\right) \\z_{2}^{[1]}=w_{2}^{[1] T} x+b_{2}^{[1]}, a_{2}^{[1]}=\sigma\left(z_{2}^{[1]}\right) \\z_{3}^{[1]}=w_{3}^{[1] T} x+b_{3}^{[1]}, a_{3}^{[1]}=\sigma\left(z_{3}^{[1]}\right) \\z_{4}^{[1]}=w_{4}^{[1] T} x+b_{4}^{[1]}, a_{4}^{[1]}=\sigma\left(z_{4}^{[1]}\right)\end{array}</script><h3 id="å‘é‡åŒ–è®¡ç®—"><a href="#å‘é‡åŒ–è®¡ç®—" class="headerlink" title="å‘é‡åŒ–è®¡ç®—"></a>å‘é‡åŒ–è®¡ç®—</h3><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214165605526.png" alt="Z"></p><p>Given input $\mathrm{x}$ï¼š</p><script type="math/tex; mode=display">\begin{array}{l}z^{[1]}=W^{[1]} x+b^{[1]} \\a^{[1]}=\sigma\left(z^{[1]}\right) \\z^{[2]}=W^{[2]} a^{[1]}+b^{[2]} \\a^{[2]}=\sigma\left(z^{[2]}\right)\end{array}</script><h2 id="4-å¤šæ ·æœ¬å‘é‡åŒ–ï¼ˆVectorizing-across-multiple-examplesï¼‰"><a href="#4-å¤šæ ·æœ¬å‘é‡åŒ–ï¼ˆVectorizing-across-multiple-examplesï¼‰" class="headerlink" title="4.å¤šæ ·æœ¬å‘é‡åŒ–ï¼ˆVectorizing across multiple examplesï¼‰"></a>4.å¤šæ ·æœ¬å‘é‡åŒ–ï¼ˆVectorizing across multiple examplesï¼‰</h2><p>å…¬å¼ 3.12 :</p><script type="math/tex; mode=display">x=\left[\begin{array}{llll}\vdots & \vdots & \vdots & \vdots \\x^{(1)} & x^{(2)} & \cdots & x^{(m)} \\\vdots & \vdots & \vdots & \vdots\end{array}\right]</script><p>å…¬å¼ 3.13 :</p><script type="math/tex; mode=display">Z^{[1]}=\left[\begin{array}{clll}\vdots & \vdots & \vdots & \vdots \\z^{[1](1)} & z^{[1](2)} & \cdots & z^{[1](m)} \\\vdots & \vdots & \vdots & \vdots\end{array}\right]</script><p>å…¬å¼ 3.14 :</p><script type="math/tex; mode=display">A^{[1]}=\left[\begin{array}{clll}\vdots & \vdots & \vdots & \vdots \\\alpha^{[1](1)} & \alpha^{[1](2)} & \cdots & \alpha^{[1](m)} \\\vdots & \vdots & \vdots & \vdots\end{array}\right]</script><p>å…¬å¼ 3.15 :</p><script type="math/tex; mode=display">\left.\begin{array}{rl}z^{[1](i)}=W^{[1](i)} x^{(i)}+b^{[1]} \\\alpha^{[1](i)}=\sigma\left(z^{[1](i)}\right) \\z^{[2](i)}=W^{[2](i)} \alpha^{[1](i)}+b^{[2]} \\\alpha^{[2](i)}=\sigma\left(z^{[2](i)}\right)\end{array}\right\} \Rightarrow\left\{\begin{array}{l}A^{[1]}=\sigma\left(z^{[1]}\right) \\z^{[2]}=W^{[2]} A^{[1]}+b^{[2]} \\A^{[2]}=\sigma\left(z^{[2]}\right)\end{array}\right.</script><p>å®šä¹‰çŸ©é˜µXç­‰äºè®­ç»ƒæ ·æœ¬ï¼Œå°†å®ƒä»¬ç»„åˆæˆçŸ©é˜µçš„å„åˆ—ï¼Œå½¢æˆä¸€ä¸ªnç»´æˆ–nä¹˜ä»¥mç»´çŸ©é˜µã€‚æ¥ä¸‹æ¥è®¡ç®—è§å…¬å¼ 3.15:</p><p>ä»¥æ­¤ç±»æ¨ï¼Œä»å°å†™çš„å‘é‡xåˆ°è¿™ä¸ªå¤§å†™çš„çŸ©é˜µ $X,$ åªæ˜¯é€šè¿‡ç»„åˆ $x$ å‘é‡åœ¨çŸ©é˜µçš„å„åˆ—ä¸­ã€‚</p><p>åŒç†ï¼Œ $z^{<a href="1">1</a>}, z^{<a href="2">1</a>}$ç­‰ç­‰éƒ½æ˜¯$z^{<a href="m">1</a>}$çš„åˆ—å‘é‡ï¼Œå°†æ‰€æœ‰ğ‘šéƒ½ç»„åˆåœ¨å„åˆ—ä¸­ï¼Œå°±çš„åˆ°çŸ©é˜µ$Z^{[1]}$</p><p>åŒç†ï¼Œ $a^{<a href="1">1</a>}, a^{<a href="2">1</a>}, \ldots \ldots, a^{<a href="m">1</a>}$ å°†å…¶ç»„åˆåœ¨çŸ©é˜µå„åˆ—ä¸­ï¼Œå¦‚åŒä»å‘é‡xåˆ°çŸ©é˜µ $X,$ ä»¥åŠä»å‘é‡zåˆ°çŸ©é˜µ $Z$ ä¸€æ ·ï¼Œå°±èƒ½å¾—åˆ°çŸ©é˜µ $A^{[1]}$ ã€‚</p><p>åŒæ ·çš„ï¼Œå¯¹äº $Z^{[2]}$ å’Œ $A^{[2]},$ ä¹Ÿæ˜¯è¿™æ ·å¾—åˆ°ã€‚</p><h2 id="5-æ¿€æ´»å‡½æ•°ï¼ˆActivationfunctionsï¼‰"><a href="#5-æ¿€æ´»å‡½æ•°ï¼ˆActivationfunctionsï¼‰" class="headerlink" title="5.æ¿€æ´»å‡½æ•°ï¼ˆActivationfunctionsï¼‰"></a>5.æ¿€æ´»å‡½æ•°ï¼ˆActivationfunctionsï¼‰</h2><p>ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œæ—¶ï¼Œéœ€è¦å†³å®šä½¿ç”¨å“ªç§æ¿€æ´»å‡½æ•°ç”¨éšè—å±‚ä¸Šï¼Œå“ªç§ç”¨åœ¨è¾“å‡ºèŠ‚ç‚¹ä¸Šã€‚åˆ°ç›®å‰ä¸ºæ­¢, ä¹‹å‰åªç”¨è¿‡ sigmoid æ¿€æ´»å‡½æ•°, ä½†æ˜¯, æœ‰æ—¶å…¶ä»–çš„æ¿€æ´»å‡½æ•°æ•ˆæœä¼šæ›´å¥½ã€‚<br>åœ¨ç¥ç»ç½‘è·¯çš„å‰å‘ä¼ æ’­ä¸­, $a^{[1]}=\sigma\left(z^{[1]}\right)$ å’Œ $a^{[2]}=\sigma\left(z^{[2]}\right)$ è¿™ä¸¤æ­¥ä¼šä½¿ç”¨åˆ° sigmoid å‡½æ•°ã€‚sigmoid å‡½æ•°åœ¨è¿™é‡Œè¢«ç§°ä¸ºæ¿€æ´»å‡½æ•°ã€‚</p><script type="math/tex; mode=display">\quad a=\sigma(z)=\frac{1}{1+e^{-z}}</script><p>æ›´é€šå¸¸çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä¸åŒçš„å‡½æ•° $g\left(z^{[1]}\right), g$ å¯ä»¥æ˜¯é™¤äº† sigmoid å‡½æ•°æ„å¤–çš„éçº¿æ€§å‡½æ•°ã€‚tanh å‡½æ•°æˆ–è€…åŒæ›²æ­£åˆ‡å‡½æ•°æ˜¯æ€»ä½“ä¸Šéƒ½ä¼˜äº sigmoid å‡½æ•°çš„æ¿€æ´»å‡½æ•°ã€‚$a=\tan (z)$ çš„å€¼åŸŸæ˜¯ä½äº+1 å’Œ-1 ä¹‹é—´ã€‚</p><script type="math/tex; mode=display">\quad a=\tanh (z)=\frac{e^{z}-e^{-z}}{e^{z}+e^{-z}}</script><p>å€¼åŸŸä»‹äº+1 å’Œ-1 ä¹‹é—´ã€‚ç»“æœè¡¨æ˜ï¼Œå¦‚æœåœ¨éšè—å±‚ä¸Šä½¿ç”¨å‡½æ•°$\quad g\left(z^{[1]}\right)=\tanh \left(z^{[1]}\right)$ æ•ˆæœæ€»æ˜¯ä¼˜äº sigmoid å‡½æ•°ã€‚å› ä¸ºå‡½æ•°å€¼åŸŸåœ¨-1 å’Œ+1çš„æ¿€æ´»å‡½æ•°ï¼Œå…¶å‡å€¼æ˜¯æ›´æ¥è¿‘é›¶å‡å€¼çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/TanhReal.gif" alt="tanx"></p><p>åœ¨è®­ç»ƒä¸€ä¸ªç®—æ³•æ¨¡å‹æ—¶ï¼Œå¦‚æœä½¿ç”¨ tanh å‡½æ•°ä»£æ›¿sigmoid å‡½æ•°ä¸­å¿ƒåŒ–æ•°æ®ï¼Œä½¿å¾—æ•°æ®çš„å¹³å‡å€¼æ›´æ¥è¿‘ 0 è€Œä¸æ˜¯ $0.5 .$</p><p>æœ‰ä¸€ä¸ªä¾‹å¤–:åœ¨äºŒåˆ†ç±»çš„é—®é¢˜ä¸­ï¼Œå¯¹äºè¾“å‡ºå±‚ï¼Œå› ä¸ºğ‘¦çš„å€¼æ˜¯ 0 æˆ– 1ï¼Œæ‰€ä»¥æƒ³è®©ğ‘¦çš„æ•°å€¼ä»‹äº 0 å’Œ 1 ä¹‹é—´ï¼Œè€Œä¸æ˜¯åœ¨-1 å’Œ+1 ä¹‹é—´ã€‚æ‰€ä»¥éœ€è¦ä½¿ç”¨ sigmoid æ¿€æ´»å‡½æ•°ã€‚</p><h3 id="ä¿®æ­£çº¿æ€§å•å…ƒçš„å‡½æ•°-ReLu"><a href="#ä¿®æ­£çº¿æ€§å•å…ƒçš„å‡½æ•°-ReLu" class="headerlink" title="ä¿®æ­£çº¿æ€§å•å…ƒçš„å‡½æ•°(ReLu)"></a>ä¿®æ­£çº¿æ€§å•å…ƒçš„å‡½æ•°(ReLu)</h3><p>ReLu å‡½æ•°å›¾åƒæ˜¯å¦‚ä¸‹å›¾ã€‚ </p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/0*g9ypL5M3k-f7EW85.png" alt="ReLu"></p><script type="math/tex; mode=display">ğ‘ = ğ‘šğ‘ğ‘¥(0, ğ‘§)</script><p>æ‰€ä»¥ï¼Œåªè¦ğ‘§æ˜¯æ­£å€¼çš„æƒ…å†µä¸‹ï¼Œå¯¼æ•°æ’ç­‰äº 1ï¼Œå½“ğ‘§æ˜¯è´Ÿå€¼çš„æ—¶å€™ï¼Œå¯¼æ•°æ’ç­‰äº 0ã€‚</p><p>ä»å®é™…ä¸Šæ¥è¯´ï¼Œå½“ä½¿ç”¨ğ‘§çš„å¯¼æ•°æ—¶ï¼Œğ‘§=0 çš„å¯¼æ•°æ˜¯æ²¡æœ‰å®šä¹‰çš„ã€‚ä½†æ˜¯å½“ç¼–ç¨‹å®ç°çš„æ—¶å€™ï¼Œğ‘§çš„å–å€¼åˆšå¥½ç­‰äº 0.00000001ï¼Œè¿™ä¸ªå€¼ç›¸å½“å°ï¼Œæ‰€ä»¥ï¼Œåœ¨å®è·µä¸­ï¼Œä¸éœ€è¦æ‹…å¿ƒè¿™ä¸ªå€¼ï¼Œğ‘§æ˜¯ç­‰äº 0 çš„æ—¶å€™ï¼Œå‡è®¾ä¸€ä¸ªå¯¼æ•°æ˜¯ 1 æˆ–è€… 0 æ•ˆæœéƒ½å¯ä»¥ã€‚</p><h3 id="é€‰æ‹©æ¿€æ´»å‡½æ•°çš„ç»éªŒæ³•åˆ™"><a href="#é€‰æ‹©æ¿€æ´»å‡½æ•°çš„ç»éªŒæ³•åˆ™" class="headerlink" title="é€‰æ‹©æ¿€æ´»å‡½æ•°çš„ç»éªŒæ³•åˆ™"></a>é€‰æ‹©æ¿€æ´»å‡½æ•°çš„ç»éªŒæ³•åˆ™</h3><ul><li>sigmoid æ¿€æ´»å‡½æ•°ï¼šé™¤äº†è¾“å‡ºå±‚æ˜¯ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜åŸºæœ¬ä¸ä¼šç”¨å®ƒã€‚</li><li>tanhæ¿€æ´»å‡½æ•°ï¼štanhæ˜¯éå¸¸ä¼˜ç§€çš„ï¼Œå‡ ä¹é€‚åˆæ‰€æœ‰åœºåˆã€‚</li><li>ReLuæ¿€æ´»å‡½æ•°ï¼šæœ€å¸¸ç”¨çš„é»˜è®¤å‡½æ•°ï¼Œå¦‚æœä¸ç¡®å®šç”¨å“ªä¸ªæ¿€æ´»å‡½æ•°ï¼Œå°±ä½¿ç”¨ ReLu æˆ–è€…Leaky ReLuã€‚</li></ul><h2 id="6-æ¿€æ´»å‡½æ•°çš„å¯¼æ•°ï¼ˆDerivatives-of-activation-functionsï¼‰"><a href="#6-æ¿€æ´»å‡½æ•°çš„å¯¼æ•°ï¼ˆDerivatives-of-activation-functionsï¼‰" class="headerlink" title="6.æ¿€æ´»å‡½æ•°çš„å¯¼æ•°ï¼ˆDerivatives of activation functionsï¼‰"></a>6.æ¿€æ´»å‡½æ•°çš„å¯¼æ•°ï¼ˆDerivatives of activation functionsï¼‰</h2><p>é’ˆå¯¹ä»¥ä¸‹å››ç§æ¿€æ´»ï¼Œæ±‚å…¶å¯¼æ•°å¦‚ä¸‹ï¼š</p><h3 id="6-1-sigmoid-activation-function"><a href="#6-1-sigmoid-activation-function" class="headerlink" title="6.1 sigmoid  activation function"></a>6.1 sigmoid  activation function</h3><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214172035239.png" alt="sigmoid function"></p><script type="math/tex; mode=display">\frac{d}{d z} g(z)=\frac{1}{1+e^{-z}}\left(1-\frac{1}{1+e^{-z}}\right)=g(z)(1-g(z))=a(1-a)</script><h3 id="6-2-Tanh-activation-function"><a href="#6-2-Tanh-activation-function" class="headerlink" title="6.2 Tanh activation function"></a>6.2 Tanh activation function</h3><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214172250352.png" alt="Tanh activation function"></p><script type="math/tex; mode=display">g(z)=\tanh (z)=\frac{e^{z}-e^{-z}}{e^{z}+e^{-z}}</script><script type="math/tex; mode=display">\frac{d}{\mathrm{~d} z} g(z)=1-(\tanh (z))^{2}</script><h3 id="6-3-Rectified-Linear-Unit"><a href="#6-3-Rectified-Linear-Unit" class="headerlink" title="6.3 Rectified Linear Unit"></a>6.3 Rectified Linear Unit</h3><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214172357648.png" alt="Rectified Linear Unit"></p><script type="math/tex; mode=display">\begin{array}{c}g(z)=\max (0, z) \\0 \\g(z)^{\prime}=\left\{\begin{array}{ll}0 & \text { if } \quad z<0 \\\text { undefined } & \text { if } \quad z>0 \\\text { if } \quad z & =0\end{array}\right.\end{array}</script><h3 id="6-4-Leaky-linear-unit-ï¼ˆLeaky-ReLUï¼‰"><a href="#6-4-Leaky-linear-unit-ï¼ˆLeaky-ReLUï¼‰" class="headerlink" title="6.4 Leaky linear unit ï¼ˆLeaky ReLUï¼‰"></a>6.4 Leaky linear unit ï¼ˆLeaky ReLUï¼‰</h3><p>ä¸ ReLU ç±»ä¼¼:</p><script type="math/tex; mode=display">\begin{array}{c}g(z)=\max (0.01 z, z) \\g(z)^{\prime}=\left\{\begin{array}{ll}0.01 & \text { if } \quad z<0 \\1 & \text { if } \quad z>0 \\u n d e f i n e d & \text { if } \quad z=0\end{array}\right.\end{array}</script>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>01_ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics of Neural Network programmingï¼‰</title>
      <link href="2020/12/12/machinelearning/andrew-ng-deeplearning/01-basics-of-neural-network/"/>
      <url>2020/12/12/machinelearning/andrew-ng-deeplearning/01-basics-of-neural-network/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics-of-Neural-Network-programmingï¼‰"><a href="#ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics-of-Neural-Network-programmingï¼‰" class="headerlink" title="ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics of Neural Network programmingï¼‰"></a>ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€ï¼ˆBasics of Neural Network programmingï¼‰</h1><h2 id="1-äºŒåˆ†ç±»ï¼ˆBinary-Classificationï¼‰"><a href="#1-äºŒåˆ†ç±»ï¼ˆBinary-Classificationï¼‰" class="headerlink" title="1.äºŒåˆ†ç±»ï¼ˆBinary Classificationï¼‰"></a>1.äºŒåˆ†ç±»ï¼ˆBinary Classificationï¼‰</h2><p>è¿™å‘¨æˆ‘ä»¬å°†å­¦ä¹ ç¥ç»ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†ï¼Œå…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“å®ç°ä¸€ä¸ªç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œ æˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€äº›éå¸¸é‡è¦çš„æŠ€æœ¯å’ŒæŠ€å·§ã€‚ä¾‹å¦‚æœ‰ä¸€ä¸ªåŒ…å«ğ‘šä¸ªæ ·æœ¬çš„è®­ç»ƒé›†ï¼Œä½ å¾ˆå¯èƒ½ä¹  æƒ¯äºç”¨ä¸€ä¸ª for å¾ªç¯æ¥éå†è®­ç»ƒé›†ä¸­çš„æ¯ä¸ªæ ·æœ¬ï¼Œä½†æ˜¯å½“å®ç°ä¸€ä¸ªç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œæˆ‘ä»¬é€š å¸¸ä¸ç›´æ¥ä½¿ç”¨ for å¾ªç¯æ¥éå†æ•´ä¸ªè®­ç»ƒé›†ï¼Œæ‰€ä»¥åœ¨è¿™å‘¨çš„è¯¾ç¨‹ä¸­ä½ å°†å­¦ä¼šå¦‚ä½•å¤„ç†è®­ç»ƒé›†ã€‚</p><p>å¦å¤–åœ¨ç¥ç»ç½‘ç»œçš„è®¡ç®—ä¸­ï¼Œé€šå¸¸å…ˆæœ‰ä¸€ä¸ªå«åšå‰å‘æš‚åœï¼ˆforward pauseï¼‰æˆ–å«åšå‰å‘ä¼ æ’­ ï¼ˆfoward propagationï¼‰çš„æ­¥éª¤ï¼Œæ¥ç€æœ‰ä¸€ä¸ªå«åšåå‘æš‚åœï¼ˆbackward pauseï¼‰ æˆ–å«åšåå‘ä¼ æ’­ ï¼ˆbackward propagationï¼‰çš„æ­¥éª¤ã€‚æ‰€ä»¥è¿™å‘¨æˆ‘ä¹Ÿä¼šå‘ä½ ä»‹ç»ä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹å¯ä»¥åˆ†ä¸ºå‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ä¸¤ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†ã€‚</p><p>åœ¨è¯¾ç¨‹ä¸­æˆ‘å°†ä½¿ç”¨é€»è¾‘å›å½’ï¼ˆlogistic regressionï¼‰æ¥ä¼ è¾¾è¿™äº›æƒ³æ³•ï¼Œä»¥ä½¿å¤§å®¶èƒ½å¤Ÿæ›´åŠ å®¹æ˜“åœ°ç†è§£è¿™äº›æ¦‚å¿µã€‚å³ä½¿ä½ ä¹‹å‰äº†è§£è¿‡é€»è¾‘å›å½’ï¼Œæˆ‘è®¤ä¸ºè¿™é‡Œè¿˜æ˜¯æœ‰äº›æ–°çš„ã€æœ‰è¶£çš„ä¸œè¥¿ç­‰ç€ä½ å»å‘ç°å’Œäº†è§£ï¼Œæ‰€ä»¥ç°åœ¨å¼€å§‹è¿›å…¥æ­£é¢˜ã€‚</p><p>é€»è¾‘å›å½’æ˜¯ä¸€ä¸ªç”¨äºäºŒåˆ†ç±»ï¼ˆbinary classificationï¼‰çš„ç®—æ³•ã€‚é¦–å…ˆæˆ‘ä»¬ä»ä¸€ä¸ªé—®é¢˜å¼€å§‹è¯´èµ·ï¼Œ è¿™é‡Œæœ‰ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜çš„ä¾‹å­ï¼Œå‡å¦‚ä½ æœ‰ä¸€å¼ å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼Œæ¯”å¦‚è¿™åªçŒ«ï¼Œå¦‚æœè¯†åˆ«è¿™å¼ å›¾ç‰‡ä¸ºçŒ«ï¼Œåˆ™è¾“å‡ºæ ‡ç­¾ 1 ä½œä¸ºç»“æœ;å¦‚æœè¯†åˆ«å‡ºä¸æ˜¯çŒ«ï¼Œé‚£ä¹ˆè¾“å‡ºæ ‡ç­¾ 0 ä½œä¸ºç»“æœã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨å­—æ¯ğ‘¦æ¥è¡¨ç¤ºè¾“å‡ºçš„ç»“æœæ ‡ç­¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210163758.png" alt="image-20201210163758119"></p><p>æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€å¼ å›¾ç‰‡åœ¨è®¡ç®—æœºä¸­æ˜¯å¦‚ä½•è¡¨ç¤ºçš„ï¼Œä¸ºäº†ä¿å­˜ä¸€å¼ å›¾ç‰‡ï¼Œéœ€è¦ä¿å­˜ä¸‰ä¸ªçŸ©é˜µï¼Œ å®ƒä»¬åˆ†åˆ«å¯¹åº”å›¾ç‰‡ä¸­çš„çº¢ã€ç»¿ã€è“ä¸‰ç§é¢œè‰²é€šé“ï¼Œå¦‚æœä½ çš„å›¾ç‰‡å¤§å°ä¸º 64x64 åƒç´ ï¼Œé‚£ä¹ˆä½  å°±æœ‰ä¸‰ä¸ªè§„æ¨¡ä¸º 64x64 çš„çŸ©é˜µï¼Œåˆ†åˆ«å¯¹åº”å›¾ç‰‡ä¸­çº¢ã€ç»¿ã€è“ä¸‰ç§åƒç´ çš„å¼ºåº¦å€¼ã€‚ä¸ºäº†ä¾¿äºè¡¨ ç¤ºï¼Œè¿™é‡Œæˆ‘ç”»äº†ä¸‰ä¸ªå¾ˆå°çš„çŸ©é˜µï¼Œæ³¨æ„å®ƒä»¬çš„è§„æ¨¡ä¸º 5x4 è€Œä¸æ˜¯ 64x64ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210163827.png" alt="image-20201210163827520"></p><p>ä¸ºäº†æŠŠè¿™äº›åƒç´ å€¼æ”¾åˆ°ä¸€ä¸ªç‰¹å¾å‘é‡ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›åƒç´ å€¼æå–å‡ºæ¥ï¼Œç„¶åæ”¾å…¥ä¸€ä¸ªç‰¹å¾å‘é‡ğ‘¥ã€‚ä¸ºäº†æŠŠè¿™äº›åƒç´ å€¼è½¬æ¢ä¸ºç‰¹å¾å‘é‡ ğ‘¥ï¼Œæˆ‘ä»¬éœ€è¦åƒä¸‹é¢è¿™æ ·å®šä¹‰ä¸€ä¸ªç‰¹å¾å‘é‡ ğ‘¥ æ¥è¡¨ç¤ºè¿™å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰çš„åƒç´ éƒ½å–å‡ºæ¥ï¼Œä¾‹å¦‚ 255ã€231 ç­‰ç­‰ï¼Œç›´åˆ°å–å®Œæ‰€æœ‰çš„çº¢è‰²åƒç´ ï¼Œæ¥ç€æœ€åæ˜¯ 255ã€134ã€â€¦ã€255ã€134 ç­‰ç­‰ï¼Œç›´åˆ°å¾—åˆ°ä¸€ä¸ªç‰¹å¾å‘é‡ï¼ŒæŠŠå›¾ç‰‡ä¸­æ‰€æœ‰çš„çº¢ã€ç»¿ã€è“åƒç´ å€¼éƒ½åˆ—å‡ºæ¥ã€‚å¦‚æœå›¾ç‰‡çš„å¤§å°ä¸º 64x64 åƒç´ ï¼Œé‚£ä¹ˆå‘é‡ ğ‘¥ çš„æ€»ç»´åº¦ï¼Œ å°†æ˜¯ 64 ä¹˜ä»¥ 64 ä¹˜ä»¥ 3ï¼Œè¿™æ˜¯ä¸‰ä¸ªåƒç´ çŸ©é˜µä¸­åƒç´ çš„æ€»é‡ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ç»“æœä¸º 12,288ã€‚ç° åœ¨æˆ‘ä»¬ç”¨$ğ‘›_ğ‘¥ = 12288$ï¼Œæ¥è¡¨ç¤ºè¾“å…¥ç‰¹å¾å‘é‡çš„ç»´åº¦ï¼Œæœ‰æ—¶å€™ä¸ºäº†ç®€æ´ï¼Œæˆ‘ä¼šç›´æ¥ç”¨å°å†™çš„ğ‘› æ¥è¡¨ç¤ºè¾“å…¥ç‰¹å¾å‘é‡ğ‘¥çš„ç»´åº¦ã€‚æ‰€ä»¥åœ¨äºŒåˆ†ç±»é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯ä¹ å¾—ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œå®ƒä»¥å›¾ç‰‡çš„ç‰¹å¾å‘é‡ä½œä¸ºè¾“å…¥ï¼Œç„¶åé¢„æµ‹è¾“å‡ºç»“æœğ‘¦ä¸º 1 è¿˜æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯é¢„æµ‹å›¾ç‰‡ä¸­æ˜¯å¦æœ‰çŒ«:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210163923.png" alt="image-20201210163923881"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯´æ˜ä¸€äº›åœ¨ä½™ä¸‹è¯¾ç¨‹ä¸­ï¼Œéœ€è¦ç”¨åˆ°çš„ä¸€äº›ç¬¦å·ã€‚</p><ul><li>$x:$ è¡¨ç¤ºä¸€ä¸ª $n_{x}$ ç»´æ•°æ®ï¼Œä¸ºè¾“å…¥æ•°æ®ï¼Œç»´åº¦ä¸º $\left(n_{x}, 1\right) ;$</li><li>$y:$ è¡¨ç¤ºè¾“å‡ºç»“æœï¼Œå–å€¼ä¸º (0,1)$;$</li><li>$\left(x^{(i)}, y^{(i)}\right):$ è¡¨ç¤ºç¬¬iç»„æ•°æ®ï¼Œå¯èƒ½æ˜¯è®­ç»ƒæ•°æ®ï¼Œä¹Ÿå¯èƒ½æ˜¯æµ‹è¯•æ•°æ®ï¼Œæ­¤å¤„é»˜è®¤ä¸ºè®­ç»ƒæ•°æ®;</li><li>$X=\left[x^{(1)}, x^{(2)}, \ldots, x^{(m)}\right]:$ è¡¨ç¤ºæ‰€æœ‰çš„è®­ç»ƒæ•°æ®é›†çš„è¾“å…¥å€¼, æ”¾åœ¨ä¸€ä¸ª $n_{x} \times m$ çš„çŸ©é˜µä¸­å…¶ä¸­ $m$ è¡¨ç¤ºæ ·æœ¬æ•°ç›®;</li><li>$Y=\left[y^{(1)}, y^{(2)}, \ldots, y^{(m)}\right]:$ å¯¹åº”è¡¨ç¤ºæ‰€æœ‰è®­ç»ƒæ•°æ®é›†çš„è¾“å‡ºå€¼ï¼Œç»´åº¦ä¸º1 $\times m_{\circ}$</li></ul><p>ç”¨ä¸€å¯¹ $(x, y)$ æ¥è¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„æ ·æœ¬ï¼Œxä»£è¡¨ $n_{x}$ ç»´çš„ç‰¹å¾å‘é‡ï¼Œ $y$ è¡¨ç¤ºæ ‡ç­¾(è¾“å‡ºç»“æœ)åªèƒ½ä¸º 0 æˆ– 1 ã€‚è€Œè®­ç»ƒé›†å°†ç”± $m$ ä¸ªè®­ç»ƒæ ·æœ¬ç»„æˆï¼Œå…¶ä¸­ $\left(x^{(1)}, y^{(1)}\right)$ è¡¨ç¤ºç¬¬ä¸€ä¸ªæ ·æœ¬çš„è¾“å…¥å’Œè¾“å‡º $,\left(x^{(2)}, y^{(2)}\right)$ è¡¨ç¤ºç¬¬äºŒä¸ªæ ·æœ¬çš„è¾“å…¥å’Œè¾“å‡ºï¼Œç›´åˆ°æœ€åä¸€ä¸ªæ ·æœ¬ $\left(x^{(m)}, y^{(m)}\right),$ ç„¶åæ‰€æœ‰çš„è¿™äº›ä¸€èµ·è¡¨ç¤ºæ•´ä¸ªè®­ç»ƒé›†ã€‚æœ‰æ—¶å€™ä¸ºäº†å¼ºè°ƒè¿™æ˜¯è®­ç»ƒæ ·æœ¬çš„ä¸ªæ•°ï¼Œä¼šå†™ä½œ $M_{t r a i n},$ å½“æ¶‰åŠåˆ°æµ‹è¯•é›†çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ $M_{t e s t}$ æ¥è¡¨ç¤ºæµ‹è¯•é›†çš„æ ·æœ¬æ•°ï¼Œæ‰€ä»¥è¿™æ˜¯æµ‹è¯•é›†çš„æ ·æœ¬æ•°:</p><script type="math/tex; mode=display">(x, y) \quad x \in \mathbb{R}^{n_{x}}, y \in\{0,1\}</script><script type="math/tex; mode=display">\left.\left\{\left(x^{(1)} \cdot y^{(1)}\right),\left(x^{(2}, y^{(2)}\right), \ldots, \ldots, \left(x^{(m)}, y^{(m)}\right)\right)\right\}</script><p>æœ€åä¸ºäº†èƒ½æŠŠè®­ç»ƒé›†è¡¨ç¤ºå¾—æ›´ç´§å¥ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä¼šå®šä¹‰ä¸€ä¸ªçŸ©é˜µç”¨å¤§å†™Xçš„è¡¨ç¤ºï¼Œå®ƒç”±è¾“å…¥å‘é‡ $x^{(1)} ã€ x^{(2)}$ ç­‰ç»„æˆï¼Œå¦‚ä¸‹å›¾æ”¾åœ¨çŸ©é˜µçš„åˆ—ä¸­ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬æŠŠ $x^{(1)}$ ä½œä¸ºç¬¬ä¸€åˆ—æ”¾åœ¨çŸ©é˜µä¸­ï¼Œ $x^{(2)}$ ä½œä¸ºç¬¬äºŒåˆ—ï¼Œ $x^{(m)}$ æ”¾åˆ°ç¬¬måˆ—ï¼Œç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†è®­ç»ƒé›†çŸ©é˜µ $X$ ã€‚æ‰€ä»¥è¿™ä¸ªçŸ©é˜µæœ‰ $m$åˆ—ï¼Œ $m$ æ˜¯è®­ç»ƒé›†çš„æ ·æœ¬æ•°é‡ï¼Œç„¶åè¿™ä¸ªçŸ©é˜µçš„é«˜åº¦è®°ä¸º $n_{x},$ æ³¨æ„æœ‰æ—¶å€™å¯èƒ½å› ä¸ºå…¶ä»–æŸäº›åŸå› ï¼ŒçŸ©é˜µ $X$ ä¼šç”±è®­ç»ƒæ ·æœ¬æŒ‰ç…§è¡Œå †å èµ·æ¥è€Œä¸æ˜¯åˆ—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º: $x^{(1)}$ çš„è½¬ç½®ç›´åˆ° $x^{(m)}$ çš„è½¬ç½®,ä½†æ˜¯åœ¨å®ç°ç¥ç»ç½‘ç»œçš„æ—¶å€™,ä½¿ç”¨å·¦è¾¹çš„è¿™ç§å½¢å¼,ä¼šè®©æ•´ä¸ªå®ç°çš„è¿‡ç¨‹å˜å¾—æ›´åŠ ç®€å•:</p><p>é‚£ä¹ˆè¾“å‡ºæ ‡ç­¾yå‘¢ï¼ŸåŒæ ·çš„é“ç†ï¼Œä¸ºäº†èƒ½æ›´åŠ å®¹æ˜“åœ°å®ç°ä¸€ä¸ªç¥ç»ç½‘ç»œ, å°†æ ‡ç­¾yæ”¾åœ¨åˆ—ä¸­å°†ä¼šä½¿å¾—åç»­è®¡ç®—éå¸¸æ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰å¤§å†™çš„Yç­‰äº $y^{(1)}, y^{(m)}, \ldots, y^{(m)},$ æ‰€ä»¥åœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªè§„æ¨¡ä¸º 1 ä¹˜ä»¥mçš„çŸ©é˜µã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210164925.png" alt="image-20201210164925141"></p><h2 id="2-é€»è¾‘å›å½’ï¼ˆLogistic-Regressionï¼‰"><a href="#2-é€»è¾‘å›å½’ï¼ˆLogistic-Regressionï¼‰" class="headerlink" title="2. é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰"></a>2. é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰</h2><p>é€»è¾‘å›å½’æ˜¯ç›‘ç£å­¦ä¹ é—®é¢˜ä¸­ï¼Œå½“è¾“å‡ºğ‘¦å…¨éƒ¨ä¸º0æˆ–1æ—¶ä½¿ç”¨çš„ä¸€ç§å­¦ä¹ ç®—æ³•ã€‚ </p><p>é€»è¾‘å›å½’çš„ç›®æ ‡æ˜¯æœ€å¤§ç¨‹åº¦åœ°å‡å°‘å…¶é¢„æµ‹ä¸è®­ç»ƒæ•°æ®ä¹‹é—´çš„è¯¯å·®ã€‚</p><p>ç¤ºä¾‹ï¼šè¯†åˆ«å›¾åƒæ˜¯å¦ä¸ºçŒ«ï¼š<br>ç»™å®šä¸€ä¸ªç”±ç‰¹å¾å‘é‡è¡¨ç¤ºçš„å›¾åƒï¼Œè¯¥ç®—æ³•å°†è¯„ä¼°è¿™å¼ å›¾åƒæ˜¯çŒ«å›¾åƒçš„æ¦‚ç‡ã€‚</p><script type="math/tex; mode=display">\text { Given } x, \hat{y}=P(y=1 \mid x), \text { where } 0 \leq \hat{y} \leq 1</script><p>é€»è¾‘å›å½’ä¸­å¸¸ç”¨çš„å‚æ•°å’Œè¡¨ç¤º:</p><ul><li>è¾“å…¥ç‰¹å¾å‘é‡ï¼š$x \in \mathbb{R}^{n_{x}}$ï¼Œ å…¶ä¸­ $n_{x}$ æ˜¯ç‰¹å¾çš„æ•°é‡</li><li>å®é™…å€¼:ï¼š$y \in 0,1$</li><li>å‚æ•°ï¼ˆæƒé‡ï¼‰ï¼š $w \in \mathbb{R}^{n_{x}}$ï¼Œå…¶ä¸­ $n_{x}$ æ˜¯ç‰¹å¾çš„æ•°é‡</li><li>åå·®ï¼ˆé˜ˆå€¼ï¼‰ï¼š $b \in \mathbb{R}$</li><li>è¾“å‡ºï¼š $\hat{y}=\sigma\left(w^{T} x+b\right)$</li><li>sigmoidå‡½æ•°ï¼š $s=\sigma\left(w^{T} x+b\right)=\sigma(z)=\frac{1}{1+e^{-z}}$</li></ul><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201211150522.png" alt="sigmoid function"></p><ul><li>å½“$z \gg 0$æ—¶$\sigma(z)=1$</li><li><p>å½“$z \ll 0$æ—¶ $\sigma(z)=0$</p></li><li><p>å½“ $z=0$æ—¶$\sigma(z)=0.5$</p></li></ul><h2 id="3-é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ï¼ˆCost-Functionï¼‰"><a href="#3-é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ï¼ˆCost-Functionï¼‰" class="headerlink" title="3.é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ï¼ˆCost Functionï¼‰"></a>3.é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ï¼ˆCost Functionï¼‰</h2><p>ä¸ºäº†è®­ç»ƒå‚æ•°wï¼Œbï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸‹çš„ä»£ä»·å‡½æ•°ï¼š</p><script type="math/tex; mode=display">\begin{aligned}&\text { Recap: }\\&\hat{y}^{(i)}=\sigma\left(w^{T} x^{(i)}+b\right), \text { where } \sigma\left(z^{(i)}\right)=\frac{1}{1+e^{-z}(t)}\\&\text {Given }\left\{\left(x^{(1)}, y^{(1)}\right), \cdots,\left(x^{(m)}, y^{(m)}\right)\right\}, \text { we want } \hat{y}^{(i)} \approx y^{(i)}\end{aligned}</script><p>æŸå¤±å‡½æ•°ç”¨äºåº¦é‡é¢„æµ‹$\left(\hat{y}^{(i)}\right)$ä¸æœŸæœ›è¾“å‡º$\left(y^{(i)}\right)$ä¹‹é—´çš„å·®å¼‚ ï¼ŒæŸå¤±å‡½æ•°ä¸ºå•ä¸ªè®­ç»ƒç¤ºä¾‹è®¡ç®—è¯¯å·®ã€‚<br>$L\left(\hat{y}^{(i)}, y^{(i)}\right)=\frac{1}{2}\left(\hat{y}^{(i)}-y^{(i)}\right)^{2}$<br>$L\left(\hat{y}^{(i)}, y^{(i)}\right)=-\left(y^{(i)} \log \left(\hat{y}^{(i)}\right)+\left(1-y^{(i)}\right) \log \left(1-\hat{y}^{(i)}\right)\right.$</p><ul><li>If $y^{(i)}=1: L\left(\hat{y}^{(i)}, y^{(i)}\right)=-\log \left(\hat{y}^{(i)}\right)$ where $\log \left(\hat{y}^{(i)}\right)$ and $\hat{y}^{(i)}$ should be close to 1</li><li>If $y^{(i)}=0: L\left(\hat{y}^{(i)}, y^{(i)}\right)=-\log \left(1-\hat{y}^{(i)}\right)$ where $\log \left(1-\hat{y}^{(i)}\right)$ and $\hat{y}^{(i)}$ should be close to 0</li></ul><p>ä»£ä»·å‡½æ•°:</p><script type="math/tex; mode=display">J(w, b)=\frac{1}{m} \sum_{i=1}^{m} L\left(\hat{y}^{(i)}, y^{(i)}\right)=\frac{1}{m} \sum_{i=1}^{m}\left(-y^{(i)} \log \hat{y}^{(i)}-\left(1-y^{(i)}\right) \log \left(1-\hat{y}^{(i)}\right)\right)</script><h2 id="4-æ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient-Descentï¼‰"><a href="#4-æ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient-Descentï¼‰" class="headerlink" title="4.æ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient Descentï¼‰"></a>4.æ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient Descentï¼‰</h2><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201211144252.png" alt="Gradient Descent"></p><p>æ•´ä¸ªæ¢¯åº¦ä¸‹é™æ³•çš„è¿­ä»£è¿‡ç¨‹å°±æ˜¯å°†$J(w,b)$ä»ä¸€ä¸ªåˆå§‹ç‚¹æœç€æœ€å°å€¼ç‚¹æ–¹å‘èµ°ã€‚</p><script type="math/tex; mode=display">w:=w-a \frac{\partial J(w, b)}{\partial w} \quad b:=b-a \frac{\partial J(w, b)}{\partial b}</script><p>å…¶ä¸­$a$ä¸ºæ­¥é•¿ï¼ˆstepï¼‰</p><h2 id="5-è®¡ç®—å›¾ï¼ˆComputation-Graphï¼‰"><a href="#5-è®¡ç®—å›¾ï¼ˆComputation-Graphï¼‰" class="headerlink" title="5.è®¡ç®—å›¾ï¼ˆComputation Graphï¼‰"></a>5.è®¡ç®—å›¾ï¼ˆComputation Graphï¼‰</h2><p>ä¾‹å¦‚å‡½æ•°$J(a,b,c)=3(a+bc)$å¯ä»¥åˆ†è§£ä¸ºä»¥ä¸‹è®¡ç®—å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201211154440.png" alt="Computation Graph"></p><h2 id="6-ä½¿ç”¨è®¡ç®—å›¾æ±‚å¯¼æ•°ï¼ˆcomputing-derivativesï¼‰"><a href="#6-ä½¿ç”¨è®¡ç®—å›¾æ±‚å¯¼æ•°ï¼ˆcomputing-derivativesï¼‰" class="headerlink" title="6.ä½¿ç”¨è®¡ç®—å›¾æ±‚å¯¼æ•°ï¼ˆcomputing derivativesï¼‰"></a>6.ä½¿ç”¨è®¡ç®—å›¾æ±‚å¯¼æ•°ï¼ˆcomputing derivativesï¼‰</h2><p>ä¸‹é¢ç”¨åˆ°çš„å…¬å¼:</p><script type="math/tex; mode=display">\frac{d J}{d u}=\frac{d J}{d v} \frac{d v}{d u}, \quad \frac{d J}{d b}=\frac{d J}{d u} \frac{d u}{d b}, \quad \frac{d J}{d a}=\frac{d J}{d u} \frac{d u}{d a}</script><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201211155940.png" alt="computing derivatives"></p><p>åå‘ä»æœ€åå¾€å‰è®¡ç®—å¯¼æ•°ï¼Œæ¯”å¦‚å…ˆè®¡ç®—$\frac{d J}{d u}$ï¼Œç„¶åé€šè¿‡é“¾å¼æ±‚å¯¼æ³•åˆ™å¾€å‰æ±‚å¯¼</p><h2 id="7-é€»è¾‘å›å½’ä¸­çš„æ¢¯åº¦ä¸‹é™ï¼ˆLogistic-Regression-Gradient-Descentï¼‰"><a href="#7-é€»è¾‘å›å½’ä¸­çš„æ¢¯åº¦ä¸‹é™ï¼ˆLogistic-Regression-Gradient-Descentï¼‰" class="headerlink" title="7.é€»è¾‘å›å½’ä¸­çš„æ¢¯åº¦ä¸‹é™ï¼ˆLogistic Regression Gradient Descentï¼‰"></a>7.é€»è¾‘å›å½’ä¸­çš„æ¢¯åº¦ä¸‹é™ï¼ˆLogistic Regression Gradient Descentï¼‰</h2><p>å‡è®¾æ ·æœ¬åªæœ‰ä¸¤ä¸ªç‰¹å¾ $x_{1}$ å’Œ $x_{2}$, ä¸ºäº†è®¡ç®— $z$ ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥å‚æ•° $w_{1} ã€ w_{2}$ å’Œ $b$, é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ç‰¹å¾å€¼ $x_{1}$ å’Œ $x_{2}$ã€‚ å› æ­¤zçš„è®¡ç®—å…¬å¼ä¸º ï¼š$z=w_{1} x_{1}+w_{2} x_{2}+b$<br>å›æƒ³ä¸€ä¸‹é€»è¾‘å›å½’çš„å…¬å¼å®šä¹‰å¦‚ä¸‹: $\quad \hat{y}=a=\sigma(z)$ å…¶ä¸­ $z=w^{T} x+b, \quad \sigma(z)=\frac{1}{1+e^{-z}}$<br>æŸå¤±å‡½æ•°: </p><script type="math/tex; mode=display">L\left(\hat{y}^{(i)}, y^{(i)}\right)=-y^{(i)} \log \hat{y}^{(i)}-\left(1-y^{(i)}\right) \log \left(1-\hat{y}^{(i)}\right)</script><p>ä»£ä»·å‡½æ•°ï¼š</p><script type="math/tex; mode=display">J(w, b)=\frac{1}{m} \sum_{i}^{m} L\left(\hat{y}^{(i)}, y^{(i)}\right)</script><p>å‡è®¾ç°åœ¨åªè€ƒè™‘å•ä¸ªæ ·æœ¬çš„æƒ…å†µï¼Œå•ä¸ªæ ·æœ¬çš„ä»£ä»·å‡½æ•°å®šä¹‰å¦‚ä¸‹:</p><script type="math/tex; mode=display">L(a, y)=-(y \log (a)+(1-y) \log (1-a))</script><p>å…¶ä¸­ $a$ æ˜¯é€»è¾‘å›å½’çš„è¾“å‡º, $y$ æ˜¯æ ·æœ¬çš„æ ‡ç­¾å€¼ã€‚ç°åœ¨è®©æˆ‘ä»¬ç”»å‡ºè¡¨ç¤ºè¿™ä¸ªè®¡ç®—çš„è®¡ç®—å›¾ã€‚<br>è¿™é‡Œå…ˆå¤ä¹ ä¸‹æ¢¯åº¦ä¸‹é™æ³•ï¼Œ $w$ å’Œ $b$ çš„ä¿®æ­£é‡å¯ä»¥è¡¨è¾¾å¦‚ä¸‹:</p><script type="math/tex; mode=display">w:=w-a \frac{\partial J(w, b)}{\partial w}, \quad b:=b-a \frac{\partial J(w, b)}{\partial b}</script><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201211160530.png" alt="Computation Graph"></p><p>ä¸€æ­¥ä¸€æ­¥å¾€å‰è®¡ç®—é¦–å…ˆå¯¹aæ±‚åå¯¼æ•°ï¼š</p><script type="math/tex; mode=display">\frac{d L(a, y)}{d a}=-y / a+(1-y) /(1-a)</script><p>å› ä¸º $\frac{d L(a, y)}{d z}=\frac{d L}{d z}=\left(\frac{d L}{d a}\right) \cdot\left(\frac{d a}{d z}\right), \quad$ å¹¶ä¸” $\frac{d a}{d z}=a \cdot(1-a), \quad$ è€Œ $\frac{d L}{d a}=\left(-\frac{y}{a}+\frac{(1-y)}{(1-a)}\right),$<br>å› æ­¤å°†è¿™ä¸¤é¡¹ç›¸ä¹˜ï¼Œå¾—åˆ°:</p><script type="math/tex; mode=display">d z=\frac{d L(a, y)}{d z}=\frac{d L}{d z}=\left(\frac{d L}{d a}\right) \cdot\left(\frac{d a}{d z}\right)=\left(-\frac{y}{a}+\frac{(1-y)}{(1-a)}\right) \cdot a(1-a)=a-y</script><p>ç°åœ¨è¿›è¡Œæœ€åä¸€æ­¥åå‘æ¨å¯¼ï¼Œä¹Ÿå°±æ˜¯è®¡ç®—ğ‘¤å’Œğ‘å˜åŒ–å¯¹ä»£ä»·å‡½æ•°ğ¿çš„å½±å“</p><script type="math/tex; mode=display">\frac{\partial L}{\partial w_{1}}=x_{1} \cdot d z,\quad \frac{\partial L}{\partial w_{2}}=x_{2} \cdot d z, \quad d b=d z</script><p>å¯¹äºmä¸ªæ ·æœ¬ï¼š</p><script type="math/tex; mode=display">\begin{array}{l}d w_{j}=\frac{1}{m} \sum_{i}^{m} x_{j}^{(i)}\left(a^{(i)}-y^{(i)}\right) \\d b=\frac{1}{m} \sum_{i}^{m}\left(a^{(i)}-y^{(i)}\right)\end{array}</script><p>ä¼ªä»£ç ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">J<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>dw1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>dw2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>db<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span> to m  z<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> wx<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span>b<span class="token punctuation">;</span>  a<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>z<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  J <span class="token operator">+=</span> <span class="token operator">-</span><span class="token punctuation">[</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span>log<span class="token punctuation">(</span>a<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>a<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> dz<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> a<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>  dw1 <span class="token operator">+=</span> x1<span class="token punctuation">(</span>i<span class="token punctuation">)</span>dz<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>  dw2 <span class="token operator">+=</span> x2<span class="token punctuation">(</span>i<span class="token punctuation">)</span>dz<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>  db <span class="token operator">+=</span> dz<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>  J<span class="token operator">/=</span> m<span class="token punctuation">;</span>  dw1<span class="token operator">/=</span> m<span class="token punctuation">;</span>  dw2<span class="token operator">/=</span> m<span class="token punctuation">;</span>  db<span class="token operator">/=</span> m<span class="token punctuation">;</span>  w<span class="token operator">=</span>w<span class="token operator">-</span>alpha<span class="token operator">*</span>dw  b<span class="token operator">=</span>b<span class="token operator">-</span>alpha<span class="token operator">*</span>db<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="8-å‘é‡åŒ–"><a href="#8-å‘é‡åŒ–" class="headerlink" title="8.å‘é‡åŒ–"></a>8.å‘é‡åŒ–</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment">#å¯¼å…¥ numpy åº“</span>a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#åˆ›å»ºä¸€ä¸ªæ•°æ® </span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment"># [1 2 3 4]</span><span class="token keyword">import</span> time <span class="token comment">#å¯¼å…¥æ—¶é—´åº“</span>a <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span>b <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span> <span class="token comment">#é€šè¿‡ round éšæœºå¾—åˆ°ä¸¤ä¸ªä¸€ç™¾ä¸‡ç»´åº¦çš„æ•°ç»„</span>tic <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#ç°åœ¨æµ‹é‡ä¸€ä¸‹å½“å‰æ—¶é—´</span><span class="token comment">#å‘é‡åŒ–çš„ç‰ˆæœ¬</span>c <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>toc <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>â€œVectorized version<span class="token punctuation">:</span>â€ <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc<span class="token operator">-</span>tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>â€msâ€<span class="token punctuation">)</span> <span class="token comment">#æ‰“å°ä¸€ä¸‹å‘é‡åŒ–çš„ç‰ˆæœ¬çš„æ—¶é—´</span><span class="token comment">#ç»§ç»­å¢åŠ éå‘é‡åŒ–çš„ç‰ˆæœ¬</span>c<span class="token operator">=</span><span class="token number">0</span>tic <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>c <span class="token operator">+=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span>toc <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>â€œFor loop<span class="token punctuation">:</span>â€ <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc<span class="token operator">-</span>tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> â€œmsâ€<span class="token punctuation">)</span><span class="token comment">#æ‰“å° forå¾ªç¯çš„ç‰ˆæœ¬çš„æ—¶é—´</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>forå¤ªæ…¢ï¼Œä¸Šé¢çš„ä¾‹å­ç›¸å·®300å€ï¼Œæ·±åº¦å­¦ä¹ ä»£ç ä¸­å°½é‡ä¸ä½¿ç”¨forï¼Œä½¿ç”¨å‘é‡</p><h2 id="9-å‘é‡åŒ–é€»è¾‘å›å½’ï¼ˆVectorizing-Logistic-Regressionï¼‰"><a href="#9-å‘é‡åŒ–é€»è¾‘å›å½’ï¼ˆVectorizing-Logistic-Regressionï¼‰" class="headerlink" title="9.å‘é‡åŒ–é€»è¾‘å›å½’ï¼ˆVectorizing Logistic Regressionï¼‰"></a>9.å‘é‡åŒ–é€»è¾‘å›å½’ï¼ˆVectorizing Logistic Regressionï¼‰</h2><p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¸ä½¿ç”¨ for å¾ªç¯ï¼Œè€Œæ˜¯å‘é‡ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåš:</p><script type="math/tex; mode=display">Z=w^{T} X+b=n p . \operatorname{dot}(w . T, X)+b</script><script type="math/tex; mode=display">A=\sigma(Z)</script><script type="math/tex; mode=display">d Z=A-Y</script><script type="math/tex; mode=display">d w=\frac{1}{m} * X * d z^{T}â€‹</script><script type="math/tex; mode=display">d b=\frac{1}{m} * n p . \operatorname{sum}(d Z)â€‹</script><script type="math/tex; mode=display">w:=w-a * d wâ€‹</script><script type="math/tex; mode=display">b:=b-a * d bâ€‹</script><h2 id="10-Python-ä¸­çš„å¹¿æ’­ï¼ˆBroadcasting-in-Pythonï¼‰"><a href="#10-Python-ä¸­çš„å¹¿æ’­ï¼ˆBroadcasting-in-Pythonï¼‰" class="headerlink" title="10.Python ä¸­çš„å¹¿æ’­ï¼ˆBroadcasting in Pythonï¼‰"></a>10.Python ä¸­çš„å¹¿æ’­ï¼ˆBroadcasting in Pythonï¼‰</h2><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214143246086.png" alt="Broadcasting in Python"></p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/image-20201214143943638.png" alt="image-20201214143943638"></p><h2 id="11-logistic-æŸå¤±å‡½æ•°çš„è§£é‡Šï¼ˆExplanationoflogistic-regression-cost-functionï¼‰"><a href="#11-logistic-æŸå¤±å‡½æ•°çš„è§£é‡Šï¼ˆExplanationoflogistic-regression-cost-functionï¼‰" class="headerlink" title="11.logistic æŸå¤±å‡½æ•°çš„è§£é‡Šï¼ˆExplanationoflogistic regression cost functionï¼‰"></a>11.logistic æŸå¤±å‡½æ•°çš„è§£é‡Šï¼ˆExplanationoflogistic regression cost functionï¼‰</h2><p>å›æƒ³ä¸€ä¸‹ï¼Œåœ¨é€»è¾‘å›å½’ä¸­ï¼Œéœ€è¦é¢„æµ‹çš„ç»“æœé‡‘,å¯ä»¥è¡¨ç¤ºä¸º $\hat{y}=\sigma\left(w^{T} x+b\right), \sigma$ æ˜¯æˆ‘ä»¬ç†Ÿç»™å®šè®­ç»ƒæ ·æœ¬ $x$ æ¡ä»¶ä¸‹ $y$ ç­‰äº 1 çš„æ¦‚ç‡ã€‚<br>æ¢å¥è¯è¯´ï¼Œå¦‚æœ $y=1,$ åœ¨ç»™å®šè®­ç»ƒæ ·æœ¬ $x$ æ¡ä»¶ä¸‹ $\mathrm{y}=\hat{y}$<br>åè¿‡æ¥è¯´ï¼Œå¦‚æœ $y=0,$ åœ¨ç»™å®šè®­ç»ƒæ ·æœ¬ $x$ æ¡ä»¶ä¸‹ $(y=1-\hat{y})$,<br>å› æ­¤ï¼Œå¦‚æœ $\hat{y}$ ä»£è¡¨ $y=1$ çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆ1 $-\hat{y}$ å°±æ˜¯ $y=0$ çš„æ¦‚ç‡ã€‚<br>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥åˆ†æè¿™ä¸¤ä¸ªæ¡ä»¶æ¦‚ç‡å…¬å¼ã€‚<br>If $y=1: \quad p(y \mid x)=\hat{y}$<br>If $y=0: \quad p(y \mid x)=1-\hat{y}$</p><p>ä¸Šè¿°çš„ä¸¤ä¸ªæ¡ä»¶æ¦‚ç‡å…¬å¼å¯ä»¥åˆå¹¶æˆå¦‚ä¸‹å…¬å¼:</p><script type="math/tex; mode=display">p(y \mid x)=\hat{y}^{y}(1-\hat{y})^{(1-y)}</script><p>ç”±äº $\log$å‡½æ•°æ˜¯ä¸¥æ ¼å•è°ƒé€’å¢çš„å‡½æ•°ï¼Œæœ€å¤§åŒ– $\log (p(y \mid x))$ ç­‰ä»·äºæœ€å¤§åŒ– $p(y \mid x)$ å¹¶ä¸”åœ°è®¡ç®—$p(y \mid x)$ çš„ $\log$ å¯¹æ•°, å°±æ˜¯è®¡ç®— $\log \left(\hat{y}^{(y)}(1-\hat{y})^{(1-y)}\right)$ </p><p>å…¶å®å°±æ˜¯å°† $p(y \mid x)$ ä»£å…¥ï¼Œé€šè¿‡å¯¹æ•°å‡½æ•°åŒ–ç®€ä¸º:</p><script type="math/tex; mode=display">-L(\hat{y}, y)=y \log \hat{y}+(1-y) \log (1-\hat{y})</script>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> å´æ©è¾¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10_æ¨èç³»ç»Ÿ(Recommender Systems)</title>
      <link href="2020/12/10/machinelearning/wu-en-da-ji-qi-xue-xi/10-recommender-systems/"/>
      <url>2020/12/10/machinelearning/wu-en-da-ji-qi-xue-xi/10-recommender-systems/</url>
      
        <content type="html"><![CDATA[<h2 id="1-é—®é¢˜å½¢å¼åŒ–"><a href="#1-é—®é¢˜å½¢å¼åŒ–" class="headerlink" title="1.é—®é¢˜å½¢å¼åŒ–"></a>1.é—®é¢˜å½¢å¼åŒ–</h2><p>æˆ‘ä»¬ä»ä¸€ä¸ªä¾‹å­å¼€å§‹å®šä¹‰æ¨èç³»ç»Ÿçš„é—®é¢˜ã€‚</p><p>å‡ä½¿æˆ‘ä»¬æ˜¯ä¸€ä¸ªç”µå½±ä¾›åº”å•†ï¼Œæˆ‘ä»¬æœ‰ 5 éƒ¨ç”µå½±å’Œ 4 ä¸ªç”¨æˆ·ï¼Œæˆ‘ä»¬è¦æ±‚ç”¨æˆ·ä¸ºç”µå½±æ‰“åˆ†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210134224.png" alt="ç”µå½±æ‰“åˆ†"></p><p>å‰ä¸‰éƒ¨ç”µå½±æ˜¯çˆ±æƒ…ç‰‡ï¼Œåä¸¤éƒ¨åˆ™æ˜¯åŠ¨ä½œç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º Alice å’Œ Bob ä¼¼ä¹æ›´å€¾å‘ä¸çˆ±æƒ…ç‰‡ï¼Œè€Œ Carol å’Œ Dave ä¼¼ä¹æ›´å€¾å‘ä¸åŠ¨ä½œç‰‡ã€‚å¹¶ä¸”æ²¡æœ‰ä¸€ä¸ªç”¨æˆ·ç»™æ‰€æœ‰çš„ç”µå½±éƒ½æ‰“è¿‡åˆ†ã€‚ æˆ‘ä»¬å¸Œæœ›æ„å»ºä¸€ä¸ªç®—æ³•æ¥é¢„æµ‹ä»–ä»¬æ¯ä¸ªäººå¯èƒ½ä¼šç»™ä»–ä»¬æ²¡çœ‹è¿‡çš„ç”µå½±æ‰“å¤šå°‘åˆ†ï¼Œå¹¶ä»¥æ­¤ä½œä¸ºæ¨èçš„ä¾æ®ã€‚</p><p>ä¸‹é¢å¼•å…¥ä¸€äº›æ ‡è®°:</p><ul><li>$n_{u}$ ä»£è¡¨ç”¨æˆ·çš„æ•°é‡</li><li>$n_{m}$ ä»£è¡¨ç”µå½±çš„æ•°é‡</li><li>$r(i, j) \quad$ å¦‚æœç”¨æˆ· $j$ ç»™ç”µå½± $i$ è¯„è¿‡åˆ†åˆ™ $r(i, j)=1$</li><li>$y^{(i, j)} \quad$ ä»£è¡¨ç”¨æˆ· $j$ ç»™ç”µå½± $i$ çš„è¯„åˆ†</li><li>$m_{j}$ ä»£è¡¨ç”¨æˆ· $j$ è¯„è¿‡åˆ†çš„ç”µå½±çš„æ€»æ•°</li></ul><h2 id="2-åŸºäºå†…å®¹çš„æ¨èç³»ç»Ÿï¼ˆContent-Based-Recommendationsï¼‰"><a href="#2-åŸºäºå†…å®¹çš„æ¨èç³»ç»Ÿï¼ˆContent-Based-Recommendationsï¼‰" class="headerlink" title="2.åŸºäºå†…å®¹çš„æ¨èç³»ç»Ÿï¼ˆContent Based Recommendationsï¼‰"></a>2.åŸºäºå†…å®¹çš„æ¨èç³»ç»Ÿï¼ˆContent Based Recommendationsï¼‰</h2><p>åœ¨ä¸€ä¸ªåŸºäºå†…å®¹çš„æ¨èç³»ç»Ÿç®—æ³•ä¸­ï¼Œæˆ‘ä»¬å‡è®¾å¯¹äºæˆ‘ä»¬å¸Œæœ›æ¨èçš„ä¸œè¥¿æœ‰ä¸€äº›æ•°æ®ï¼Œè¿™äº›æ•°æ®æ˜¯æœ‰å…³è¿™äº›ä¸œè¥¿çš„ç‰¹å¾ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾æ¯éƒ¨ç”µå½±éƒ½æœ‰ä¸¤ä¸ªç‰¹å¾ï¼Œå¦‚$ğ‘¥_1$ä»£è¡¨ç”µå½±çš„æµªæ¼«ç¨‹åº¦ï¼Œ$ğ‘¥_2$ä»£è¡¨ç”µå½±çš„åŠ¨ä½œç¨‹åº¦ã€‚</p><script type="math/tex; mode=display">\begin{array}{c|cccc|cc}\text { Movie } & \text { Alice (1) } & \text { Bob (2) } & \text { Carol (3) } & \text { Dave (4) } & \begin{array}{c}x_{1} \\\text { (romance) }\end{array} & \begin{array}{c}x_{2} \\\text { (action) }\end{array} \\\hline \text { Love at last } & 5 & 5 & 0 & 0 & 0.9 & 0 \\\text { Romance forever } & 5 & ? & ? & 0 & 1.0 & 0.01 \\\text { Cute puppies of } & ? & 4 & 0 & ? & 0.99 & 0 \\\text { love } & & & & & & \\\begin{array}{c}\text { Nonstop car } \\\text { chases }\end{array} & 0 & 0 & 5 & 4 & 0.1 & 1.0 \\\text { Swords vs. karate } & 0 & 0 & 5 & ? & 0 & 0.9\end{array}</script><p>åˆ™æ¯éƒ¨ç”µå½±éƒ½æœ‰ä¸€ä¸ªç‰¹å¾å‘é‡ï¼Œå¦‚ $x^{(1)}$ æ˜¯ç¬¬ä¸€éƒ¨ç”µå½±çš„ç‰¹å¾å‘é‡ä¸º[0.9 0]ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬è¦åŸºäºè¿™äº›ç‰¹å¾æ¥æ„å»ºä¸€ä¸ªæ¨èç³»ç»Ÿç®—æ³•ã€‚ å‡è®¾æˆ‘ä»¬é‡‡ç”¨çº¿æ€§å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹æ¯ä¸€ä¸ªç”¨æˆ·éƒ½è®­ç»ƒä¸€ä¸ªçº¿æ€§å›å½’æ¨¡å‹ï¼Œå¦‚ $\theta^{(1)}$ æ˜¯ç¬¬ä¸€ä¸ªç”¨æˆ·çš„æ¨¡å‹çš„å‚æ•°ã€‚ äºæ˜¯ï¼Œæˆ‘ä»¬æœ‰:</p><ul><li>$\theta^{(j)}$ ç”¨æˆ· $j$ çš„å‚æ•°å‘é‡</li><li>$x^{(i)}$ ç”µå½± $i$ çš„ç‰¹å¾å‘é‡</li><li>å¯¹äºç”¨æˆ· $j$ å’Œç”µå½± $i,$ æˆ‘ä»¬é¢„æµ‹è¯„åˆ†ä¸º: $\left(\theta^{(j)}\right)^{T} x^{(i)}$</li><li>ä»£ä»·å‡½æ•°é’ˆå¯¹ç”¨æˆ· $j$, è¯¥çº¿æ€§å›å½’æ¨¡å‹çš„ä»£ä»·ä¸ºé¢„æµ‹è¯¯å·®çš„å¹³æ–¹å’Œï¼ŒåŠ ä¸Šæ­£åˆ™åŒ–é¡¹:</li></ul><script type="math/tex; mode=display">\min _{\theta(j)} \frac{1}{2} \sum_{i: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right)^{2}+\frac{\lambda}{2}\left(\theta_{k}^{(j)}\right)^{2}</script><p>å…¶ä¸­ $i: r(i, j)$ è¡¨ç¤ºæˆ‘ä»¬åªè®¡ç®—é‚£äº›ç”¨æˆ· $j$ è¯„è¿‡åˆ†çš„ç”µå½±ã€‚åœ¨ä¸€èˆ¬çš„çº¿æ€§å›å½’æ¨¡å‹ä¸­, è¯¯å·®é¡¹å’Œæ­£åˆ™é¡¹åº”è¯¥éƒ½æ˜¯ä¹˜ä»¥1/2mï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†må»æ‰ã€‚å¹¶ä¸”æˆ‘ä»¬ä¸å¯¹æ–¹å·®é¡¹ $\theta_{0}$ è¿›è¡Œæ­£åˆ™åŒ–å¤„ç†ã€‚<br>ä¸Šé¢çš„ä»£ä»·å‡½æ•°åªæ˜¯é’ˆå¯¹ä¸€ä¸ªç”¨æˆ·çš„, ä¸ºäº†å­¦ä¹ æ‰€æœ‰ç”¨æˆ·, æˆ‘ä»¬å°†æ‰€æœ‰ç”¨æˆ·çš„ä»£ä»·å‡½æ•°æ±‚å’Œ:</p><script type="math/tex; mode=display">\min _{\theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}} \frac{1}{2} \sum_{j=1}^{n_{u}} \sum_{i: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right)^{2}+\frac{\lambda}{2} \sum_{j=1}^{n_{u}} \sum_{k=1}^{n}\left(\theta_{k}^{(j)}\right)^{2}</script><p>å¦‚æœæˆ‘ä»¬è¦ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥æ±‚è§£æœ€ä¼˜è§£ï¼Œæˆ‘ä»¬è®¡ç®—ä»£ä»·å‡½æ•°çš„åå¯¼æ•°åå¾—åˆ°æ¢¯åº¦ä¸‹é™çš„ æ›´æ–°å…¬å¼ä¸º:</p><script type="math/tex; mode=display">\begin{array}{c} \theta_{k}^{(j)}:=\theta_{k}^{(j)}-\alpha \sum_{i: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right) x_{k}^{(i)} \quad \text { (for } \left.k=0\right) \\\theta_{k}^{(j)}:=\theta_{k}^{(j)}-\alpha\left(\sum_{i: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right) x_{k}^{(i)}+\lambda \theta_{k}^{(j)}\right) \quad(\text { for } k \neq 0)\end{array}</script><h2 id="3-ååŒè¿‡æ»¤-Collaborative-Filtering"><a href="#3-ååŒè¿‡æ»¤-Collaborative-Filtering" class="headerlink" title="3.ååŒè¿‡æ»¤ Collaborative Filtering"></a>3.ååŒè¿‡æ»¤ Collaborative Filtering</h2><p>åœ¨ä¹‹å‰çš„åŸºäºå†…å®¹çš„æ¨èç³»ç»Ÿä¸­ï¼Œå¯¹äºæ¯ä¸€éƒ¨ç”µå½±ï¼Œæˆ‘ä»¬éƒ½æŒæ¡äº†å¯ç”¨çš„ç‰¹å¾ï¼Œä½¿ç”¨è¿™ äº›ç‰¹å¾è®­ç»ƒå‡ºäº†æ¯ä¸€ä¸ªç”¨æˆ·çš„å‚æ•°ã€‚ç›¸ååœ°ï¼Œå¦‚æœæˆ‘ä»¬æ‹¥æœ‰ç”¨æˆ·çš„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ å¾—å‡ºç”µå½±çš„ç‰¹å¾ã€‚</p><script type="math/tex; mode=display">\min _{x^{(1)}, \ldots, x^{\left(n_{m}\right)}} \frac{1}{2} \sum_{i=1}^{n_{m}} \sum_{j r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right)^{2}+\frac{\lambda}{2} \sum_{i=1}^{n_{m}} \sum_{k=1}^{n}\left(x_{k}^{(i)}\right)^{2}</script><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æ—¢æ²¡æœ‰ç”¨æˆ·çš„å‚æ•°ï¼Œä¹Ÿæ²¡æœ‰ç”µå½±çš„ç‰¹å¾ï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½ä¸å¯è¡Œäº†ã€‚ååŒè¿‡æ»¤ç®—æ³•å¯ä»¥åŒæ—¶å­¦ä¹ è¿™ä¸¤è€…ã€‚</p><p>æˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡ä¾¿æ”¹ä¸ºåŒæ—¶é’ˆå¯¹ğ‘¥å’Œğœƒè¿›è¡Œã€‚</p><script type="math/tex; mode=display">\begin{array}{l}J\left(x^{(1)}, \ldots x^{\left(n_{m}\right)}, \theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}\right) \\\qquad \begin{array}{l}=\frac{1}{2} \sum_{(i: j): r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right)^{2}+\frac{\lambda}{2} \sum_{i=1}^{n_{m}} \sum_{k=1}^{n}\left(x_{k}^{(j)}\right)^{2} \\+\frac{\lambda}{2} \sum_{j=1}^{n_{u}} \sum_{k=1}^{n}\left(\theta_{k}^{(j)}\right)^{2}\end{array}\end{array}</script><p>å¯¹ä»£ä»·å‡½æ•°æ±‚åå¯¼æ•°çš„ç»“æœå¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">\begin{array}{c}x_{k}^{(i)}:=x_{k}^{(i)}-\alpha\left(\sum_{j: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)} \theta_{k}^{j}+\lambda x_{k}^{(i)}\right)\right. \\\theta_{k}^{(i)}:=\theta_{k}^{(i)}-\alpha\left(\sum_{i: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)} x_{k}^{(i)}+\lambda \theta_{k}^{(j)}\right)\right. \\\min _{x^{(1)}, \ldots, x^{\left(n_{m}\right)}} \frac{1}{2} \sum_{i=1}^{n_{m}} \sum_{j r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right)^{2}+\frac{\lambda}{2} \sum_{i=1}^{n_{m}} \sum_{k=1}^{n}\left(x_{k}^{(i)}\right)^{2}\end{array}</script><p>ååŒè¿‡æ»¤ä»ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä½¿ç”¨æ–¹å·®é¡¹ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œç®—æ³•ä¼šè‡ªåŠ¨å­¦å¾—ã€‚ ååŒè¿‡æ»¤ç®—æ³•ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹:</p><ol><li>åˆå§‹ $x^{(1)}, x^{(1)}, \ldots x^{(n m)}, \theta^{(1)}, \theta^{(2)}, \ldots, \theta^{\left(n_{u}\right)}$ ä¸ºä¸€äº›éšæœºå°å€¼</li><li>ä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æœ€å°åŒ–ä»£ä»·å‡½æ•°</li><li>åœ¨è®­ç»ƒå®Œç®—æ³•åï¼Œæˆ‘ä»¬é¢„æµ‹ $\left(\theta^{(j)}\right)^{T} x^{(i)}$ ä¸ºç”¨æˆ· $j$ ç»™ç”µå½± $i$ çš„è¯„åˆ†</li></ol><p>é€šè¿‡è¿™ä¸ªå­¦ä¹ è¿‡ç¨‹è·å¾—çš„ç‰¹å¾çŸ©é˜µåŒ…å«äº†æœ‰å…³ç”µå½±çš„é‡è¦æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¸æ€»æ˜¯äººèƒ½è¯»æ‡‚çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›æ•°æ®ä½œä¸ºç»™ç”¨æˆ·æ¨èç”µå½±çš„ä¾æ®ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä½ç”¨æˆ·æ­£åœ¨è§‚çœ‹ç”µå½± $x^{(i)},$ æˆ‘ä»¬å¯ä»¥å¯»æ‰¾å¦ä¸€éƒ¨ç”µå½± $x^{(j)},$ ä¾æ®ä¸¤éƒ¨ç”µå½±çš„ç‰¹å¾å‘é‡ä¹‹é—´çš„è·ç¦» $\left|x^{(i)}-x^{(j)}\right|$ çš„å¤§å°ã€‚</p><h2 id="4-ååŒè¿‡æ»¤ç®—æ³•"><a href="#4-ååŒè¿‡æ»¤ç®—æ³•" class="headerlink" title="4.ååŒè¿‡æ»¤ç®—æ³•"></a>4.ååŒè¿‡æ»¤ç®—æ³•</h2><p>ååŒè¿‡æ»¤ä¼˜åŒ–ç›®æ ‡:<br>ç»™å®š $x^{(1)}, \ldots, x^{\left(n_{m}\right)},$ ä¼°è®¡ $\theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}:$</p><script type="math/tex; mode=display">\min _{\theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}} \frac{1}{2} \sum_{j=1}^{n_{u}} \sum_{i: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right)^{2}+\frac{\lambda}{2} \sum_{j=1}^{n_{u}} \sum_{k=1}^{n}\left(\theta_{k}^{(j)}\right)^{2}</script><p>ç»™å®š $\theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)},$ ä¼°è®¡ $x^{(1)}, \ldots, x^{\left(n_{m}\right)}:$<br>åŒæ—¶æœ€å°åŒ– $x^{(1)}, \ldots, x^{\left(n_{m}\right)}$ å’Œ $\theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}:$</p><script type="math/tex; mode=display">\begin{array}{c}J\left(x^{(1)}, \ldots, x^{\left(n_{m}\right)}, \theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}\right) \\=\frac{1}{2} \sum_{(i, j): r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right)^{2}+\frac{\lambda}{2} \sum_{i=1}^{n_{m}} \sum_{k=1}^{n}\left(x_{k}^{(i)}\right)^{2}+\frac{\lambda}{2} \sum_{j=1}^{n_{u}} \sum_{k=1}^{n}\left(\theta_{k}^{(j)}\right)^{2} \\\min _{x^{(1)}, \ldots, x^{\left(n_{m}\right)}, \theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}} J\left(x^{(1)}, \ldots, x^{\left(n_{m}\right)}, \theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}\right)\end{array}</script><h2 id="5-å‘é‡åŒ–-ä½ç§©çŸ©é˜µåˆ†è§£"><a href="#5-å‘é‡åŒ–-ä½ç§©çŸ©é˜µåˆ†è§£" class="headerlink" title="5.å‘é‡åŒ–:ä½ç§©çŸ©é˜µåˆ†è§£"></a>5.å‘é‡åŒ–:ä½ç§©çŸ©é˜µåˆ†è§£</h2><p>ä¸¾ä¾‹å­:</p><ol><li><p>å½“ç»™å‡ºä¸€ä»¶äº§å“æ—¶ï¼Œä½ èƒ½å¦æ‰¾åˆ°ä¸ä¹‹ç›¸å…³çš„å…¶å®ƒäº§å“ã€‚ </p></li><li><p>ä¸€ä½ç”¨æˆ·æœ€è¿‘çœ‹ä¸Šä¸€ä»¶äº§å“ï¼Œæœ‰æ²¡æœ‰å…¶å®ƒç›¸å…³çš„äº§å“ï¼Œä½ å¯ä»¥æ¨èç»™ä»–ã€‚ </p></li></ol><p>æˆ‘å°†è¦åšçš„æ˜¯:å®ç°ä¸€ç§é€‰æ‹©çš„æ–¹æ³•ï¼Œå†™å‡ºååŒè¿‡æ»¤ç®—æ³•çš„é¢„æµ‹æƒ…å†µã€‚ </p><p>æˆ‘ä»¬æœ‰å…³äºäº”éƒ¨ç”µå½±çš„æ•°æ®é›†ï¼Œæˆ‘å°†è¦åšçš„æ˜¯ï¼Œå°†è¿™äº›ç”¨æˆ·çš„ç”µå½±è¯„åˆ†ï¼Œè¿›è¡Œåˆ†ç»„å¹¶å­˜åˆ°ä¸€ä¸ªçŸ©é˜µä¸­ã€‚</p><p>æˆ‘ä»¬æœ‰äº”éƒ¨ç”µå½±ï¼Œä»¥åŠå››ä½ç”¨æˆ·ï¼Œé‚£ä¹ˆè¿™ä¸ªçŸ©é˜µ ğ‘Œ å°±æ˜¯ä¸€ä¸ª 5 è¡Œ 4 åˆ—çš„çŸ©é˜µï¼Œå®ƒå°†è¿™äº›ç”µå½±çš„ç”¨æˆ·è¯„åˆ†æ•°æ®éƒ½å­˜åœ¨çŸ©é˜µé‡Œ:</p><script type="math/tex; mode=display">\begin{aligned}&\begin{array}{|l|l|l|l|l|}\hline \text { Movie } & \text { Alice (1) } & \text { Bob (2) } & \text { Carol (3) } & \text { Dave (4) } \\\hline \text { Love at last } & 5 & 5 & 0 & 0 \\\hline \text { Romance forever } & 5 & ? & ? & 0 \\\hline \text { Cute puppies of love } & ? & 4 & 0 & ? \\\hline \text { Nonstop car chases } & 0 & 0 & 5 & 4 \\\hline \text { Swords vs. karate } & 0 & 0 & 5 & ? \\\hline\end{array}\\&Y=\left[\begin{array}{llll}5 & 5 & 0 & 0 \\5 & ? & ? & 0 \\? & 4 & 0 & ? \\0 & 0 & 5 & 4 \\0 & 0 & 5 & 0\end{array}\right]\end{aligned}</script><p>æ¨å‡ºè¯„åˆ†:</p><script type="math/tex; mode=display">\left[\begin{array}{cccc}\left(\theta^{(1)}\right)^{T}\left(x^{(1)}\right) & \left(\theta^{(2)}\right)^{T}\left(x^{(1)}\right) & \ldots & \left(\theta^{\left(n_{u}\right)}\right)^{T}\left(x^{(1)}\right) \\\left(\theta^{(1)}\right)^{T}\left(x^{(2)}\right) & \left(\theta^{(2)}\right)^{T}\left(x^{(2)}\right) & \ldots & \left(\theta^{\left(n_{u}\right)}\right)^{T}\left(x^{(2)}\right) \\\vdots & \vdots & \vdots & \vdots \\\left(\theta^{(1)}\right)^{T}\left(x^{\left(n_{m}\right)}\right) & \left(\theta^{(2)}\right)^{T}\left(x^{\left(n_{m}\right)}\right) & \ldots & \left(\theta^{\left(n_{u}\right)}\right)^{T}\left(x^{\left(n_{m}\right)}\right)\end{array}\right]</script><p>æ‰¾åˆ°ç›¸å…³å½±ç‰‡:</p><p>ç°åœ¨æ—¢ç„¶ä½ å·²ç»å¯¹ç‰¹å¾å‚æ•°å‘é‡è¿›è¡Œäº†å­¦ä¹ ,é‚£ä¹ˆæˆ‘ä»¬å°±ä¼šæœ‰ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„æ–¹æ³•æ¥åº¦é‡ä¸¤éƒ¨ç”µå½±ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚</p><p>ä¾‹å¦‚è¯´: ç”µå½± $i$ æœ‰ä¸€ä¸ªç‰¹å¾å‘é‡ $x^{(i)},$ ä½ æ˜¯å¦èƒ½æ‰¾åˆ°ä¸€éƒ¨ä¸åŒçš„ç”µå½± $j,$ ä¿è¯ä¸¤éƒ¨ç”µå½±çš„ç‰¹å¾å‘é‡ä¹‹é—´çš„è·ç¦» $x^{(i)}$ å’Œ $x^{(j)}$ å¾ˆå°ï¼Œé‚£å°±èƒ½å¾ˆæœ‰åŠ›åœ°è¡¨æ˜ç”µå½± $i$ å’Œç”µå½± $j$ åœ¨æŸç§ç¨‹åº¦ä¸Šæœ‰ç›¸ä¼¼ï¼Œè‡³å°‘åœ¨æŸç§æ„ä¹‰ä¸Š, æŸäº›äººå–œæ¬¢ç”µå½± $i,$ æˆ–è®¸æ›´æœ‰å¯èƒ½ä¹Ÿå¯¹ç”µå½±$j$ æ„Ÿå…´è¶£ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œå½“ç”¨æˆ·åœ¨çœ‹æŸéƒ¨ç”µå½± $i$ çš„æ—¶å€™ï¼Œå¦‚æœä½ æƒ³æ‰¾ 5 éƒ¨ä¸ç”µå½±éå¸¸ç›¸ä¼¼çš„ç”µå½±ï¼Œä¸ºäº†èƒ½ç»™ç”¨æˆ·æ¨è 5 éƒ¨æ–°ç”µå½±ï¼Œä½ éœ€è¦åšçš„æ˜¯æ‰¾å‡ºç”µå½± $j,$ åœ¨è¿™äº›ä¸åŒçš„ç”µå½±ä¸­ä¸æˆ‘ä»¬è¦æ‰¾çš„ç”µå½± $i$ çš„è·ç¦»æœ€å°ï¼Œè¿™æ ·ä½ å°±èƒ½ç»™ä½ çš„ç”¨æˆ·æ¨èå‡ éƒ¨ä¸åŒçš„ç”µå½±äº†ã€‚</p><p>é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå¸Œæœ›ä½ èƒ½çŸ¥é“ï¼Œå¦‚ä½•è¿›è¡Œä¸€ä¸ªå‘é‡åŒ–çš„è®¡ç®—æ¥å¯¹æ‰€æœ‰çš„ç”¨æˆ·å’Œæ‰€æœ‰çš„ç”µå½±è¿›è¡Œè¯„åˆ†è®¡ç®—ã€‚åŒæ—¶å¸Œæœ›ä½ ä¹Ÿèƒ½æŒæ¡,é€šè¿‡å­¦ä¹ ç‰¹å¾å‚æ•°, æ¥æ‰¾åˆ°ç›¸å…³ç”µå½±å’Œäº§å“çš„æ–¹æ³•ã€‚</p><h2 id="6-æ¨è¡Œå·¥ä½œä¸Šçš„ç»†èŠ‚-å‡å€¼å½’ä¸€åŒ–"><a href="#6-æ¨è¡Œå·¥ä½œä¸Šçš„ç»†èŠ‚-å‡å€¼å½’ä¸€åŒ–" class="headerlink" title="6.æ¨è¡Œå·¥ä½œä¸Šçš„ç»†èŠ‚:å‡å€¼å½’ä¸€åŒ–"></a>6.æ¨è¡Œå·¥ä½œä¸Šçš„ç»†èŠ‚:å‡å€¼å½’ä¸€åŒ–</h2><p>è®©æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ç”¨æˆ·è¯„åˆ†æ•°æ®:</p><script type="math/tex; mode=display">\begin{aligned}&\begin{array}{|l|l|l|l|l|}\hline \text { Movie } & \text { Alice (1) } & \text { Bob (2) } & \text { Carol (3) } & \text { Dave (4) } \\\hline \text { Love at last } & 5 & 5 & 0 & 0 \\\hline \text { Romance forever } & 5 & ? & ? & 0 \\\hline \text { Cute puppies of love } & ? & 4 & 0 & ? \\\hline \text { Nonstop car chases } & 0 & 0 & 5 & 4 \\\hline \text { Swords vs. karate } & 0 & 0 & 5 & ? \\\hline\end{array}\\&Y=\left[\begin{array}{llll}5 & 5 & 0 & 0 \\5 & ? & ? & 0 \\? & 4 & 0 & ? \\0 & 0 & 5 & 4 \\0 & 0 & 5 & 0\end{array}\right]\end{aligned}</script><p>å¦‚æœæˆ‘ä»¬æ–°å¢ä¸€ä¸ªç”¨æˆ· Eveï¼Œå¹¶ä¸” Eve æ²¡æœ‰ä¸ºä»»ä½•ç”µå½±è¯„åˆ†ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»¥ä»€ä¹ˆä¸ºä¾æ®ä¸º Eve æ¨èç”µå½±å‘¢?</p><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦å¯¹ç»“æœ$ ğ‘Œ$çŸ©é˜µè¿›è¡Œå‡å€¼å½’ä¸€åŒ–å¤„ç†ï¼Œå°†æ¯ä¸€ä¸ªç”¨æˆ·å¯¹æŸä¸€éƒ¨ç”µå½±çš„è¯„åˆ†å‡å»æ‰€æœ‰ç”¨æˆ·å¯¹è¯¥ç”µå½±è¯„åˆ†çš„å¹³å‡å€¼:</p><script type="math/tex; mode=display">Y=\left[\begin{array}{ccccc}5 & 5 & 0 & 0 & ? \\5 & ? & ? & 0 & ? \\? & 4 & 0 & ? & ? \\0 & 0 & 5 & 4 & ? \\0 & 0 & 5 & 0 & ?\end{array}\right] \quad \mu=\left[\begin{array}{c}2.5 \\2.5 \\2 \\2.25 \\1.25\end{array}\right] \rightarrow Y=\left[\begin{array}{ccccc}2.5 & 2.5 & -2.5 & -2.5 & ? \\2.5 & ? & ? & -2.5 & ? \\? & 2 & -2 & ? & ? \\-2.25 & -2.25 & 2.75 & 1.75 & ? \\-1.25 & -1.25 & 3.75 & -1.25 & ?\end{array}\right]</script><p>ç„¶åæˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªæ–°çš„ $Y$ çŸ©é˜µæ¥è®­ç»ƒç®—æ³•ã€‚ å¦‚æœæˆ‘ä»¬è¦ç”¨æ–°è®­ç»ƒå‡ºçš„ç®—æ³•æ¥é¢„æµ‹è¯„åˆ†ï¼Œåˆ™éœ€è¦å°†å¹³å‡å€¼é‡æ–°åŠ å›å»ï¼Œé¢„æµ‹ $\left(\theta^{(j)}\right)^{T} x^{(i)}+\mu_{i},$ å¯¹äº Eveï¼Œæˆ‘ä»¬çš„æ–°æ¨¡å‹ä¼šè®¤ä¸ºå¥¹ç»™æ¯éƒ¨ç”µå½±çš„è¯„åˆ†éƒ½æ˜¯è¯¥ç”µå½±çš„å¹³å‡åˆ†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> æ¨èç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>09_å¼‚å¸¸æ£€æµ‹(Anomaly Detection)</title>
      <link href="2020/12/10/machinelearning/wu-en-da-ji-qi-xue-xi/09-anomaly-detection/"/>
      <url>2020/12/10/machinelearning/wu-en-da-ji-qi-xue-xi/09-anomaly-detection/</url>
      
        <content type="html"><![CDATA[<h2 id="1-é—®é¢˜çš„åŠ¨æœº"><a href="#1-é—®é¢˜çš„åŠ¨æœº" class="headerlink" title="1.é—®é¢˜çš„åŠ¨æœº"></a>1.é—®é¢˜çš„åŠ¨æœº</h2><p>å¼‚å¸¸æ£€æµ‹(Anomaly detection)é—®é¢˜æ˜¯æœºå™¨å­¦ä¹ ç®—æ³•çš„ä¸€ä¸ªå¸¸è§åº”ç”¨ã€‚è¿™ç§ç®—æ³•çš„ä¸€ä¸ªæœ‰è¶£ä¹‹å¤„åœ¨äº:å®ƒè™½ç„¶ä¸»è¦ç”¨äºéç›‘ç£å­¦ä¹ é—® é¢˜ï¼Œä½†ä»æŸäº›è§’åº¦çœ‹ï¼Œå®ƒåˆç±»ä¼¼äºä¸€äº›ç›‘ç£å­¦ä¹ é—®é¢˜ã€‚</p><p> ä¾‹å¦‚ä½ æ˜¯ä¸€ä¸ªé£æœºå¼•æ“åˆ¶é€ å•†ï¼Œå½“ä½ ç”Ÿäº§çš„é£æœºå¼•æ“ä»ç”Ÿäº§çº¿ä¸Šæµå‡ºæ—¶ï¼Œä½ éœ€è¦è¿›è¡Œè´¨é‡æ§åˆ¶æµ‹è¯•ï¼Œè€Œä½œä¸ºè¿™ä¸ªæµ‹è¯•çš„ä¸€éƒ¨åˆ†ï¼Œä½ æµ‹é‡äº†é£æœºå¼•æ“çš„ä¸€äº›ç‰¹å¾å˜é‡ï¼Œæ¯”å¦‚å¼•æ“è¿è½¬æ—¶äº§ç”Ÿçš„çƒ­é‡ï¼Œæˆ–è€…å¼•æ“çš„æŒ¯åŠ¨ç­‰ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209163209.png" alt="image-20201209163209508"></p><p>è¿™æ ·ä¸€æ¥ï¼Œä½ å°±æœ‰äº†ä¸€ä¸ªæ•°æ®é›†ï¼Œä»$ğ‘¥^{(1)}$åˆ°$ğ‘¥^{(ğ‘š)}$ï¼Œå¦‚æœä½ ç”Ÿäº§äº†$ğ‘š$ä¸ªå¼•æ“çš„è¯ï¼Œä½ å°†è¿™äº›æ•°æ®ç»˜åˆ¶æˆå›¾è¡¨ï¼Œçœ‹èµ·æ¥å°±æ˜¯è¿™ä¸ªæ ·å­:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209163305.png" alt="image-20201209163305193"></p><p>è¿™é‡Œçš„æ¯ä¸ªç‚¹ã€æ¯ä¸ªå‰ï¼Œéƒ½æ˜¯ä½ çš„æ— æ ‡ç­¾æ•°æ®ã€‚è¿™æ ·ï¼Œå¼‚å¸¸æ£€æµ‹é—®é¢˜å¯ä»¥å®šä¹‰å¦‚ä¸‹:æˆ‘ä»¬å‡è®¾åæ¥æœ‰ä¸€å¤©ï¼Œä½ æœ‰ä¸€ä¸ªæ–°çš„é£æœºå¼•æ“ä»ç”Ÿäº§çº¿ä¸Šæµå‡ºï¼Œè€Œä½ çš„æ–°é£æœºå¼•æ“æœ‰ç‰¹å¾å˜é‡$ğ‘¥_{ğ‘¡ğ‘’ğ‘ ğ‘¡}$ ã€‚æ‰€è°“çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜å°±æ˜¯:æˆ‘ä»¬å¸Œæœ›çŸ¥é“è¿™ä¸ªæ–°çš„é£æœºå¼•æ“æ˜¯å¦æœ‰æŸç§å¼‚å¸¸ï¼Œæˆ–è€…è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ¤æ–­è¿™ä¸ªå¼•æ“æ˜¯å¦éœ€è¦è¿›ä¸€æ­¥æµ‹è¯•ã€‚å› ä¸ºï¼Œå¦‚æœå®ƒçœ‹èµ·æ¥åƒä¸€ä¸ªæ­£å¸¸çš„å¼•æ“ï¼Œé‚£ä¹ˆ æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å®ƒè¿é€åˆ°å®¢æˆ·é‚£é‡Œï¼Œè€Œä¸éœ€è¦è¿›ä¸€æ­¥çš„æµ‹è¯•ã€‚</p><p>ç»™å®šæ•°æ®é›† $x^{(1)}, x^{(2)}, \ldots, x^{(m)},$ æˆ‘ä»¬å‡ä½¿æ•°æ®é›†æ˜¯æ­£å¸¸çš„, æˆ‘ä»¬å¸Œæœ›çŸ¥é“æ–°çš„æ•°æ® $x_{\text {test}}$æ˜¯ä¸æ˜¯å¼‚å¸¸çš„, å³è¿™ä¸ªæµ‹è¯•æ•°æ®ä¸å±äºè¯¥ç»„æ•°æ®çš„å‡ ç‡å¦‚ä½•ã€‚æˆ‘ä»¬æ‰€æ„å»ºçš„æ¨¡å‹åº”è¯¥èƒ½æ ¹æ®è¯¥æµ‹è¯•æ•°æ®çš„ä½ç½®å‘Šè¯‰æˆ‘ä»¬å…¶å±äºä¸€ç»„æ•°æ®çš„å¯èƒ½æ€§ $p(x)$ ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209163429.png" alt="image-20201209163429830"></p><p>ä¸Šå›¾ä¸­ï¼Œåœ¨è“è‰²åœˆå†…çš„æ•°æ®å±äºè¯¥ç»„æ•°æ®çš„å¯èƒ½æ€§è¾ƒé«˜ï¼Œè€Œè¶Šæ˜¯åè¿œçš„æ•°æ®ï¼Œå…¶å±äºè¯¥ç»„æ•°æ®çš„å¯èƒ½æ€§å°±è¶Šä½ã€‚<br>è¿™ç§æ–¹æ³•ç§°ä¸ºå¯†åº¦ä¼°è®¡ï¼Œè¡¨è¾¾å¦‚ä¸‹:</p><script type="math/tex; mode=display">\text { if } \quad p(x)\left\{\begin{array}{ll}<\varepsilon & \text { anomal } y \\>=\varepsilon & \text { normal }\end{array}\right.</script><p>æ¬ºè®¡æ£€æµ‹: $x^{(i)}=$ ç”¨æˆ·çš„ç¬¬ $i$ ä¸ªæ´»åŠ¨ç‰¹å¾æ¨¡å‹ $p(x)$ ä¸ºæˆ‘ä»¬å…¶å±äºä¸€ç»„æ•°æ®çš„å¯èƒ½æ€§ï¼Œé€šè¿‡ $p(x)&lt;\varepsilon$ æ£€æµ‹éæ­£å¸¸ç”¨æˆ·ã€‚</p><p>å¼‚å¸¸æ£€æµ‹ä¸»è¦ç”¨æ¥è¯†åˆ«æ¬ºéª—ã€‚ä¾‹å¦‚åœ¨çº¿é‡‡é›†è€Œæ¥çš„æœ‰å…³ç”¨æˆ·çš„æ•°æ®ï¼Œä¸€ä¸ªç‰¹å¾å‘é‡ä¸­å¯èƒ½ä¼šåŒ…å«å¦‚: ç”¨æˆ·å¤šä¹…ç™»å½•ä¸€æ¬¡ï¼Œè®¿é—®è¿‡çš„é¡µé¢ï¼Œåœ¨è®ºå›å‘å¸ƒçš„å¸–å­æ•°é‡ï¼Œç”šè‡³æ˜¯æ‰“å­—é€Ÿåº¦ç­‰ã€‚</p><p>å°è¯•æ ¹æ®è¿™äº›ç‰¹å¾æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ¨¡å‹æ¥è¯†åˆ«é‚£äº›ä¸ç¬¦åˆè¯¥æ¨¡å¼çš„ç”¨æˆ·ã€‚å†ä¸€ä¸ªä¾‹å­æ˜¯æ£€æµ‹ä¸€ä¸ªæ•°æ®ä¸­å¿ƒï¼Œç‰¹å¾å¯èƒ½åŒ…å«ï¼šå†…å­˜ä½¿ç”¨æƒ…å†µï¼Œè¢«è®¿é—®çš„ç£ç›˜æ•°é‡,CPU çš„è´Ÿè½½ï¼Œç½‘ç»œçš„é€šä¿¡é‡ç­‰ã€‚æ ¹æ®è¿™äº›ç‰¹å¾å¯ä»¥æ„å»ºä¸€ä¸ªæ¨¡å‹ï¼Œç”¨æ¥åˆ¤æ–­æŸäº›è®¡ç®—æœºæ˜¯ä¸æ˜¯æœ‰å¯èƒ½å‡ºé”™äº†ã€‚</p><h2 id="2-é«˜æ–¯åˆ†å¸ƒ"><a href="#2-é«˜æ–¯åˆ†å¸ƒ" class="headerlink" title="2.é«˜æ–¯åˆ†å¸ƒ"></a>2.é«˜æ–¯åˆ†å¸ƒ</h2><p>é«˜æ–¯åˆ†å¸ƒï¼Œä¹Ÿç§°ä¸ºæ­£æ€åˆ†å¸ƒã€‚</p><p>é€šå¸¸å¦‚æœæˆ‘ä»¬è®¤ä¸ºå˜é‡ $x$ ç¬¦åˆé«˜æ–¯åˆ†å¸ƒ $x \sim N\left(\mu, \sigma^{2}\right)$ åˆ™å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º$p\left(x, \mu, \sigma^{2}\right)=\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right)$ ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å·²æœ‰çš„æ•°æ®æ¥é¢„æµ‹æ€»ä½“ä¸­çš„ $\mu$ å’Œ $\sigma^{2}$ çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ : </p><script type="math/tex; mode=display">\quad \mu=\frac{1}{m} \sum_{i=1}^{m} x^{(i)}</script><script type="math/tex; mode=display">\sigma^{2}=\frac{1}{m} \sum_{i=1}^{m}\left(x^{(i)}-\mu\right)^{2}</script><p>é«˜æ–¯åˆ†å¸ƒæ ·ä¾‹:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210103351.png" alt="é«˜æ–¯åˆ†å¸ƒæ ·ä¾‹"></p><h2 id="3-ç®—æ³•"><a href="#3-ç®—æ³•" class="headerlink" title="3.ç®—æ³•"></a>3.ç®—æ³•</h2><p>åº”ç”¨é«˜æ–¯åˆ†å¸ƒå¼€å‘å¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚</p><p>å¯¹äºç»™å®šçš„æ•°æ®é›† $x^{(1)}, x^{(2)}, \ldots, x^{(m)},$ æˆ‘ä»¬è¦é’ˆå¯¹æ¯ä¸€ä¸ªç‰¹å¾è®¡ç®— $\mu$ å’Œ $\sigma^{2}$ çš„ä¼°è®¡å€¼ã€‚</p><script type="math/tex; mode=display">\begin{array}{c}\mu_{j}=\frac{1}{m} \sum_{i=1}^{m} x_{j}^{(i)} \\\sigma_{j}^{2}=\frac{1}{m} \sum_{i=1}^{m}\left(x_{j}^{(i)}-\mu_{j}\right)^{2}\end{array}</script><p>ä¸€æ—¦æˆ‘ä»¬è·å¾—äº†å¹³å‡å€¼å’Œæ–¹å·®çš„ä¼°è®¡å€¼,ç»™å®šæ–°çš„ä¸€ä¸ªè®­ç»ƒå®ä¾‹,æ ¹æ®æ¨¡å‹è®¡ç®— $p(x)$ :</p><script type="math/tex; mode=display">p(x)=\prod_{j=1}^{n} p\left(x_{j} ; \mu_{j}, \sigma_{j}^{2}\right)=\prod_{j=1}^{1} \frac{1}{\sqrt{2 \pi} \sigma_{j}} \exp \left(-\frac{\left(x_{j}-\mu_{j}\right)^{2}}{2 \sigma_{j}^{2}}\right)</script><p>å½“ $p(x)&lt;\varepsilon$ æ—¶ï¼Œä¸ºå¼‚å¸¸ã€‚</p><p>ä¸‹å›¾æ˜¯ä¸€ä¸ªç”±ä¸¤ä¸ªç‰¹å¾çš„è®­ç»ƒé›†ï¼Œä»¥åŠç‰¹å¾çš„åˆ†å¸ƒæƒ…å†µ:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210103633.png" alt="ä¸¤ä¸ªç‰¹å¾çš„è®­ç»ƒé›†"></p><p>ä¸‹é¢çš„ä¸‰ç»´å›¾è¡¨è¡¨ç¤ºçš„æ˜¯å¯†åº¦ä¼°è®¡å‡½æ•°ï¼Œğ‘§è½´ä¸ºæ ¹æ®ä¸¤ä¸ªç‰¹å¾çš„å€¼æ‰€ä¼°è®¡$ğ‘(ğ‘¥)$å€¼:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210103824.png" alt="å¯†åº¦ä¼°è®¡å‡½æ•°"></p><p>æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ª $\varepsilon$ï¼Œ å°† $p(x)=\varepsilon$ ä½œä¸ºæˆ‘ä»¬çš„åˆ¤å®šè¾¹ç•Œï¼Œå½“ $p(x)&gt;\varepsilon$ æ—¶é¢„æµ‹æ•°æ®ä¸ºæ­£å¸¸æ•°æ®ï¼Œå¦åˆ™ä¸ºå¼‚å¸¸ã€‚<br>åœ¨è¿™æ®µè§†é¢‘ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•æ‹Ÿåˆ $p(x)$, ä¹Ÿå°±æ˜¯ $x$ çš„æ¦‚ç‡å€¼ï¼Œä»¥å¼€å‘å‡ºä¸€ç§å¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚åŒæ—¶ï¼Œåœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿç»™å‡ºäº†é€šè¿‡ç»™å‡ºçš„æ•°æ®é›†æ‹Ÿåˆå‚æ•°ï¼Œè¿›è¡Œå‚æ•°ä¼°è®¡ï¼Œå¾—åˆ°å‚æ•° $\mu$ å’Œ $\sigma,$ ç„¶åæ£€æµ‹æ–°çš„æ ·æœ¬ï¼Œç¡®å®šæ–°æ ·æœ¬æ˜¯å¦æ˜¯å¼‚å¸¸ã€‚</p><h2 id="4-å¼€å‘å’Œè¯„ä»·ä¸€ä¸ªå¼‚å¸¸æ£€æµ‹ç³»ç»Ÿ"><a href="#4-å¼€å‘å’Œè¯„ä»·ä¸€ä¸ªå¼‚å¸¸æ£€æµ‹ç³»ç»Ÿ" class="headerlink" title="4.å¼€å‘å’Œè¯„ä»·ä¸€ä¸ªå¼‚å¸¸æ£€æµ‹ç³»ç»Ÿ"></a>4.å¼€å‘å’Œè¯„ä»·ä¸€ä¸ªå¼‚å¸¸æ£€æµ‹ç³»ç»Ÿ</h2><p>å¼‚å¸¸æ£€æµ‹ç®—æ³•æ˜¯ä¸€ä¸ªéç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œæ„å‘³ç€æˆ‘ä»¬æ— æ³•æ ¹æ®ç»“æœå˜é‡ ğ‘¦ çš„å€¼æ¥å‘Šè¯‰æˆ‘ ä»¬æ•°æ®æ˜¯å¦çœŸçš„æ˜¯å¼‚å¸¸çš„ã€‚æˆ‘ä»¬éœ€è¦å¦ä¸€ç§æ–¹æ³•æ¥å¸®åŠ©æ£€éªŒç®—æ³•æ˜¯å¦æœ‰æ•ˆã€‚å½“æˆ‘ä»¬å¼€å‘ä¸€ä¸ªå¼‚å¸¸æ£€æµ‹ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬ä»å¸¦æ ‡è®°ï¼ˆå¼‚å¸¸æˆ–æ­£å¸¸ï¼‰çš„æ•°æ®ç€æ‰‹ï¼Œæˆ‘ä»¬ä»å…¶ä¸­é€‰æ‹©ä¸€éƒ¨åˆ†æ­£å¸¸æ•°æ®ç”¨äºæ„å»ºè®­ç»ƒé›†ï¼Œç„¶åç”¨å‰©ä¸‹çš„æ­£å¸¸æ•°æ®å’Œå¼‚å¸¸æ•°æ®æ··åˆçš„æ•°æ®æ„æˆäº¤å‰æ£€éªŒé›†å’Œæµ‹è¯•é›†ã€‚</p><p>ä¾‹å¦‚:æˆ‘ä»¬æœ‰ 10000 å°æ­£å¸¸å¼•æ“çš„æ•°æ®ï¼Œæœ‰ 20 å°å¼‚å¸¸å¼•æ“çš„æ•°æ®ã€‚ æˆ‘ä»¬è¿™æ ·åˆ†é…æ•°æ®:</p><ul><li><p>6000 å°æ­£å¸¸å¼•æ“çš„æ•°æ®ä½œä¸ºè®­ç»ƒé›†</p></li><li><p>2000 å°æ­£å¸¸å¼•æ“å’Œ 10 å°å¼‚å¸¸å¼•æ“çš„æ•°æ®ä½œä¸ºäº¤å‰æ£€éªŒé›†</p></li><li><p>2000 å°æ­£å¸¸å¼•æ“å’Œ 10 å°å¼‚å¸¸å¼•æ“çš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†</p></li></ul><p>å…·ä½“çš„è¯„ä»·æ–¹æ³•å¦‚ä¸‹:</p><ol><li>æ ¹æ®æµ‹è¯•é›†æ•°æ®ï¼Œæˆ‘ä»¬ä¼°è®¡ç‰¹å¾çš„å¹³å‡å€¼å’Œæ–¹å·®å¹¶æ„å»º$ğ‘(ğ‘¥)$å‡½æ•°</li><li>å¯¹äº¤å‰æ£€éªŒé›†ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨ä¸åŒçš„$\varepsilon,$å€¼ä½œä¸ºé˜€å€¼ï¼Œå¹¶é¢„æµ‹æ•°æ®æ˜¯å¦å¼‚å¸¸ï¼Œæ ¹æ®F1å€¼æˆ–è€…æŸ¥å‡†ç‡ä¸æŸ¥å…¨ç‡çš„æ¯”ä¾‹æ¥é€‰æ‹© $\varepsilon,$</li><li>é€‰å‡º$\varepsilon,$ åï¼Œé’ˆå¯¹æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹ï¼Œè®¡ç®—å¼‚å¸¸æ£€éªŒç³»ç»Ÿçš„$ğ¹1$å€¼ï¼Œæˆ–è€…æŸ¥å‡†ç‡ä¸æŸ¥å…¨ç‡</li></ol><p>ä¹‹æ¯”ã€‚</p><h2 id="5-å¼‚å¸¸æ£€æµ‹ä¸ç›‘ç£å­¦ä¹ å¯¹æ¯”"><a href="#5-å¼‚å¸¸æ£€æµ‹ä¸ç›‘ç£å­¦ä¹ å¯¹æ¯”" class="headerlink" title="5.å¼‚å¸¸æ£€æµ‹ä¸ç›‘ç£å­¦ä¹ å¯¹æ¯”"></a>5.å¼‚å¸¸æ£€æµ‹ä¸ç›‘ç£å­¦ä¹ å¯¹æ¯”</h2><p>ä¹‹å‰æˆ‘ä»¬æ„å»ºçš„å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿä¹Ÿä½¿ç”¨äº†å¸¦æ ‡è®°çš„æ•°æ®ï¼Œä¸ç›‘ç£å­¦ä¹ æœ‰äº›ç›¸ä¼¼ï¼Œä¸‹é¢çš„å¯¹ æ¯”æœ‰åŠ©äºé€‰æ‹©é‡‡ç”¨ç›‘ç£å­¦ä¹ è¿˜æ˜¯å¼‚å¸¸æ£€æµ‹:</p><p>ä¸¤è€…æ¯”è¾ƒ:</p><div class="table-container"><table><thead><tr><th>å¼‚å¸¸æ£€æµ‹</th><th style="text-align:left">ç›‘ç£å­¦ä¹ </th></tr></thead><tbody><tr><td>éå¸¸å°‘é‡çš„æ­£å‘ç±»ï¼ˆå¼‚å¸¸æ•°æ® ğ‘¦ = 1ï¼‰, å¤§é‡çš„è´Ÿå‘ç±»(ğ‘¦ = 0)</td><td style="text-align:left">åŒæ—¶æœ‰å¤§é‡çš„æ­£å‘ç±»å’Œè´Ÿå‘ç±»</td></tr><tr><td>è®¸å¤šä¸åŒç§ç±»çš„å¼‚å¸¸ï¼Œéå¸¸éš¾ã€‚æ ¹æ®éå¸¸å°‘ é‡çš„æ­£å‘ç±»æ•°æ®æ¥è®­ç»ƒç®—æ³•ã€‚</td><td style="text-align:left">æœ‰è¶³å¤Ÿå¤šçš„æ­£å‘ç±»å®ä¾‹ï¼Œè¶³å¤Ÿç”¨äºè®­ç»ƒç®—æ³•ï¼Œæœªæ¥é‡åˆ°çš„æ­£å‘ç±»å®ä¾‹å¯èƒ½ä¸è®­ç»ƒé›†ä¸­çš„éå¸¸è¿‘ä¼¼ã€‚</td></tr><tr><td>æœªæ¥é‡åˆ°çš„å¼‚å¸¸å¯èƒ½ä¸å·²æŒæ¡çš„å¼‚å¸¸ã€éå¸¸çš„ä¸åŒã€‚</td><td style="text-align:left"></td></tr><tr><td>ä¾‹å¦‚:æ¬ºè¯ˆè¡Œä¸ºæ£€æµ‹ç”Ÿäº§ï¼ˆä¾‹å¦‚é£æœºå¼•æ“ï¼‰ æ£€æµ‹æ•°æ®ä¸­å¿ƒçš„è®¡ç®—æœºè¿è¡ŒçŠ¶å†µ</td><td style="text-align:left">ä¾‹å¦‚:é‚®ä»¶è¿‡æ»¤å™¨ å¤©æ°”é¢„æŠ¥ è‚¿ç˜¤åˆ†ç±»</td></tr></tbody></table></div><h2 id="6-é€‰æ‹©ç‰¹å¾"><a href="#6-é€‰æ‹©ç‰¹å¾" class="headerlink" title="6.é€‰æ‹©ç‰¹å¾"></a>6.é€‰æ‹©ç‰¹å¾</h2><p>å¯¹äºå¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ç‰¹å¾æ˜¯è‡³å…³é‡è¦çš„ï¼Œä¸‹é¢è°ˆè°ˆå¦‚ä½•é€‰æ‹©ç‰¹å¾:</p><p>å¼‚å¸¸æ£€æµ‹å‡è®¾ç‰¹å¾ç¬¦åˆé«˜æ–¯åˆ†å¸ƒï¼Œå¦‚æœæ•°æ®çš„åˆ†å¸ƒä¸æ˜¯é«˜æ–¯åˆ†å¸ƒï¼Œå¼‚å¸¸æ£€æµ‹ç®—æ³•ä¹Ÿèƒ½å¤Ÿ å·¥ä½œï¼Œä½†æ˜¯æœ€å¥½è¿˜æ˜¯å°†æ•°æ®è½¬æ¢æˆé«˜æ–¯åˆ†å¸ƒï¼Œä¾‹å¦‚ä½¿ç”¨å¯¹æ•°å‡½æ•°:$ğ‘¥ = ğ‘™ğ‘œğ‘”(ğ‘¥ + ğ‘)$ï¼Œå…¶ä¸­ $ğ‘$ ä¸ºéè´Ÿå¸¸æ•°; æˆ–è€…$ ğ‘¥ = ğ‘¥^ğ‘$ï¼Œğ‘ä¸º 0-1 ä¹‹é—´çš„ä¸€ä¸ªåˆ†æ•°ï¼Œç­‰æ–¹æ³•ã€‚</p><p>ï¼ˆæ³¨:åœ¨ python ä¸­ï¼Œé€šå¸¸ç”¨ np.log1p()å‡½æ•°ï¼Œ$ğ‘™ğ‘œğ‘”1ğ‘$å°±æ˜¯ $ğ‘™ğ‘œğ‘”(ğ‘¥ + 1)$ï¼Œå¯ä»¥é¿å… å‡ºç°è´Ÿæ•°ç»“æœï¼Œåå‘å‡½æ•°å°±æ˜¯ np.expm1ï¼ˆï¼‰ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210112512.png" alt="image-20201210112512865"></p><p>è¯¯å·®åˆ†æ:</p><p>ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯ä¸€äº›å¼‚å¸¸çš„æ•°æ®å¯èƒ½ä¹Ÿä¼šæœ‰è¾ƒé«˜çš„ğ‘(ğ‘¥)å€¼ï¼Œå› è€Œè¢«ç®—æ³•è®¤ä¸ºæ˜¯æ­£å¸¸çš„ã€‚ è¿™ç§æƒ…å†µä¸‹è¯¯å·®åˆ†æèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æé‚£äº›è¢«ç®—æ³•é”™è¯¯é¢„æµ‹ä¸ºæ­£å¸¸çš„æ•°æ®ï¼Œè§‚å¯Ÿèƒ½å¦æ‰¾å‡ºä¸€äº›é—®é¢˜ã€‚æˆ‘ä»¬å¯èƒ½èƒ½ä»é—®é¢˜ä¸­å‘ç°æˆ‘ä»¬éœ€è¦å¢åŠ ä¸€äº›æ–°çš„ç‰¹å¾ï¼Œå¢åŠ è¿™äº›æ–°ç‰¹å¾åè·å¾—çš„æ–°ç®—æ³•èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚</p><p>æˆ‘ä»¬é€šå¸¸å¯ä»¥é€šè¿‡å°†ä¸€äº›ç›¸å…³çš„ç‰¹å¾è¿›è¡Œç»„åˆï¼Œæ¥è·å¾—ä¸€äº›æ–°çš„æ›´å¥½çš„ç‰¹å¾(å¼‚å¸¸æ•°æ® çš„è¯¥ç‰¹å¾å€¼å¼‚å¸¸åœ°å¤§æˆ–å°)ï¼Œä¾‹å¦‚ï¼Œåœ¨æ£€æµ‹æ•°æ®ä¸­å¿ƒçš„è®¡ç®—æœºçŠ¶å†µçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ CPU è´Ÿè½½ä¸ç½‘ç»œé€šä¿¡é‡çš„æ¯”ä¾‹ä½œä¸ºä¸€ä¸ªæ–°çš„ç‰¹å¾ï¼Œå¦‚æœè¯¥å€¼å¼‚å¸¸åœ°å¤§ï¼Œä¾¿æœ‰å¯èƒ½æ„å‘³ç€è¯¥æœåŠ¡å™¨ æ˜¯é™·å…¥äº†ä¸€äº›é—®é¢˜ä¸­ã€‚</p><p>åœ¨è¿™æ®µè§†é¢‘ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•é€‰æ‹©ç‰¹å¾ï¼Œä»¥åŠå¯¹ç‰¹å¾è¿›è¡Œä¸€äº›å°å°çš„è½¬æ¢ï¼Œè®©æ•°æ®æ›´ åƒæ­£æ€åˆ†å¸ƒï¼Œç„¶åå†æŠŠæ•°æ®è¾“å…¥å¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚åŒæ—¶ä¹Ÿä»‹ç»äº†å»ºç«‹ç‰¹å¾æ—¶ï¼Œè¿›è¡Œçš„è¯¯å·®åˆ†æ æ–¹æ³•ï¼Œæ¥æ•æ‰å„ç§å¼‚å¸¸çš„å¯èƒ½ã€‚å¸Œæœ›ä½ é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œèƒ½å¤Ÿäº†è§£å¦‚ä½•é€‰æ‹©å¥½çš„ç‰¹å¾å˜é‡ï¼Œä» è€Œå¸®åŠ©ä½ çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œæ•æ‰åˆ°å„ç§ä¸åŒçš„å¼‚å¸¸æƒ…å†µã€‚</p><h2 id="7-å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ"><a href="#7-å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ" class="headerlink" title="7.å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ"></a>7.å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ</h2><p>å‡ä½¿æˆ‘ä»¬æœ‰ä¸¤ä¸ªç›¸å…³çš„ç‰¹å¾ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªç‰¹å¾çš„å€¼åŸŸèŒƒå›´æ¯”è¾ƒå®½ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¸€èˆ¬çš„ é«˜æ–¯åˆ†å¸ƒæ¨¡å‹å¯èƒ½ä¸èƒ½å¾ˆå¥½åœ°è¯†åˆ«å¼‚å¸¸æ•°æ®ã€‚å…¶åŸå› åœ¨äºï¼Œä¸€èˆ¬çš„é«˜æ–¯åˆ†å¸ƒæ¨¡å‹å°è¯•çš„æ˜¯å» åŒæ—¶æŠ“ä½ä¸¤ä¸ªç‰¹å¾çš„åå·®ï¼Œå› æ­¤åˆ›é€ å‡ºä¸€ä¸ªæ¯”è¾ƒå¤§çš„åˆ¤å®šè¾¹ç•Œã€‚</p><p>ä¸‹å›¾ä¸­æ˜¯ä¸¤ä¸ªç›¸å…³ç‰¹å¾ï¼Œæ´‹çº¢è‰²çš„çº¿ï¼ˆæ ¹æ®$\varepsilon$çš„ä¸åŒå…¶èŒƒå›´å¯å¤§å¯å°ï¼‰æ˜¯ä¸€èˆ¬çš„é«˜æ–¯åˆ†å¸ƒæ¨¡å‹è·å¾—çš„åˆ¤å®šè¾¹ç•Œï¼Œå¾ˆæ˜æ˜¾ç»¿è‰²çš„$X$æ‰€ä»£è¡¨çš„æ•°æ®ç‚¹å¾ˆå¯èƒ½æ˜¯å¼‚å¸¸å€¼ï¼Œä½†æ˜¯å…¶$ğ‘(ğ‘¥)$å€¼å´ ä»ç„¶åœ¨æ­£å¸¸èŒƒå›´å†…ã€‚å¤šå…ƒé«˜æ–¯åˆ†å¸ƒå°†åˆ›å»ºåƒå›¾ä¸­è“è‰²æ›²çº¿æ‰€ç¤ºçš„åˆ¤å®šè¾¹ç•Œã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210132534.png" alt="åˆ¤å®šè¾¹ç•Œ"></p><p>åœ¨ä¸€èˆ¬çš„é«˜æ–¯åˆ†å¸ƒæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬è®¡ç®—$ ğ‘(ğ‘¥)$ çš„æ–¹æ³•æ˜¯: é€šè¿‡åˆ†åˆ«è®¡ç®—æ¯ä¸ªç‰¹å¾å¯¹åº”çš„å‡ ç‡ç„¶åå°†å…¶ç´¯ä¹˜èµ·æ¥ï¼Œåœ¨å¤šå…ƒé«˜æ–¯åˆ†å¸ƒæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºç‰¹å¾çš„åæ–¹å·®çŸ©é˜µï¼Œç”¨æ‰€æœ‰çš„ç‰¹å¾ä¸€èµ·æ¥è®¡ç®— $ğ‘(ğ‘¥)$ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆè®¡ç®—æ‰€æœ‰ç‰¹å¾çš„å¹³å‡å€¼ï¼Œç„¶åå†è®¡ç®—åæ–¹å·®çŸ©é˜µ:</p><script type="math/tex; mode=display">\begin{array}{c}p(x)=\prod_{j=1}^{n} p\left(x_{j} ; \mu, \sigma_{j}^{2}\right)=\prod_{j=1}^{n} \frac{1}{\sqrt{2 \pi} \sigma_{j}} \exp \left(-\frac{\left(x_{j}-\mu_{j}\right)^{2}}{2 \sigma_{j}^{2}}\right) \\\mu=\frac{1}{m} \sum_{i=1}^{m} x^{(i)} \\\Sigma=\frac{1}{m} \sum_{i=1}^{m}\left(x^{(i)}-\mu\right)\left(x^{(i)}-\mu\right)^{T}=\frac{1}{m}(X-\mu)^{T}(X-\mu)\end{array}</script><p>æ³¨:å…¶ä¸­ $\mu$ æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå…¶æ¯ä¸€ä¸ªå•å…ƒéƒ½æ˜¯åŸç‰¹å¾çŸ©é˜µä¸­ä¸€è¡Œæ•°æ®çš„å‡å€¼ã€‚æœ€åæˆ‘ä»¬è®¡ç®—å¤šå…ƒé«˜æ–¯åˆ†å¸ƒçš„p(x): </p><script type="math/tex; mode=display">p(x)=\frac{1}{(2 \pi)^{\frac{n}{2}|\Sigma|^{\frac{1}{2}}}} \exp \left(-\frac{1}{2}(x-\mu)^{T} \Sigma^{-1}(x-\mu)\right)</script><p>å…¶ä¸­:</p><p>$|\Sigma|$æ˜¯å®šçŸ©é˜µï¼Œåœ¨ Octave ä¸­ç”¨ det(sigma)è®¡ç®—</p><p>$\Sigma^{-1}$ æ˜¯é€†çŸ©é˜µï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹åæ–¹å·®çŸ©é˜µæ˜¯å¦‚ä½•å½±å“æ¨¡å‹çš„:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210132934.png" alt="åæ–¹å·®çŸ©é˜µå¯¹æ¨¡å‹çš„å½±å“"></p><p>ä¸Šå›¾æ˜¯ 5 ä¸ªä¸åŒçš„æ¨¡å‹ï¼Œä»å·¦å¾€å³ä¾æ¬¡åˆ†æ:</p><ol><li><p>æ˜¯ä¸€ä¸ªä¸€èˆ¬çš„é«˜æ–¯åˆ†å¸ƒæ¨¡å‹</p></li><li><p>é€šè¿‡åæ–¹å·®çŸ©é˜µï¼Œä»¤ç‰¹å¾ 1 æ‹¥æœ‰è¾ƒå°çš„åå·®ï¼ŒåŒæ—¶ä¿æŒç‰¹å¾ 2 çš„åå·®</p></li><li><p>é€šè¿‡åæ–¹å·®çŸ©é˜µï¼Œä»¤ç‰¹å¾ 2 æ‹¥æœ‰è¾ƒå¤§çš„åå·®ï¼ŒåŒæ—¶ä¿æŒç‰¹å¾ 1 çš„åå·®</p></li><li><p>é€šè¿‡åæ–¹å·®çŸ©é˜µï¼Œåœ¨ä¸æ”¹å˜ä¸¤ä¸ªç‰¹å¾çš„åŸæœ‰åå·®çš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸¤è€…ä¹‹é—´çš„æ­£ç›¸å…³æ€§</p></li><li><p>é€šè¿‡åæ–¹å·®çŸ©é˜µï¼Œåœ¨ä¸æ”¹å˜ä¸¤ä¸ªç‰¹å¾çš„åŸæœ‰åå·®çš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸¤è€…ä¹‹é—´çš„è´Ÿç›¸å…³æ€§</p></li></ol><p>å¤šå…ƒé«˜æ–¯åˆ†å¸ƒæ¨¡å‹ä¸åŸé«˜æ–¯åˆ†å¸ƒæ¨¡å‹çš„å…³ç³»: </p><p>å¯ä»¥è¯æ˜çš„æ˜¯ï¼ŒåŸæœ¬çš„é«˜æ–¯åˆ†å¸ƒæ¨¡å‹æ˜¯å¤šå…ƒé«˜æ–¯åˆ†å¸ƒæ¨¡å‹çš„ä¸€ä¸ªå­é›†ï¼Œå³åƒä¸Šå›¾ä¸­çš„ç¬¬1ã€2ã€3ï¼Œ3 ä¸ªä¾‹å­æ‰€ç¤ºï¼Œå¦‚æœåæ–¹å·®çŸ©é˜µåªåœ¨å¯¹è§’çº¿çš„å•ä½ä¸Šæœ‰éé›¶çš„å€¼æ—¶ï¼Œå³ä¸ºåŸæœ¬çš„é«˜æ–¯åˆ†å¸ƒæ¨¡å‹äº†ã€‚</p><p>åŸé«˜æ–¯åˆ†å¸ƒæ¨¡å‹å’Œå¤šå…ƒé«˜æ–¯åˆ†å¸ƒæ¨¡å‹çš„æ¯”è¾ƒ:</p><div class="table-container"><table><thead><tr><th>åŸé«˜æ–¯åˆ†å¸ƒæ¨¡å‹</th><th>å¤šå…ƒé«˜æ–¯åˆ†å¸ƒæ¨¡å‹</th></tr></thead><tbody><tr><td>ä¸èƒ½æ•æ‰ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ä½†å¯ä»¥é€šè¿‡å°†ç‰¹å¾è¿›è¡Œç»„åˆçš„æ–¹æ³•æ¥è§£å†³</td><td>è‡ªåŠ¨æ•æ‰ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§</td></tr><tr><td>è®¡ç®—ä»£ä»·ä½ï¼Œèƒ½é€‚åº”å¤§è§„æ¨¡çš„ç‰¹å¾</td><td>è®¡ç®—ä»£ä»·è¾ƒé«˜ è®­ç»ƒé›†è¾ƒå°æ—¶ä¹ŸåŒæ ·é€‚ç”¨</td></tr><tr><td></td><td>å¿…é¡»è¦æœ‰ ğ‘š &gt; ğ‘›ï¼Œä¸ç„¶çš„è¯åæ–¹å·®çŸ©é˜µä¸å¯é€†çš„ï¼Œé€šå¸¸éœ€è¦ ğ‘š &gt; 10ğ‘› å¦å¤–ç‰¹å¾å†—ä½™ ä¹Ÿä¼šå¯¼è‡´åæ–¹å·®çŸ©é˜µä¸å¯é€†</td></tr></tbody></table></div><h2 id="8-ä½¿ç”¨å¤šå…ƒé«˜æ–¯åˆ†å¸ƒè¿›è¡Œå¼‚å¸¸æ£€æµ‹"><a href="#8-ä½¿ç”¨å¤šå…ƒé«˜æ–¯åˆ†å¸ƒè¿›è¡Œå¼‚å¸¸æ£€æµ‹" class="headerlink" title="8.ä½¿ç”¨å¤šå…ƒé«˜æ–¯åˆ†å¸ƒè¿›è¡Œå¼‚å¸¸æ£€æµ‹"></a>8.ä½¿ç”¨å¤šå…ƒé«˜æ–¯åˆ†å¸ƒè¿›è¡Œå¼‚å¸¸æ£€æµ‹</h2><p>å›é¡¾ä¸€ä¸‹å¤šå…ƒé«˜æ–¯åˆ†å¸ƒå’Œå¤šå…ƒæ­£æ€åˆ†å¸ƒ:</p><script type="math/tex; mode=display">p(x ; \mu, \Sigma)=\frac{1}{(2 \pi)^{\frac{n}{2}}|\Sigma|^{\frac{1}{2}}} \exp \left(-\frac{1}{2}(x-\mu)^{T} \Sigma^{-1}(x-\mu)\right)</script><p>åˆ†å¸ƒæœ‰ä¸¤ä¸ªå‚æ•°, $\mu$ å’Œ $\Sigma$ã€‚å…¶ä¸­$\mu$è¿™ä¸€ä¸ª$n$ç»´å‘é‡å’Œ $\Sigma$ çš„åæ–¹å·®çŸ©é˜µï¼Œæ˜¯ä¸€ç§ $n \times n$ çš„çŸ©é˜µã€‚è€Œè¿™é‡Œçš„å…¬å¼$x$çš„æ¦‚ç‡ï¼Œå¦‚æŒ‰ $\mu$ å’Œå‚æ•°åŒ– $\Sigma,$ å’Œä½ çš„å˜é‡ $\mu$ å’Œ $\Sigma,$ ä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ªèŒƒå›´çš„ä¸åŒåˆ†å¸ƒä¸€æ ·ã€‚<br>æˆ‘æœ‰ä¸€ç»„æ ·æœ¬ $x^{(1)}, x^{(2)}, \ldots, x^{(m)}$ æ˜¯ä¸€ä¸ª $n$ ç»´å‘é‡ï¼Œæˆ‘æƒ³æˆ‘çš„æ ·æœ¬æ¥è‡ªä¸€ä¸ªå¤šå…ƒé«˜æ–¯åˆ†å¸ƒã€‚æˆ‘å¦‚ä½•å°è¯•ä¼°è®¡æˆ‘çš„å‚æ•° $\mu$ å’Œ $\Sigma$ ä»¥åŠæ ‡å‡†å…¬å¼?</p><p>ä¼°è®¡ä»–ä»¬æ˜¯ä½ è®¾ç½® $\mu$ æ˜¯ä½ çš„è®­ç»ƒæ ·æœ¬çš„å¹³å‡å€¼ã€‚</p><script type="math/tex; mode=display">\mu=\frac{1}{m} \sum_{i=1}^{m} x^{(i)}</script><p>å¹¶è®¾ç½® $\Sigma$ :</p><script type="math/tex; mode=display">\Sigma=\frac{1}{m} \sum_{i=1}^{m}\left(x^{(i)}-\mu\right)\left(x^{(i)}-\mu\right)^{T}</script><p>è¿™å…¶å®åªæ˜¯å½“æˆ‘ä»¬ä½¿ç”¨ PCA ç®—æ³•æ—¶å€™, æœ‰ $\Sigma$ æ—¶å†™å‡ºæ¥ã€‚æ‰€ä»¥ä½ åªéœ€æ’å…¥ä¸Šè¿°ä¸¤ä¸ªå…¬å¼,è¿™ä¼šç»™ä½ ä½ ä¼°è®¡çš„å‚æ•° $\mu$ å’Œä½ ä¼°è®¡çš„å‚æ•° $\Sigma$ ã€‚æ‰€ä»¥, è¿™é‡Œç»™å‡ºçš„æ•°æ®é›†æ˜¯ä½ å¦‚ä½•ä¼°è®¡ $\mu$ å’Œ $\Sigma$ ã€‚è®©æˆ‘ä»¬ä»¥è¿™ç§æ–¹æ³•è€Œåªéœ€å°†å…¶æ’å…¥åˆ°å¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•æŠŠæ‰€æœ‰è¿™ä¸€åˆ‡å…±åŒå¼€å‘ä¸€ä¸ªå¼‚å¸¸æ£€æµ‹ç®—æ³•?</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201210133723.png" alt="å¼‚å¸¸æ£€æµ‹ç®—æ³•"></p>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> å¼‚å¸¸æ£€æµ‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>08_é™ç»´_Dimensionality_Reduction_</title>
      <link href="2020/12/09/machinelearning/wu-en-da-ji-qi-xue-xi/08-dimensionality-reduction/"/>
      <url>2020/12/09/machinelearning/wu-en-da-ji-qi-xue-xi/08-dimensionality-reduction/</url>
      
        <content type="html"><![CDATA[<h1 id="é™ç»´ï¼ˆDimensionalityReductionï¼‰"><a href="#é™ç»´ï¼ˆDimensionalityReductionï¼‰" class="headerlink" title="é™ç»´ï¼ˆDimensionalityReductionï¼‰"></a>é™ç»´ï¼ˆDimensionalityReductionï¼‰</h1><h2 id="1-åŠ¨æœºä¸€-æ•°æ®å‹ç¼©"><a href="#1-åŠ¨æœºä¸€-æ•°æ®å‹ç¼©" class="headerlink" title="1.åŠ¨æœºä¸€:æ•°æ®å‹ç¼©"></a>1.åŠ¨æœºä¸€:æ•°æ®å‹ç¼©</h2><p>ç¬¬äºŒç§ç±»å‹çš„æ— ç›‘ç£å­¦ä¹ é—®é¢˜ï¼Œç§°ä¸ºé™ç»´ã€‚æœ‰å‡ ä¸ªä¸åŒçš„çš„åŸ å› ä½¿ä½ å¯èƒ½æƒ³è¦åšé™ç»´ã€‚ä¸€æ˜¯æ•°æ®å‹ç¼©ï¼Œåé¢æˆ‘ä»¬ä¼šçœ‹äº†ä¸€äº›è§†é¢‘åï¼Œæ•°æ®å‹ç¼©ä¸ä»…å…è®¸æˆ‘ ä»¬å‹ç¼©æ•°æ®ï¼Œå› è€Œä½¿ç”¨è¾ƒå°‘çš„è®¡ç®—æœºå†…å­˜æˆ–ç£ç›˜ç©ºé—´ï¼Œä½†å®ƒä¹Ÿè®©æˆ‘ä»¬åŠ å¿«æˆ‘ä»¬çš„å­¦ä¹ ç®—æ³•ã€‚</p><p>ä½†é¦–å…ˆï¼Œè®©æˆ‘ä»¬è°ˆè®ºé™ç»´æ˜¯ä»€ä¹ˆã€‚ä½œä¸ºä¸€ç§ç”ŸåŠ¨çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ”¶é›†çš„æ•°æ®é›†ï¼Œæœ‰è®¸å¤šç‰¹å¾ï¼Œæˆ‘ç»˜åˆ¶ä¸¤ä¸ªåœ¨è¿™é‡Œã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209151927.png" alt="image-20201209151927763"></p><p>å‡è®¾æˆ‘ä»¬æœªçŸ¥ä¸¤ä¸ªçš„ç‰¹å¾:$ğ‘¥_1$ :é•¿åº¦:ç”¨å˜ç±³è¡¨ç¤º;$ğ‘¥_2$ :æ˜¯ç”¨è‹±å¯¸è¡¨ç¤ºåŒä¸€ç‰©ä½“çš„é•¿åº¦ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™ç»™äº†æˆ‘ä»¬é«˜åº¦å†—ä½™è¡¨ç¤ºï¼Œä¹Ÿè®¸ä¸æ˜¯ä¸¤ä¸ªåˆ†å¼€çš„ç‰¹å¾$ğ‘¥_1$ å’Œ$ğ‘¥_2$ ï¼Œè¿™ä¸¤ä¸ªåŸºæœ¬çš„é•¿åº¦ åº¦é‡ï¼Œä¹Ÿè®¸æˆ‘ä»¬æƒ³è¦åšçš„æ˜¯å‡å°‘æ•°æ®åˆ°ä¸€ç»´ï¼Œåªæœ‰ä¸€ä¸ªæ•°æµ‹é‡è¿™ä¸ªé•¿åº¦ã€‚è¿™ä¸ªä¾‹å­ä¼¼ä¹æœ‰ç‚¹åšä½œï¼Œè¿™é‡Œå˜ç±³è‹±å¯¸çš„ä¾‹å­å®é™…ä¸Šä¸æ˜¯é‚£ä¹ˆä¸åˆ‡å®é™…çš„ï¼Œä¸¤è€…å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚</p><p>å°†æ•°æ®ä»äºŒç»´é™è‡³ä¸€ç»´: å‡ä½¿æˆ‘ä»¬è¦é‡‡ç”¨ä¸¤ç§ä¸åŒçš„ä»ªå™¨æ¥æµ‹é‡ä¸€äº›ä¸œè¥¿çš„å°ºå¯¸ï¼Œå…¶ä¸­ä¸€ä¸ªä»ªå™¨æµ‹é‡ç»“æœçš„å•ä½æ˜¯è‹±å¯¸ï¼Œå¦ä¸€ä¸ªä»ªå™¨æµ‹é‡çš„ç»“æœæ˜¯å˜ç±³ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æµ‹é‡çš„ç»“æœä½œä¸ºæˆ‘ä»¬æœºå™¨å­¦ä¹ çš„ç‰¹å¾ã€‚ç°åœ¨çš„é—®é¢˜çš„æ˜¯ï¼Œä¸¤ç§ä»ªå™¨å¯¹åŒä¸€ä¸ªä¸œè¥¿æµ‹é‡çš„ç»“æœä¸å®Œå…¨ç›¸ç­‰ (ç”±äºè¯¯å·®ã€ç²¾åº¦ç­‰)ï¼Œè€Œå°†ä¸¤è€…éƒ½ä½œä¸ºç‰¹å¾æœ‰äº›é‡å¤ï¼Œå› è€Œï¼Œæˆ‘ä»¬å¸Œæœ›å°†è¿™ä¸ªäºŒç»´çš„æ•°æ®é™è‡³ä¸€ç»´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209155836.png" alt="image-20201209152203718"></p><p>åšä¸€ä¸ªè°ƒæŸ¥æˆ–åšè¿™äº›ä¸åŒé£è¡Œå‘˜çš„æµ‹è¯•â€”â€”ä½ å¯èƒ½æœ‰ä¸€ä¸ªç‰¹å¾:$ğ‘¥_1$ ï¼Œè¿™ä¹Ÿè®¸æ˜¯ä»–ä»¬çš„æŠ€èƒ½ï¼ˆç›´å‡æœºé£è¡Œå‘˜ï¼‰ï¼Œä¹Ÿè®¸$ğ‘¥_2$ å¯èƒ½æ˜¯é£è¡Œå‘˜çš„çˆ±å¥½ã€‚è¿™æ˜¯è¡¨ç¤ºä»–ä»¬æ˜¯å¦å–œæ¬¢é£è¡Œï¼Œä¹Ÿè®¸è¿™ä¸¤ä¸ªç‰¹å¾å°†é«˜åº¦ç›¸å…³ã€‚ä½ çœŸæ­£å…³å¿ƒçš„å¯èƒ½æ˜¯è¿™æ¡çº¢çº¿çš„æ–¹å‘ï¼Œä¸åŒçš„ç‰¹å¾ï¼Œå†³å®šé£è¡Œå‘˜çš„èƒ½åŠ›ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209152343.png" alt="image-20201209152343815"></p><p>å°†æ•°æ®ä»ä¸‰ç»´é™è‡³äºŒç»´: è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬è¦å°†ä¸€ä¸ªä¸‰ç»´çš„ç‰¹å¾å‘é‡é™è‡³ä¸€ä¸ªäºŒç»´çš„ç‰¹ å¾å‘é‡ã€‚è¿‡ç¨‹æ˜¯ä¸ä¸Šé¢ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å°†ä¸‰ç»´å‘é‡æŠ•å°„åˆ°ä¸€ä¸ªäºŒç»´çš„å¹³é¢ä¸Šï¼Œå¼ºè¿«ä½¿å¾—æ‰€æœ‰çš„ æ•°æ®éƒ½åœ¨åŒä¸€ä¸ªå¹³é¢ä¸Šï¼Œé™è‡³äºŒç»´çš„ç‰¹å¾å‘é‡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209155851.png" alt="image-20201209152436504"></p><h2 id="2-åŠ¨æœºäºŒ-æ•°æ®å¯è§†åŒ–"><a href="#2-åŠ¨æœºäºŒ-æ•°æ®å¯è§†åŒ–" class="headerlink" title="2.åŠ¨æœºäºŒ:æ•°æ®å¯è§†åŒ–"></a>2.åŠ¨æœºäºŒ:æ•°æ®å¯è§†åŒ–</h2><p>åœ¨è®¸å¤šåŠå…¶å­¦ä¹ é—®é¢˜ä¸­ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å°†æ•°æ®å¯è§†åŒ–ï¼Œæˆ‘ä»¬ä¾¿èƒ½å¯»æ‰¾åˆ°ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œé™ç»´å¯ä»¥å¸®åŠ©æˆ‘ä»¬ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209152521.png" alt="image-20201209152521627"></p><p>å‡ä½¿æˆ‘ä»¬æœ‰æœ‰å…³äºè®¸å¤šä¸åŒå›½å®¶çš„æ•°æ®ï¼Œæ¯ä¸€ä¸ªç‰¹å¾å‘é‡éƒ½æœ‰ 50 ä¸ªç‰¹å¾ï¼ˆå¦‚ GDPï¼Œäºº å‡GDPï¼Œå¹³å‡å¯¿å‘½ç­‰ï¼‰ã€‚å¦‚æœè¦å°†è¿™ä¸ª 50 ç»´çš„æ•°æ®å¯è§†åŒ–æ˜¯ä¸å¯èƒ½çš„ã€‚ä½¿ç”¨é™ç»´çš„æ–¹æ³•å°†å…¶é™è‡³ 2 ç»´ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å°†å…¶å¯è§†åŒ–äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209153239.png" alt="image-20201209153239202"></p><p>è¿™æ ·åšçš„é—®é¢˜åœ¨äºï¼Œé™ç»´çš„ç®—æ³•åªè´Ÿè´£å‡å°‘ç»´æ•°ï¼Œæ–°äº§ç”Ÿçš„ç‰¹å¾çš„æ„ä¹‰å°±å¿…é¡»ç”±æˆ‘ä»¬è‡ªå·±å»å‘ç°äº†ã€‚</p><h2 id="3-ä¸»æˆåˆ†åˆ†æé—®é¢˜"><a href="#3-ä¸»æˆåˆ†åˆ†æé—®é¢˜" class="headerlink" title="3.ä¸»æˆåˆ†åˆ†æé—®é¢˜"></a>3.ä¸»æˆåˆ†åˆ†æé—®é¢˜</h2><p>ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰æ˜¯æœ€å¸¸è§çš„é™ç»´ç®—æ³•ã€‚</p><p>åœ¨ PCA ä¸­ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ–¹å‘å‘é‡ï¼ˆVector directionï¼‰ï¼Œå½“æˆ‘ä»¬æŠŠæ‰€æœ‰çš„æ•°æ®éƒ½æŠ•å°„åˆ°è¯¥å‘é‡ä¸Šæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æŠ•å°„å¹³å‡å‡æ–¹è¯¯å·®èƒ½å°½å¯èƒ½åœ°å°ã€‚æ–¹å‘å‘é‡æ˜¯ä¸€ä¸ªç»è¿‡åŸç‚¹çš„å‘é‡ï¼Œè€ŒæŠ•å°„è¯¯å·®æ˜¯ä»ç‰¹å¾å‘é‡å‘è¯¥æ–¹å‘å‘é‡ä½œå‚çº¿çš„é•¿åº¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209153450.png" alt="image-20201209153449985"></p><p>é—®é¢˜æ˜¯è¦å°†nç»´æ•°æ®é™è‡³ $k$ ç»´ï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°å‘é‡ $u^{(1)}, u^{(2)}, \ldots, u^{(k)}$ ä½¿å¾—æ€»çš„æŠ•å°„è¯¯å·®æœ€å°ã€‚ä¸»æˆåˆ†åˆ†æä¸çº¿æ€§å›é¡¾çš„æ¯”è¾ƒ:</p><p>ä¸»æˆåˆ†åˆ†æä¸çº¿æ€§å›å½’æ˜¯ä¸¤ç§ä¸åŒçš„ç®—æ³•ã€‚ä¸»æˆåˆ†åˆ†ææœ€å°åŒ–çš„æ˜¯æŠ•å°„è¯¯å·®ï¼ˆProjected Errorï¼‰ï¼Œè€Œçº¿æ€§å›å½’å°è¯•çš„æ˜¯æœ€å°åŒ–é¢„æµ‹è¯¯å·®ã€‚çº¿æ€§å›å½’çš„ç›®çš„æ˜¯é¢„æµ‹ç»“æœï¼Œè€Œä¸»æˆåˆ†åˆ†æä¸ä½œä»»ä½•é¢„æµ‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209153610.png" alt="image-20201209153610882"></p><p>ä¸Šå›¾ä¸­ï¼Œå·¦è¾¹çš„æ˜¯çº¿æ€§å›å½’çš„è¯¯å·®ï¼ˆå‚ç›´äºæ¨ªè½´æŠ•å½±ï¼‰ï¼Œå³è¾¹åˆ™æ˜¯ä¸»è¦æˆåˆ†åˆ†æçš„è¯¯å·® ï¼ˆå‚ç›´äºçº¢çº¿æŠ•å½±ï¼‰ã€‚</p><p>PCA å°†ğ‘›ä¸ªç‰¹å¾é™ç»´åˆ°ğ‘˜ä¸ªï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œæ•°æ®å‹ç¼©ï¼Œå¦‚æœ 100 ç»´çš„å‘é‡æœ€åå¯ä»¥ç”¨ 10 ç»´æ¥è¡¨ç¤ºï¼Œé‚£ä¹ˆå‹ç¼©ç‡ä¸º 90%ã€‚åŒæ ·å›¾åƒå¤„ç†é¢†åŸŸçš„ KL å˜æ¢ä½¿ç”¨ PCA åšå›¾åƒå‹ç¼©ã€‚ä½† PCA è¦ä¿è¯é™ç»´åï¼Œè¿˜è¦ä¿è¯æ•°æ®çš„ç‰¹æ€§æŸå¤±æœ€å°ã€‚</p><p>PCA æŠ€æœ¯çš„ä¸€å¤§å¥½å¤„æ˜¯å¯¹æ•°æ®è¿›è¡Œé™ç»´çš„å¤„ç†ã€‚æˆ‘ä»¬å¯ä»¥å¯¹æ–°æ±‚å‡ºçš„â€œä¸»å…ƒâ€å‘é‡çš„é‡è¦ æ€§è¿›è¡Œæ’åºï¼Œæ ¹æ®éœ€è¦å–å‰é¢æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå°†åé¢çš„ç»´æ•°çœå»ï¼Œå¯ä»¥è¾¾åˆ°é™ç»´ä»è€Œç®€åŒ–æ¨¡å‹æˆ–æ˜¯å¯¹æ•°æ®è¿›è¡Œå‹ç¼©çš„æ•ˆæœã€‚åŒæ—¶æœ€å¤§ç¨‹åº¦çš„ä¿æŒäº†åŸæœ‰æ•°æ®çš„ä¿¡æ¯ã€‚</p><p>PCA æŠ€æœ¯çš„ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹æ˜¯ï¼Œå®ƒæ˜¯å®Œå…¨æ— å‚æ•°é™åˆ¶çš„ã€‚åœ¨ PCA çš„è®¡ç®—è¿‡ç¨‹ä¸­å®Œå…¨ä¸ éœ€è¦äººä¸ºçš„è®¾å®šå‚æ•°æˆ–æ˜¯æ ¹æ®ä»»ä½•ç»éªŒæ¨¡å‹å¯¹è®¡ç®—è¿›è¡Œå¹²é¢„ï¼Œæœ€åçš„ç»“æœåªä¸æ•°æ®ç›¸å…³ï¼Œä¸ç”¨æˆ·æ˜¯ç‹¬ç«‹çš„ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ä¸€ç‚¹åŒæ—¶ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ç¼ºç‚¹ã€‚å¦‚æœç”¨æˆ·å¯¹è§‚æµ‹å¯¹è±¡æœ‰ä¸€å®šçš„å…ˆéªŒçŸ¥è¯†ï¼ŒæŒæ¡ æ•°æ®çš„ä¸€äº›ç‰¹å¾ï¼Œå´æ— æ³•é€šè¿‡å‚æ•°åŒ–ç­‰æ–¹æ³•å¯¹å¤„ç†è¿‡ç¨‹è¿›è¡Œå¹²é¢„ï¼Œå¯èƒ½ä¼šå¾—ä¸åˆ°é¢„æœŸçš„æ•ˆæœï¼Œ æ•ˆç‡ä¹Ÿä¸é«˜ã€‚</p><h2 id="4-ä¸»æˆåˆ†åˆ†æç®—æ³•"><a href="#4-ä¸»æˆåˆ†åˆ†æç®—æ³•" class="headerlink" title="4.ä¸»æˆåˆ†åˆ†æç®—æ³•"></a>4.ä¸»æˆåˆ†åˆ†æç®—æ³•</h2><p>PCA å‡å°‘ $n$ ç»´åˆ° $k$ ç»´ :</p><ul><li><p>ç¬¬ä¸€æ­¥æ˜¯å‡å€¼å½’ä¸€åŒ–ã€‚æˆ‘ä»¬éœ€è¦è®¡ç®—å‡ºæ‰€æœ‰ç‰¹å¾çš„å‡å€¼ï¼Œç„¶åä»¤ $x_{j}=x_{j}-\mu_{j}$ã€‚ å¦‚æœç‰¹å¾æ˜¯åœ¨ä¸åŒçš„æ•°é‡çº§ä¸Šï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†å…¶é™¤ä»¥æ ‡å‡†å·® $\sigma^{2}$ ã€‚</p></li><li><p>ç¬¬äºŒæ­¥æ˜¯è®¡ç®—åæ–¹å·®çŸ©é˜µï¼ˆcovariance matrix ï¼‰</p><script type="math/tex; mode=display">\Sigma=\frac{1}{m} \sum_{i=1}^{n}\left(x^{(i)}\right)\left(x^{(i)}\right)^{T}</script><p>è¡¥å……çŸ¥è¯†ï¼š</p><p>åæ–¹å·®ä¸ºï¼š</p><script type="math/tex; mode=display">\sigma\left(x_{m}, x_{k}\right)=\frac{1}{n-1} \sum_{i=1}^{n}\left(x_{m i}-\bar{x}_{m}\right)\left(x_{k i}-\bar{x}_{k}\right)</script><p>å› æ­¤ï¼Œåæ–¹å·®çŸ©é˜µä¸ºï¼š</p><script type="math/tex; mode=display">\Sigma=\left[\begin{array}{ccc}\sigma\left(x_{1}, x_{1}\right) & \cdots & \sigma\left(x_{1}, x_{d}\right) \\ \vdots & \ddots & \vdots \\ \sigma\left(x_{d}, x_{1}\right) & \cdots & \sigma\left(x_{d}, x_{d}\right)\end{array}\right] \in \mathbb{R}^{d \times d}</script></li><li><p>ç¬¬ä¸‰æ­¥æ˜¯è®¡ç®—åæ–¹å·®çŸ©é˜µ $\Sigma$ çš„ç‰¹å¾å‘é‡ï¼ˆeigenvectorsï¼‰:</p></li><li><p>åˆ©ç”¨å¥‡å¼‚å€¼åˆ†è§£ï¼ˆsingularvaluedecompositionï¼‰æ¥æ±‚è§£$[U,S, V]= svd(sigma)$:</p></li></ul><p>å¯¹äºä¸€ä¸ª $n \times n$ ç»´åº¦çš„çŸ©é˜µï¼Œä¸Šå¼ä¸­çš„ $U$ æ˜¯ä¸€ä¸ªå…·æœ‰ä¸æ•°æ®ä¹‹é—´æœ€å°æŠ•å°„è¯¯å·®çš„æ–¹å‘å‘é‡æ„æˆçš„çŸ©é˜µã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›å°†æ•°æ®ä»nç»´é™è‡³kç»´ï¼Œæˆ‘ä»¬åªéœ€è¦ä»Uä¸­é€‰å–å‰kä¸ªå‘é‡ï¼Œè·å¾—ä¸€ä¸ª $n \times k$ ç»´åº¦çš„çŸ©é˜µ, æˆ‘ä»¬ç”¨ $U_{r e d u c e}$ è¡¨ç¤ºï¼Œç„¶åé€šè¿‡å¦‚ä¸‹è®¡ç®—è·å¾—è¦æ±‚çš„æ–°ç‰¹å¾å‘é‡ $z^{(i)}:z^{(i)}=U_{r e d u c e}^{T} * x^{(i)}$</p><p>å…¶ä¸­$ğ‘¥$æ˜¯$ğ‘› Ã— 1$ç»´çš„ï¼Œå› æ­¤ç»“æœä¸º$ğ‘˜ Ã— 1$ç»´åº¦ã€‚æ³¨ï¼Œæˆ‘ä»¬ä¸å¯¹æ–¹å·®ç‰¹å¾è¿›è¡Œå¤„ç†ã€‚</p><p>PCA ç®—æ³•ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªè¿™æ ·çš„æ ·æœ¬ã€‚å¦‚å›¾ä¸­æ ·æœ¬ $x^{(1)}, x^{(2)}$ ã€‚æˆ‘ä»¬åšçš„æ˜¯ï¼Œæˆ‘ä»¬æŠŠè¿™äº›æ ·æœ¬æŠ•å°„åˆ°å›¾ä¸­è¿™ä¸ªä¸€ç»´å¹³é¢ã€‚ç„¶åç°åœ¨æˆ‘ä»¬éœ€è¦åªä½¿ç”¨ä¸€ä¸ªå®æ•°ï¼Œæ¯”å¦‚z $^{(1)}$ ï¼ŒæŒ‡å®šè¿™äº›ç‚¹çš„ä½ç½®åä»–ä»¬è¢«æŠ•å°„åˆ°è¿™ä¸€ä¸ªä¸‰ç»´æ›²é¢ã€‚ç»™å®šä¸€ä¸ªç‚¹ $z^{(1)},$ æˆ‘ä»¬æ€ä¹ˆèƒ½å›å»è¿™ä¸ªåŸå§‹çš„äºŒç»´ç©ºé—´å‘¢ï¼Ÿxä¸º 2 ç»´ï¼Œz ä¸º 1 ç»´ï¼Œ $z=U_{r e d u c e}^{T} x,$ ç›¸åçš„æ–¹ç¨‹ä¸º:</p><script type="math/tex; mode=display">x_{\text {appox}}=U_{\text {reduce}} \cdot z, x_{\text {appox}} \approx x_{\circ}</script><h2 id="5-é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡"><a href="#5-é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡" class="headerlink" title="5.é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡"></a>5.é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡</h2><p>ä¸»è¦æˆåˆ†åˆ†ææ˜¯å‡å°‘æŠ•å°„çš„å¹³å‡å‡æ–¹è¯¯å·®:</p><p>è®­ç»ƒé›†çš„æ–¹å·®ä¸º: $\frac{1}{m} \sum_{i=1}^{m}\left|x^{(i)}\right|^{2}$</p><p>æˆ‘ä»¬å¸Œæœ›åœ¨å¹³å‡å‡æ–¹è¯¯å·®ä¸è®­ç»ƒé›†æ–¹å·®çš„æ¯”ä¾‹å°½å¯èƒ½å°çš„æƒ…å†µä¸‹é€‰æ‹©å°½å¯èƒ½å°çš„kå€¼ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ¯”ä¾‹å°äº$1\%$ï¼Œå°±æ„å‘³ç€åŸæœ¬æ•°æ®çš„åå·®æœ‰ $99\%$éƒ½ä¿ç•™ä¸‹æ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©ä¿ç•™$ 95\%$çš„åå·®ï¼Œä¾¿èƒ½éå¸¸æ˜¾è‘—åœ°é™ä½æ¨¡å‹ä¸­ç‰¹å¾çš„ç»´åº¦äº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å…ˆä»¤ $k=1$, ç„¶åè¿›è¡Œä¸»è¦æˆåˆ†åˆ†æï¼Œè·å¾— $U_{r e d u c e}$ å’Œ $z$, ç„¶åè®¡ç®—æ¯”ä¾‹æ˜¯å¦å°äº$1\%$ã€‚å¦‚æœä¸æ˜¯çš„è¯å†ä»¤$k = 2$ï¼Œå¦‚æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰¾åˆ°å¯ä»¥ä½¿å¾—æ¯”ä¾‹å°äº $1\%$çš„æœ€å° $k$ å€¼ ï¼ˆåŸå› æ˜¯å„ä¸ªç‰¹å¾ä¹‹é—´é€šå¸¸æƒ…å†µå­˜åœ¨æŸç§ç›¸å…³æ€§ï¼‰ã€‚</p><p>å¯¹äºä¹‹å‰çš„SVDå‡½æ•°ï¼Œå…¶ä¸­è¿”å›çš„$ğ‘†$æ˜¯ä¸€ä¸ª$ğ‘› Ã— ğ‘›$çš„çŸ©é˜µï¼Œåªæœ‰å¯¹è§’çº¿ä¸Šæœ‰å€¼ï¼Œè€Œå…¶å®ƒå•å…ƒéƒ½æ˜¯ 0ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªçŸ©é˜µæ¥è®¡ç®—å¹³å‡å‡æ–¹è¯¯å·®ä¸è®­ç»ƒé›†æ–¹å·®çš„æ¯”ä¾‹:</p><script type="math/tex; mode=display">\frac{\frac{1}{m} \sum_{i=1}^{m}\left\|x^{(i)}-x_{a p p r o x}^{(i)}\right\|^{2}}{\frac{1}{m} \sum_{i=1}^{m}\left\|x^{(i)}\right\|^{2}}=1-\frac{\sum_{i=1}^{k} s_{i i}}{\sum_{i=1}^{n} s_{i i}} \leq 1 \%</script><p>ä¹Ÿå°±æ˜¯:</p><script type="math/tex; mode=display">\frac{\sum_{i=1}^{k} s_{i i}}{\sum_{i=1}^{n} s_{i i}} \geq 0.99</script><p>åœ¨å‹ç¼©è¿‡æ•°æ®åï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦‚ä¸‹æ–¹æ³•æ¥è¿‘ä¼¼åœ°è·å¾—åŸæœ‰çš„ç‰¹å¾:</p><script type="math/tex; mode=display">x_{a p p r o x}^{(i)}=U_{r e d u c e} z^{(i)}</script><h2 id="6-ä¸»æˆåˆ†åˆ†ææ³•çš„åº”ç”¨å»ºè®®"><a href="#6-ä¸»æˆåˆ†åˆ†ææ³•çš„åº”ç”¨å»ºè®®" class="headerlink" title="6.ä¸»æˆåˆ†åˆ†ææ³•çš„åº”ç”¨å»ºè®®"></a>6.ä¸»æˆåˆ†åˆ†ææ³•çš„åº”ç”¨å»ºè®®</h2><p>å‡ä½¿æˆ‘ä»¬æ­£åœ¨é’ˆå¯¹ä¸€å¼  100Ã—100 åƒç´ çš„å›¾ç‰‡è¿›è¡ŒæŸä¸ªè®¡ç®—æœºè§†è§‰çš„æœºå™¨å­¦ä¹ ï¼Œå³æ€»å…± æœ‰ 10000 ä¸ªç‰¹å¾ã€‚</p><ol><li>ç¬¬ä¸€æ­¥æ˜¯è¿ç”¨ä¸»è¦æˆåˆ†åˆ†æå°†æ•°æ®å‹ç¼©è‡³ 1000 ä¸ªç‰¹å¾</li><li>ç„¶åå¯¹è®­ç»ƒé›†è¿è¡Œå­¦ä¹ ç®—æ³•ã€‚</li><li>åœ¨é¢„æµ‹æ—¶ï¼Œé‡‡ç”¨ä¹‹å‰å­¦ä¹ è€Œæ¥çš„$ğ‘ˆ_{ğ‘Ÿğ‘’ğ‘‘ğ‘¢ğ‘ğ‘’}$å°†è¾“å…¥çš„ç‰¹å¾ğ‘¥è½¬æ¢æˆç‰¹å¾å‘é‡ğ‘§ï¼Œç„¶åå†è¿›è¡Œé¢„æµ‹</li></ol><p>æ³¨:å¦‚æœæˆ‘ä»¬æœ‰äº¤å‰éªŒè¯é›†åˆæµ‹è¯•é›†ï¼Œä¹Ÿé‡‡ç”¨å¯¹è®­ç»ƒé›†å­¦ä¹ è€Œæ¥çš„$ğ‘ˆ_{ğ‘Ÿğ‘’ğ‘‘ğ‘¢ğ‘ğ‘’}$ ã€‚ é”™è¯¯çš„ä¸»è¦æˆåˆ†åˆ†ææƒ…å†µ:ä¸€ä¸ªå¸¸è§é”™è¯¯ä½¿ç”¨ä¸»è¦æˆåˆ†åˆ†æçš„æƒ…å†µæ˜¯ï¼Œå°†å…¶ç”¨äºå‡å°‘è¿‡</p><p>æ‹Ÿåˆï¼ˆå‡å°‘äº†ç‰¹å¾çš„æ•°é‡ï¼‰ã€‚è¿™æ ·åšéå¸¸ä¸å¥½ï¼Œä¸å¦‚å°è¯•æ­£åˆ™åŒ–å¤„ç†ã€‚åŸå› åœ¨äºä¸»è¦æˆåˆ†åˆ†æåªæ˜¯è¿‘ä¼¼åœ°ä¸¢å¼ƒæ‰ä¸€äº›ç‰¹å¾ï¼Œå®ƒå¹¶ä¸è€ƒè™‘ä»»ä½•ä¸ç»“æœå˜é‡æœ‰å…³çš„ä¿¡æ¯ï¼Œå› æ­¤å¯èƒ½ä¼šä¸¢å¤±é å¸¸é‡è¦çš„ç‰¹å¾ã€‚ç„¶è€Œå½“æˆ‘ä»¬è¿›è¡Œæ­£åˆ™åŒ–å¤„ç†æ—¶ï¼Œä¼šè€ƒè™‘åˆ°ç»“æœå˜é‡ï¼Œä¸ä¼šä¸¢æ‰é‡è¦çš„æ•°æ®ã€‚</p><p>å¦ä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯ï¼Œé»˜è®¤åœ°å°†ä¸»è¦æˆåˆ†åˆ†æä½œä¸ºå­¦ä¹ è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè¿™è™½ç„¶å¾ˆå¤šæ—¶å€™æœ‰æ•ˆæœï¼Œæœ€å¥½è¿˜æ˜¯ä»æ‰€æœ‰åŸå§‹ç‰¹å¾å¼€å§‹ï¼Œåªåœ¨æœ‰å¿…è¦çš„æ—¶å€™ï¼ˆç®—æ³•è¿è¡Œå¤ªæ…¢æˆ–è€…å ç”¨å¤ªå¤šå†…å­˜ï¼‰æ‰è€ƒè™‘é‡‡ç”¨ä¸»è¦æˆåˆ†åˆ†æã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> é™ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>08_é™ç»´_Dimensionality_Reduction_</title>
      <link href="2020/12/09/machinelearning/wu-en-da-ji-qi-xue-xi/08-dimensionality-reduction-2/"/>
      <url>2020/12/09/machinelearning/wu-en-da-ji-qi-xue-xi/08-dimensionality-reduction-2/</url>
      
        <content type="html"><![CDATA[<h1 id="é™ç»´ï¼ˆDimensionalityReductionï¼‰"><a href="#é™ç»´ï¼ˆDimensionalityReductionï¼‰" class="headerlink" title="é™ç»´ï¼ˆDimensionalityReductionï¼‰"></a>é™ç»´ï¼ˆDimensionalityReductionï¼‰</h1><h2 id="1-åŠ¨æœºä¸€-æ•°æ®å‹ç¼©"><a href="#1-åŠ¨æœºä¸€-æ•°æ®å‹ç¼©" class="headerlink" title="1.åŠ¨æœºä¸€:æ•°æ®å‹ç¼©"></a>1.åŠ¨æœºä¸€:æ•°æ®å‹ç¼©</h2><p>ç¬¬äºŒç§ç±»å‹çš„æ— ç›‘ç£å­¦ä¹ é—®é¢˜ï¼Œç§°ä¸ºé™ç»´ã€‚æœ‰å‡ ä¸ªä¸åŒçš„çš„åŸ å› ä½¿ä½ å¯èƒ½æƒ³è¦åšé™ç»´ã€‚ä¸€æ˜¯æ•°æ®å‹ç¼©ï¼Œåé¢æˆ‘ä»¬ä¼šçœ‹äº†ä¸€äº›è§†é¢‘åï¼Œæ•°æ®å‹ç¼©ä¸ä»…å…è®¸æˆ‘ ä»¬å‹ç¼©æ•°æ®ï¼Œå› è€Œä½¿ç”¨è¾ƒå°‘çš„è®¡ç®—æœºå†…å­˜æˆ–ç£ç›˜ç©ºé—´ï¼Œä½†å®ƒä¹Ÿè®©æˆ‘ä»¬åŠ å¿«æˆ‘ä»¬çš„å­¦ä¹ ç®—æ³•ã€‚</p><p>ä½†é¦–å…ˆï¼Œè®©æˆ‘ä»¬è°ˆè®ºé™ç»´æ˜¯ä»€ä¹ˆã€‚ä½œä¸ºä¸€ç§ç”ŸåŠ¨çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ”¶é›†çš„æ•°æ®é›†ï¼Œæœ‰è®¸å¤šç‰¹å¾ï¼Œæˆ‘ç»˜åˆ¶ä¸¤ä¸ªåœ¨è¿™é‡Œã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209151927.png" alt="image-20201209151927763"></p><p>å‡è®¾æˆ‘ä»¬æœªçŸ¥ä¸¤ä¸ªçš„ç‰¹å¾:$ğ‘¥_1$ :é•¿åº¦:ç”¨å˜ç±³è¡¨ç¤º;$ğ‘¥_2$ :æ˜¯ç”¨è‹±å¯¸è¡¨ç¤ºåŒä¸€ç‰©ä½“çš„é•¿åº¦ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™ç»™äº†æˆ‘ä»¬é«˜åº¦å†—ä½™è¡¨ç¤ºï¼Œä¹Ÿè®¸ä¸æ˜¯ä¸¤ä¸ªåˆ†å¼€çš„ç‰¹å¾$ğ‘¥_1$ å’Œ$ğ‘¥_2$ ï¼Œè¿™ä¸¤ä¸ªåŸºæœ¬çš„é•¿åº¦ åº¦é‡ï¼Œä¹Ÿè®¸æˆ‘ä»¬æƒ³è¦åšçš„æ˜¯å‡å°‘æ•°æ®åˆ°ä¸€ç»´ï¼Œåªæœ‰ä¸€ä¸ªæ•°æµ‹é‡è¿™ä¸ªé•¿åº¦ã€‚è¿™ä¸ªä¾‹å­ä¼¼ä¹æœ‰ç‚¹åšä½œï¼Œè¿™é‡Œå˜ç±³è‹±å¯¸çš„ä¾‹å­å®é™…ä¸Šä¸æ˜¯é‚£ä¹ˆä¸åˆ‡å®é™…çš„ï¼Œä¸¤è€…å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚</p><p>å°†æ•°æ®ä»äºŒç»´é™è‡³ä¸€ç»´: å‡ä½¿æˆ‘ä»¬è¦é‡‡ç”¨ä¸¤ç§ä¸åŒçš„ä»ªå™¨æ¥æµ‹é‡ä¸€äº›ä¸œè¥¿çš„å°ºå¯¸ï¼Œå…¶ä¸­ä¸€ä¸ªä»ªå™¨æµ‹é‡ç»“æœçš„å•ä½æ˜¯è‹±å¯¸ï¼Œå¦ä¸€ä¸ªä»ªå™¨æµ‹é‡çš„ç»“æœæ˜¯å˜ç±³ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æµ‹é‡çš„ç»“æœä½œä¸ºæˆ‘ä»¬æœºå™¨å­¦ä¹ çš„ç‰¹å¾ã€‚ç°åœ¨çš„é—®é¢˜çš„æ˜¯ï¼Œä¸¤ç§ä»ªå™¨å¯¹åŒä¸€ä¸ªä¸œè¥¿æµ‹é‡çš„ç»“æœä¸å®Œå…¨ç›¸ç­‰ (ç”±äºè¯¯å·®ã€ç²¾åº¦ç­‰)ï¼Œè€Œå°†ä¸¤è€…éƒ½ä½œä¸ºç‰¹å¾æœ‰äº›é‡å¤ï¼Œå› è€Œï¼Œæˆ‘ä»¬å¸Œæœ›å°†è¿™ä¸ªäºŒç»´çš„æ•°æ®é™è‡³ä¸€ç»´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209155836.png" alt="image-20201209152203718"></p><p>åšä¸€ä¸ªè°ƒæŸ¥æˆ–åšè¿™äº›ä¸åŒé£è¡Œå‘˜çš„æµ‹è¯•â€”â€”ä½ å¯èƒ½æœ‰ä¸€ä¸ªç‰¹å¾:$ğ‘¥_1$ ï¼Œè¿™ä¹Ÿè®¸æ˜¯ä»–ä»¬çš„æŠ€èƒ½ï¼ˆç›´å‡æœºé£è¡Œå‘˜ï¼‰ï¼Œä¹Ÿè®¸$ğ‘¥_2$ å¯èƒ½æ˜¯é£è¡Œå‘˜çš„çˆ±å¥½ã€‚è¿™æ˜¯è¡¨ç¤ºä»–ä»¬æ˜¯å¦å–œæ¬¢é£è¡Œï¼Œä¹Ÿè®¸è¿™ä¸¤ä¸ªç‰¹å¾å°†é«˜åº¦ç›¸å…³ã€‚ä½ çœŸæ­£å…³å¿ƒçš„å¯èƒ½æ˜¯è¿™æ¡çº¢çº¿çš„æ–¹å‘ï¼Œä¸åŒçš„ç‰¹å¾ï¼Œå†³å®šé£è¡Œå‘˜çš„èƒ½åŠ›ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209152343.png" alt="image-20201209152343815"></p><p>å°†æ•°æ®ä»ä¸‰ç»´é™è‡³äºŒç»´: è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬è¦å°†ä¸€ä¸ªä¸‰ç»´çš„ç‰¹å¾å‘é‡é™è‡³ä¸€ä¸ªäºŒç»´çš„ç‰¹ å¾å‘é‡ã€‚è¿‡ç¨‹æ˜¯ä¸ä¸Šé¢ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å°†ä¸‰ç»´å‘é‡æŠ•å°„åˆ°ä¸€ä¸ªäºŒç»´çš„å¹³é¢ä¸Šï¼Œå¼ºè¿«ä½¿å¾—æ‰€æœ‰çš„ æ•°æ®éƒ½åœ¨åŒä¸€ä¸ªå¹³é¢ä¸Šï¼Œé™è‡³äºŒç»´çš„ç‰¹å¾å‘é‡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209155851.png" alt="image-20201209152436504"></p><h2 id="2-åŠ¨æœºäºŒ-æ•°æ®å¯è§†åŒ–"><a href="#2-åŠ¨æœºäºŒ-æ•°æ®å¯è§†åŒ–" class="headerlink" title="2.åŠ¨æœºäºŒ:æ•°æ®å¯è§†åŒ–"></a>2.åŠ¨æœºäºŒ:æ•°æ®å¯è§†åŒ–</h2><p>åœ¨è®¸å¤šåŠå…¶å­¦ä¹ é—®é¢˜ä¸­ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å°†æ•°æ®å¯è§†åŒ–ï¼Œæˆ‘ä»¬ä¾¿èƒ½å¯»æ‰¾åˆ°ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œé™ç»´å¯ä»¥å¸®åŠ©æˆ‘ä»¬ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209152521.png" alt="image-20201209152521627"></p><p>å‡ä½¿æˆ‘ä»¬æœ‰æœ‰å…³äºè®¸å¤šä¸åŒå›½å®¶çš„æ•°æ®ï¼Œæ¯ä¸€ä¸ªç‰¹å¾å‘é‡éƒ½æœ‰ 50 ä¸ªç‰¹å¾ï¼ˆå¦‚ GDPï¼Œäºº å‡GDPï¼Œå¹³å‡å¯¿å‘½ç­‰ï¼‰ã€‚å¦‚æœè¦å°†è¿™ä¸ª 50 ç»´çš„æ•°æ®å¯è§†åŒ–æ˜¯ä¸å¯èƒ½çš„ã€‚ä½¿ç”¨é™ç»´çš„æ–¹æ³•å°†å…¶é™è‡³ 2 ç»´ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å°†å…¶å¯è§†åŒ–äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209153239.png" alt="image-20201209153239202"></p><p>è¿™æ ·åšçš„é—®é¢˜åœ¨äºï¼Œé™ç»´çš„ç®—æ³•åªè´Ÿè´£å‡å°‘ç»´æ•°ï¼Œæ–°äº§ç”Ÿçš„ç‰¹å¾çš„æ„ä¹‰å°±å¿…é¡»ç”±æˆ‘ä»¬è‡ªå·±å»å‘ç°äº†ã€‚</p><h2 id="3-ä¸»æˆåˆ†åˆ†æé—®é¢˜"><a href="#3-ä¸»æˆåˆ†åˆ†æé—®é¢˜" class="headerlink" title="3.ä¸»æˆåˆ†åˆ†æé—®é¢˜"></a>3.ä¸»æˆåˆ†åˆ†æé—®é¢˜</h2><p>ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰æ˜¯æœ€å¸¸è§çš„é™ç»´ç®—æ³•ã€‚</p><p>åœ¨ PCA ä¸­ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ–¹å‘å‘é‡ï¼ˆVector directionï¼‰ï¼Œå½“æˆ‘ä»¬æŠŠæ‰€æœ‰çš„æ•°æ®éƒ½æŠ•å°„åˆ°è¯¥å‘é‡ä¸Šæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æŠ•å°„å¹³å‡å‡æ–¹è¯¯å·®èƒ½å°½å¯èƒ½åœ°å°ã€‚æ–¹å‘å‘é‡æ˜¯ä¸€ä¸ªç»è¿‡åŸç‚¹çš„å‘é‡ï¼Œè€ŒæŠ•å°„è¯¯å·®æ˜¯ä»ç‰¹å¾å‘é‡å‘è¯¥æ–¹å‘å‘é‡ä½œå‚çº¿çš„é•¿åº¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209153450.png" alt="image-20201209153449985"></p><p>é—®é¢˜æ˜¯è¦å°†nç»´æ•°æ®é™è‡³ $k$ ç»´ï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°å‘é‡ $u^{(1)}, u^{(2)}, \ldots, u^{(k)}$ ä½¿å¾—æ€»çš„æŠ•å°„è¯¯å·®æœ€å°ã€‚ä¸»æˆåˆ†åˆ†æä¸çº¿æ€§å›é¡¾çš„æ¯”è¾ƒ:</p><p>ä¸»æˆåˆ†åˆ†æä¸çº¿æ€§å›å½’æ˜¯ä¸¤ç§ä¸åŒçš„ç®—æ³•ã€‚ä¸»æˆåˆ†åˆ†ææœ€å°åŒ–çš„æ˜¯æŠ•å°„è¯¯å·®ï¼ˆProjected Errorï¼‰ï¼Œè€Œçº¿æ€§å›å½’å°è¯•çš„æ˜¯æœ€å°åŒ–é¢„æµ‹è¯¯å·®ã€‚çº¿æ€§å›å½’çš„ç›®çš„æ˜¯é¢„æµ‹ç»“æœï¼Œè€Œä¸»æˆåˆ†åˆ†æä¸ä½œä»»ä½•é¢„æµ‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209153610.png" alt="image-20201209153610882"></p><p>ä¸Šå›¾ä¸­ï¼Œå·¦è¾¹çš„æ˜¯çº¿æ€§å›å½’çš„è¯¯å·®ï¼ˆå‚ç›´äºæ¨ªè½´æŠ•å½±ï¼‰ï¼Œå³è¾¹åˆ™æ˜¯ä¸»è¦æˆåˆ†åˆ†æçš„è¯¯å·® ï¼ˆå‚ç›´äºçº¢çº¿æŠ•å½±ï¼‰ã€‚</p><p>PCA å°†ğ‘›ä¸ªç‰¹å¾é™ç»´åˆ°ğ‘˜ä¸ªï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œæ•°æ®å‹ç¼©ï¼Œå¦‚æœ 100 ç»´çš„å‘é‡æœ€åå¯ä»¥ç”¨ 10 ç»´æ¥è¡¨ç¤ºï¼Œé‚£ä¹ˆå‹ç¼©ç‡ä¸º 90%ã€‚åŒæ ·å›¾åƒå¤„ç†é¢†åŸŸçš„ KL å˜æ¢ä½¿ç”¨ PCA åšå›¾åƒå‹ç¼©ã€‚ä½† PCA è¦ä¿è¯é™ç»´åï¼Œè¿˜è¦ä¿è¯æ•°æ®çš„ç‰¹æ€§æŸå¤±æœ€å°ã€‚</p><p>PCA æŠ€æœ¯çš„ä¸€å¤§å¥½å¤„æ˜¯å¯¹æ•°æ®è¿›è¡Œé™ç»´çš„å¤„ç†ã€‚æˆ‘ä»¬å¯ä»¥å¯¹æ–°æ±‚å‡ºçš„â€œä¸»å…ƒâ€å‘é‡çš„é‡è¦ æ€§è¿›è¡Œæ’åºï¼Œæ ¹æ®éœ€è¦å–å‰é¢æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå°†åé¢çš„ç»´æ•°çœå»ï¼Œå¯ä»¥è¾¾åˆ°é™ç»´ä»è€Œç®€åŒ–æ¨¡å‹æˆ–æ˜¯å¯¹æ•°æ®è¿›è¡Œå‹ç¼©çš„æ•ˆæœã€‚åŒæ—¶æœ€å¤§ç¨‹åº¦çš„ä¿æŒäº†åŸæœ‰æ•°æ®çš„ä¿¡æ¯ã€‚</p><p>PCA æŠ€æœ¯çš„ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹æ˜¯ï¼Œå®ƒæ˜¯å®Œå…¨æ— å‚æ•°é™åˆ¶çš„ã€‚åœ¨ PCA çš„è®¡ç®—è¿‡ç¨‹ä¸­å®Œå…¨ä¸ éœ€è¦äººä¸ºçš„è®¾å®šå‚æ•°æˆ–æ˜¯æ ¹æ®ä»»ä½•ç»éªŒæ¨¡å‹å¯¹è®¡ç®—è¿›è¡Œå¹²é¢„ï¼Œæœ€åçš„ç»“æœåªä¸æ•°æ®ç›¸å…³ï¼Œä¸ç”¨æˆ·æ˜¯ç‹¬ç«‹çš„ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ä¸€ç‚¹åŒæ—¶ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ç¼ºç‚¹ã€‚å¦‚æœç”¨æˆ·å¯¹è§‚æµ‹å¯¹è±¡æœ‰ä¸€å®šçš„å…ˆéªŒçŸ¥è¯†ï¼ŒæŒæ¡ æ•°æ®çš„ä¸€äº›ç‰¹å¾ï¼Œå´æ— æ³•é€šè¿‡å‚æ•°åŒ–ç­‰æ–¹æ³•å¯¹å¤„ç†è¿‡ç¨‹è¿›è¡Œå¹²é¢„ï¼Œå¯èƒ½ä¼šå¾—ä¸åˆ°é¢„æœŸçš„æ•ˆæœï¼Œ æ•ˆç‡ä¹Ÿä¸é«˜ã€‚</p><h2 id="4-ä¸»æˆåˆ†åˆ†æç®—æ³•"><a href="#4-ä¸»æˆåˆ†åˆ†æç®—æ³•" class="headerlink" title="4.ä¸»æˆåˆ†åˆ†æç®—æ³•"></a>4.ä¸»æˆåˆ†åˆ†æç®—æ³•</h2><p>PCA å‡å°‘ $n$ ç»´åˆ° $k$ ç»´ :</p><ul><li><p>ç¬¬ä¸€æ­¥æ˜¯å‡å€¼å½’ä¸€åŒ–ã€‚æˆ‘ä»¬éœ€è¦è®¡ç®—å‡ºæ‰€æœ‰ç‰¹å¾çš„å‡å€¼ï¼Œç„¶åä»¤ $x_{j}=x_{j}-\mu_{j}$ã€‚ å¦‚æœç‰¹å¾æ˜¯åœ¨ä¸åŒçš„æ•°é‡çº§ä¸Šï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†å…¶é™¤ä»¥æ ‡å‡†å·® $\sigma^{2}$ ã€‚</p></li><li><p>ç¬¬äºŒæ­¥æ˜¯è®¡ç®—åæ–¹å·®çŸ©é˜µï¼ˆcovariance matrix ï¼‰</p><script type="math/tex; mode=display">\Sigma=\frac{1}{m} \sum_{i=1}^{n}\left(x^{(i)}\right)\left(x^{(i)}\right)^{T}</script><p>è¡¥å……çŸ¥è¯†ï¼š</p><p>åæ–¹å·®ä¸ºï¼š</p><script type="math/tex; mode=display">\sigma\left(x_{m}, x_{k}\right)=\frac{1}{n-1} \sum_{i=1}^{n}\left(x_{m i}-\bar{x}_{m}\right)\left(x_{k i}-\bar{x}_{k}\right)</script><p>å› æ­¤ï¼Œåæ–¹å·®çŸ©é˜µä¸ºï¼š</p><script type="math/tex; mode=display">\Sigma=\left[\begin{array}{ccc}\sigma\left(x_{1}, x_{1}\right) & \cdots & \sigma\left(x_{1}, x_{d}\right) \\ \vdots & \ddots & \vdots \\ \sigma\left(x_{d}, x_{1}\right) & \cdots & \sigma\left(x_{d}, x_{d}\right)\end{array}\right] \in \mathbb{R}^{d \times d}</script></li><li><p>ç¬¬ä¸‰æ­¥æ˜¯è®¡ç®—åæ–¹å·®çŸ©é˜µ $\Sigma$ çš„ç‰¹å¾å‘é‡ï¼ˆeigenvectorsï¼‰:</p></li><li><p>åˆ©ç”¨å¥‡å¼‚å€¼åˆ†è§£ï¼ˆsingularvaluedecompositionï¼‰æ¥æ±‚è§£$[U,S, V]= svd(sigma)$:</p></li></ul><p>å¯¹äºä¸€ä¸ª $n \times n$ ç»´åº¦çš„çŸ©é˜µï¼Œä¸Šå¼ä¸­çš„ $U$ æ˜¯ä¸€ä¸ªå…·æœ‰ä¸æ•°æ®ä¹‹é—´æœ€å°æŠ•å°„è¯¯å·®çš„æ–¹å‘å‘é‡æ„æˆçš„çŸ©é˜µã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›å°†æ•°æ®ä»nç»´é™è‡³kç»´ï¼Œæˆ‘ä»¬åªéœ€è¦ä»Uä¸­é€‰å–å‰kä¸ªå‘é‡ï¼Œè·å¾—ä¸€ä¸ª $n \times k$ ç»´åº¦çš„çŸ©é˜µ, æˆ‘ä»¬ç”¨ $U_{r e d u c e}$ è¡¨ç¤ºï¼Œç„¶åé€šè¿‡å¦‚ä¸‹è®¡ç®—è·å¾—è¦æ±‚çš„æ–°ç‰¹å¾å‘é‡ $z^{(i)}:z^{(i)}=U_{r e d u c e}^{T} * x^{(i)}$</p><p>å…¶ä¸­$ğ‘¥$æ˜¯$ğ‘› Ã— 1$ç»´çš„ï¼Œå› æ­¤ç»“æœä¸º$ğ‘˜ Ã— 1$ç»´åº¦ã€‚æ³¨ï¼Œæˆ‘ä»¬ä¸å¯¹æ–¹å·®ç‰¹å¾è¿›è¡Œå¤„ç†ã€‚</p><p>PCA ç®—æ³•ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªè¿™æ ·çš„æ ·æœ¬ã€‚å¦‚å›¾ä¸­æ ·æœ¬ $x^{(1)}, x^{(2)}$ ã€‚æˆ‘ä»¬åšçš„æ˜¯ï¼Œæˆ‘ä»¬æŠŠè¿™äº›æ ·æœ¬æŠ•å°„åˆ°å›¾ä¸­è¿™ä¸ªä¸€ç»´å¹³é¢ã€‚ç„¶åç°åœ¨æˆ‘ä»¬éœ€è¦åªä½¿ç”¨ä¸€ä¸ªå®æ•°ï¼Œæ¯”å¦‚z $^{(1)}$ ï¼ŒæŒ‡å®šè¿™äº›ç‚¹çš„ä½ç½®åä»–ä»¬è¢«æŠ•å°„åˆ°è¿™ä¸€ä¸ªä¸‰ç»´æ›²é¢ã€‚ç»™å®šä¸€ä¸ªç‚¹ $z^{(1)},$ æˆ‘ä»¬æ€ä¹ˆèƒ½å›å»è¿™ä¸ªåŸå§‹çš„äºŒç»´ç©ºé—´å‘¢ï¼Ÿxä¸º 2 ç»´ï¼Œz ä¸º 1 ç»´ï¼Œ $z=U_{r e d u c e}^{T} x,$ ç›¸åçš„æ–¹ç¨‹ä¸º:</p><script type="math/tex; mode=display">x_{\text {appox}}=U_{\text {reduce}} \cdot z, x_{\text {appox}} \approx x_{\circ}</script><h2 id="5-é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡"><a href="#5-é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡" class="headerlink" title="5.é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡"></a>5.é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡</h2><p>ä¸»è¦æˆåˆ†åˆ†ææ˜¯å‡å°‘æŠ•å°„çš„å¹³å‡å‡æ–¹è¯¯å·®:</p><p>è®­ç»ƒé›†çš„æ–¹å·®ä¸º: $\frac{1}{m} \sum_{i=1}^{m}\left|x^{(i)}\right|^{2}$</p><p>æˆ‘ä»¬å¸Œæœ›åœ¨å¹³å‡å‡æ–¹è¯¯å·®ä¸è®­ç»ƒé›†æ–¹å·®çš„æ¯”ä¾‹å°½å¯èƒ½å°çš„æƒ…å†µä¸‹é€‰æ‹©å°½å¯èƒ½å°çš„kå€¼ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ¯”ä¾‹å°äº$1\%$ï¼Œå°±æ„å‘³ç€åŸæœ¬æ•°æ®çš„åå·®æœ‰ $99\%$éƒ½ä¿ç•™ä¸‹æ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©ä¿ç•™$ 95\%$çš„åå·®ï¼Œä¾¿èƒ½éå¸¸æ˜¾è‘—åœ°é™ä½æ¨¡å‹ä¸­ç‰¹å¾çš„ç»´åº¦äº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å…ˆä»¤ $k=1$, ç„¶åè¿›è¡Œä¸»è¦æˆåˆ†åˆ†æï¼Œè·å¾— $U_{r e d u c e}$ å’Œ $z$, ç„¶åè®¡ç®—æ¯”ä¾‹æ˜¯å¦å°äº$1\%$ã€‚å¦‚æœä¸æ˜¯çš„è¯å†ä»¤$k = 2$ï¼Œå¦‚æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰¾åˆ°å¯ä»¥ä½¿å¾—æ¯”ä¾‹å°äº $1\%$çš„æœ€å° $k$ å€¼ ï¼ˆåŸå› æ˜¯å„ä¸ªç‰¹å¾ä¹‹é—´é€šå¸¸æƒ…å†µå­˜åœ¨æŸç§ç›¸å…³æ€§ï¼‰ã€‚</p><p>å¯¹äºä¹‹å‰çš„SVDå‡½æ•°ï¼Œå…¶ä¸­è¿”å›çš„$ğ‘†$æ˜¯ä¸€ä¸ª$ğ‘› Ã— ğ‘›$çš„çŸ©é˜µï¼Œåªæœ‰å¯¹è§’çº¿ä¸Šæœ‰å€¼ï¼Œè€Œå…¶å®ƒå•å…ƒéƒ½æ˜¯ 0ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªçŸ©é˜µæ¥è®¡ç®—å¹³å‡å‡æ–¹è¯¯å·®ä¸è®­ç»ƒé›†æ–¹å·®çš„æ¯”ä¾‹:</p><script type="math/tex; mode=display">\frac{\frac{1}{m} \sum_{i=1}^{m}\left\|x^{(i)}-x_{a p p r o x}^{(i)}\right\|^{2}}{\frac{1}{m} \sum_{i=1}^{m}\left\|x^{(i)}\right\|^{2}}=1-\frac{\sum_{i=1}^{k} s_{i i}}{\sum_{i=1}^{n} s_{i i}} \leq 1 \%</script><p>ä¹Ÿå°±æ˜¯:</p><script type="math/tex; mode=display">\frac{\sum_{i=1}^{k} s_{i i}}{\sum_{i=1}^{n} s_{i i}} \geq 0.99</script><p>åœ¨å‹ç¼©è¿‡æ•°æ®åï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦‚ä¸‹æ–¹æ³•æ¥è¿‘ä¼¼åœ°è·å¾—åŸæœ‰çš„ç‰¹å¾:</p><script type="math/tex; mode=display">x_{a p p r o x}^{(i)}=U_{r e d u c e} z^{(i)}</script><h2 id="6-ä¸»æˆåˆ†åˆ†ææ³•çš„åº”ç”¨å»ºè®®"><a href="#6-ä¸»æˆåˆ†åˆ†ææ³•çš„åº”ç”¨å»ºè®®" class="headerlink" title="6.ä¸»æˆåˆ†åˆ†ææ³•çš„åº”ç”¨å»ºè®®"></a>6.ä¸»æˆåˆ†åˆ†ææ³•çš„åº”ç”¨å»ºè®®</h2><p>å‡ä½¿æˆ‘ä»¬æ­£åœ¨é’ˆå¯¹ä¸€å¼  100Ã—100 åƒç´ çš„å›¾ç‰‡è¿›è¡ŒæŸä¸ªè®¡ç®—æœºè§†è§‰çš„æœºå™¨å­¦ä¹ ï¼Œå³æ€»å…± æœ‰ 10000 ä¸ªç‰¹å¾ã€‚</p><ol><li>ç¬¬ä¸€æ­¥æ˜¯è¿ç”¨ä¸»è¦æˆåˆ†åˆ†æå°†æ•°æ®å‹ç¼©è‡³ 1000 ä¸ªç‰¹å¾</li><li>ç„¶åå¯¹è®­ç»ƒé›†è¿è¡Œå­¦ä¹ ç®—æ³•ã€‚</li><li>åœ¨é¢„æµ‹æ—¶ï¼Œé‡‡ç”¨ä¹‹å‰å­¦ä¹ è€Œæ¥çš„$ğ‘ˆ_{ğ‘Ÿğ‘’ğ‘‘ğ‘¢ğ‘ğ‘’}$å°†è¾“å…¥çš„ç‰¹å¾ğ‘¥è½¬æ¢æˆç‰¹å¾å‘é‡ğ‘§ï¼Œç„¶åå†è¿›è¡Œé¢„æµ‹</li></ol><p>æ³¨:å¦‚æœæˆ‘ä»¬æœ‰äº¤å‰éªŒè¯é›†åˆæµ‹è¯•é›†ï¼Œä¹Ÿé‡‡ç”¨å¯¹è®­ç»ƒé›†å­¦ä¹ è€Œæ¥çš„$ğ‘ˆ_{ğ‘Ÿğ‘’ğ‘‘ğ‘¢ğ‘ğ‘’}$ ã€‚ é”™è¯¯çš„ä¸»è¦æˆåˆ†åˆ†ææƒ…å†µ:ä¸€ä¸ªå¸¸è§é”™è¯¯ä½¿ç”¨ä¸»è¦æˆåˆ†åˆ†æçš„æƒ…å†µæ˜¯ï¼Œå°†å…¶ç”¨äºå‡å°‘è¿‡</p><p>æ‹Ÿåˆï¼ˆå‡å°‘äº†ç‰¹å¾çš„æ•°é‡ï¼‰ã€‚è¿™æ ·åšéå¸¸ä¸å¥½ï¼Œä¸å¦‚å°è¯•æ­£åˆ™åŒ–å¤„ç†ã€‚åŸå› åœ¨äºä¸»è¦æˆåˆ†åˆ†æåªæ˜¯è¿‘ä¼¼åœ°ä¸¢å¼ƒæ‰ä¸€äº›ç‰¹å¾ï¼Œå®ƒå¹¶ä¸è€ƒè™‘ä»»ä½•ä¸ç»“æœå˜é‡æœ‰å…³çš„ä¿¡æ¯ï¼Œå› æ­¤å¯èƒ½ä¼šä¸¢å¤±é å¸¸é‡è¦çš„ç‰¹å¾ã€‚ç„¶è€Œå½“æˆ‘ä»¬è¿›è¡Œæ­£åˆ™åŒ–å¤„ç†æ—¶ï¼Œä¼šè€ƒè™‘åˆ°ç»“æœå˜é‡ï¼Œä¸ä¼šä¸¢æ‰é‡è¦çš„æ•°æ®ã€‚</p><p>å¦ä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯ï¼Œé»˜è®¤åœ°å°†ä¸»è¦æˆåˆ†åˆ†æä½œä¸ºå­¦ä¹ è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè¿™è™½ç„¶å¾ˆå¤šæ—¶å€™æœ‰æ•ˆæœï¼Œæœ€å¥½è¿˜æ˜¯ä»æ‰€æœ‰åŸå§‹ç‰¹å¾å¼€å§‹ï¼Œåªåœ¨æœ‰å¿…è¦çš„æ—¶å€™ï¼ˆç®—æ³•è¿è¡Œå¤ªæ…¢æˆ–è€…å ç”¨å¤ªå¤šå†…å­˜ï¼‰æ‰è€ƒè™‘é‡‡ç”¨ä¸»è¦æˆåˆ†åˆ†æã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> é™ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>07_èšç±»(Clustering)</title>
      <link href="2020/12/09/machinelearning/wu-en-da-ji-qi-xue-xi/07-clustering/"/>
      <url>2020/12/09/machinelearning/wu-en-da-ji-qi-xue-xi/07-clustering/</url>
      
        <content type="html"><![CDATA[<h1 id="èšç±»-Clustering"><a href="#èšç±»-Clustering" class="headerlink" title="èšç±»_Clustering"></a>èšç±»_Clustering</h1><h2 id="1-K-å‡å€¼ç®—æ³•ï¼ˆK-Meansï¼‰"><a href="#1-K-å‡å€¼ç®—æ³•ï¼ˆK-Meansï¼‰" class="headerlink" title="1.K-å‡å€¼ç®—æ³•ï¼ˆK-Meansï¼‰"></a>1.K-å‡å€¼ç®—æ³•ï¼ˆK-Meansï¼‰</h2><p>K-å‡å€¼æ˜¯æœ€æ™®åŠçš„èšç±»ç®—æ³•ï¼Œç®—æ³•æ¥å—ä¸€ä¸ªæœªæ ‡è®°çš„æ•°æ®é›†ï¼Œç„¶åå°†æ•°æ®èšç±»æˆä¸åŒçš„ ç»„ã€‚</p><p>K-å‡å€¼æ˜¯ä¸€ä¸ªè¿­ä»£ç®—æ³•ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦å°†æ•°æ®èšç±»æˆ n ä¸ªç»„ï¼Œå…¶æ–¹æ³•ä¸º:</p><ol><li>é¦–å…ˆé€‰æ‹©ğ¾ä¸ªéšæœºçš„ç‚¹ï¼Œç§°ä¸ºèšç±»ä¸­å¿ƒï¼ˆcluster centroidsï¼‰</li><li>å¯¹äºæ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®ï¼ŒæŒ‰ç…§è·ç¦»ğ¾ä¸ªä¸­å¿ƒç‚¹çš„è·ç¦»ï¼Œå°†å…¶ä¸è·ç¦»æœ€è¿‘çš„ä¸­å¿ƒç‚¹å…³è”èµ·æ¥ï¼Œä¸åŒä¸€ä¸ªä¸­å¿ƒç‚¹å…³è”çš„æ‰€æœ‰ç‚¹èšæˆä¸€ç±»ã€‚</li><li>è®¡ç®—æ¯ä¸€ä¸ªç»„çš„å¹³å‡å€¼ï¼Œå°†è¯¥ç»„æ‰€å…³è”çš„ä¸­å¿ƒç‚¹ç§»åŠ¨åˆ°å¹³å‡å€¼çš„ä½ç½®ã€‚</li><li>é‡å¤ä¸Šè¿°æ­¥éª¤2-3ç›´è‡³ä¸­å¿ƒç‚¹ä¸å†å˜åŒ–</li></ol><p>ç”¨ $\mu^{1}, \mu^{2}, \ldots, \mu^{k}$ æ¥è¡¨ç¤ºèšç±»ä¸­å¿ƒ, ç”¨ $c^{(1)}, c^{(2)}, \ldots, c^{(m)}$ æ¥å­˜å‚¨ä¸ç¬¬iä¸ªå®ä¾‹æ•°æ®æœ€è¿‘çš„èšç±»ä¸­å¿ƒçš„ç´¢å¼•ï¼ŒK-å‡å€¼ç®—æ³•çš„ä»£ç å¦‚ä¸‹:</p><h2 id="2-ä¼˜åŒ–ç›®æ ‡"><a href="#2-ä¼˜åŒ–ç›®æ ‡" class="headerlink" title="2.ä¼˜åŒ–ç›®æ ‡"></a>2.ä¼˜åŒ–ç›®æ ‡</h2><p>K-å‡å€¼æœ€å°åŒ–é—®é¢˜ï¼Œæ˜¯è¦æœ€å°åŒ–æ‰€æœ‰çš„æ•°æ®ç‚¹ä¸å…¶æ‰€å…³è”çš„èšç±»ä¸­å¿ƒç‚¹ä¹‹é—´çš„è·ç¦»ä¹‹å’Œï¼Œ å› æ­¤ K-å‡å€¼çš„ä»£ä»·å‡½æ•°ï¼ˆåˆç§°ç•¸å˜å‡½æ•° Distortion functionï¼‰ä¸º:</p><script type="math/tex; mode=display">J\left(c^{(1)}, \ldots, c^{(m)}, \mu_{1}, \ldots, \mu_{K}\right)=\frac{1}{m} \sum_{i=1}^{m}\left\|X^{(i)}-\mu_{c^{(i)}}\right\|^{2}</script><p>å…¶ä¸­ $\mu_{c^{(i)}}$ ä»£è¡¨ä¸ $x^{(i)}$ æœ€è¿‘çš„èšç±»ä¸­å¿ƒç‚¹ã€‚ æˆ‘ä»¬çš„çš„ä¼˜åŒ–ç›®æ ‡ä¾¿æ˜¯æ‰¾å‡ºä½¿å¾—ä»£ä»·å‡½æ•°æœ€å°çš„ $c^{(1)}, c^{(2)}, \ldots, c^{(m)}$ å’Œ $\mu^{1}, \mu^{2}, \ldots, \mu^{k}$ :</p><script type="math/tex; mode=display">\min _{c^{(1)}, \ldots, c^{(m)}, \atop \mu_{1}, \ldots, \mu_{K}} J\left(c^{(1)}, \ldots, c^{(m)}, \mu_{1}, \ldots, \mu_{K}\right)</script><p>å›é¡¾åˆšæ‰ç»™å‡ºçš„: K-å‡å€¼è¿­ä»£ç®—æ³•ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œç¬¬ä¸€ä¸ªå¾ªç¯æ˜¯ç”¨äºå‡å°$ğ‘^{(ğ‘–)}$å¼•èµ·çš„ä»£ä»·ï¼Œ è€Œç¬¬äºŒä¸ªå¾ªç¯åˆ™æ˜¯ç”¨äºå‡å°$\mu^{i}$å¼•èµ·çš„ä»£ä»·ã€‚è¿­ä»£çš„è¿‡ç¨‹ä¸€å®šä¼šæ˜¯æ¯ä¸€æ¬¡è¿­ä»£éƒ½åœ¨å‡å°ä»£ä»·å‡½æ•°ï¼Œä¸ç„¶ä¾¿æ˜¯å‡ºç°äº†é”™è¯¯ã€‚</p><h2 id="3-éšæœºåˆå§‹åŒ–"><a href="#3-éšæœºåˆå§‹åŒ–" class="headerlink" title="3.éšæœºåˆå§‹åŒ–"></a>3.éšæœºåˆå§‹åŒ–</h2><p>åœ¨è¿è¡Œ K-å‡å€¼ç®—æ³•çš„ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦éšæœºåˆå§‹åŒ–æ‰€æœ‰çš„èšç±»ä¸­å¿ƒç‚¹ï¼Œä¸‹é¢ä»‹ç»æ€æ ·åš:</p><ol><li>æˆ‘ä»¬åº”è¯¥é€‰æ‹©$ğ¾ &lt; ğ‘š$ï¼Œå³èšç±»ä¸­å¿ƒç‚¹çš„ä¸ªæ•°è¦å°äºæ‰€æœ‰è®­ç»ƒé›†å®ä¾‹çš„æ•°é‡ã€‚</li><li>éšæœºé€‰æ‹©$ğ¾$ä¸ªè®­ç»ƒå®ä¾‹ï¼Œç„¶åä»¤$ğ¾$ä¸ªèšç±»ä¸­å¿ƒåˆ†åˆ«ä¸è¿™$ğ¾$ä¸ªè®­ç»ƒå®ä¾‹ç›¸ç­‰ã€‚</li></ol><p>K-å‡å€¼çš„ä¸€ä¸ªé—®é¢˜åœ¨äºï¼Œå®ƒæœ‰å¯èƒ½ä¼šåœç•™åœ¨ä¸€ä¸ªå±€éƒ¨æœ€å°å€¼å¤„ï¼Œè€Œè¿™å–å†³äºåˆå§‹åŒ–çš„æƒ…å†µã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209110404.png" alt="image-20201209110404386"></p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦å¤šæ¬¡è¿è¡Œ K-å‡å€¼ç®—æ³•ï¼Œæ¯ä¸€æ¬¡éƒ½é‡æ–°è¿›è¡Œéšæœºåˆå§‹åŒ–ï¼Œæœ€åå†æ¯”è¾ƒå¤šæ¬¡è¿è¡ŒK-å‡å€¼çš„ç»“æœï¼Œé€‰æ‹©ä»£ä»·å‡½æ•°æœ€å°çš„ç»“æœã€‚è¿™ç§æ–¹æ³•åœ¨ğ¾è¾ƒå°çš„æ—¶å€™è¿˜æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å¦‚æœğ¾è¾ƒå¤§ï¼Œè¿™ä¹ˆåšä¹Ÿå¯èƒ½ä¸ä¼šæœ‰æ˜æ˜¾åœ°æ”¹å–„ã€‚</p><h2 id="4-é€‰æ‹©èšç±»æ•°"><a href="#4-é€‰æ‹©èšç±»æ•°" class="headerlink" title="4.é€‰æ‹©èšç±»æ•°"></a>4.é€‰æ‹©èšç±»æ•°</h2><p>æ²¡æœ‰æ‰€è°“æœ€å¥½çš„é€‰æ‹©èšç±»æ•°çš„æ–¹æ³•ï¼Œé€šå¸¸æ˜¯éœ€è¦æ ¹æ®ä¸åŒçš„é—®é¢˜ï¼Œäººå·¥è¿›è¡Œé€‰æ‹©çš„ã€‚é€‰æ‹©çš„æ—¶å€™æ€è€ƒæˆ‘ä»¬è¿ç”¨ K-å‡å€¼ç®—æ³•èšç±»çš„åŠ¨æœºæ˜¯ä»€ä¹ˆï¼Œç„¶åé€‰æ‹©èƒ½æœ€å¥½æœåŠ¡äºè¯¥ç›®çš„æ ‡èšç±»æ•°ã€‚</p><p>å½“äººä»¬åœ¨è®¨è®ºï¼Œé€‰æ‹©èšç±»æ•°ç›®çš„æ–¹æ³•æ—¶ï¼Œæœ‰ä¸€ä¸ªå¯èƒ½ä¼šè°ˆåŠçš„æ–¹æ³•å«ä½œâ€œè‚˜éƒ¨æ³•åˆ™â€ã€‚å…³ äºâ€œè‚˜éƒ¨æ³•åˆ™â€ï¼Œæˆ‘ä»¬æ‰€éœ€è¦åšçš„æ˜¯æ”¹å˜ğ¾å€¼ï¼Œä¹Ÿå°±æ˜¯èšç±»ç±»åˆ«æ•°ç›®çš„æ€»æ•°ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªèšç±» æ¥è¿è¡Œ K å‡å€¼èšç±»æ–¹æ³•ã€‚è¿™å°±æ„å‘³ç€ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šåˆ†åˆ°ä¸€ä¸ªèšç±»é‡Œï¼Œç„¶åè®¡ç®—æˆæœ¬å‡½æ•°æˆ–è€…è®¡ç®—ç•¸å˜å‡½æ•°ğ½ã€‚ğ¾ä»£è¡¨èšç±»æ•°å­—ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209110610.png" alt="image-20201209110610896"></p><p>æˆ‘ä»¬å¯èƒ½ä¼šå¾—åˆ°ä¸€æ¡ç±»ä¼¼äºè¿™æ ·çš„æ›²çº¿ã€‚åƒä¸€ä¸ªäººçš„è‚˜éƒ¨ã€‚è¿™å°±æ˜¯â€œè‚˜éƒ¨æ³•åˆ™â€æ‰€åšçš„ï¼Œ è®©æˆ‘ä»¬æ¥çœ‹è¿™æ ·ä¸€ä¸ªå›¾ï¼Œçœ‹èµ·æ¥å°±å¥½åƒæœ‰ä¸€ä¸ªå¾ˆæ¸…æ¥šçš„è‚˜åœ¨é‚£å„¿ã€‚å¥½åƒäººçš„æ‰‹è‡‚ï¼Œå¦‚æœä½ ä¼¸ å‡ºä½ çš„èƒ³è†Šï¼Œé‚£ä¹ˆè¿™å°±æ˜¯ä½ çš„è‚©å…³èŠ‚ã€è‚˜å…³èŠ‚ã€æ‰‹ã€‚è¿™å°±æ˜¯â€œè‚˜éƒ¨æ³•åˆ™â€ã€‚ä½ ä¼šå‘ç°è¿™ç§æ¨¡å¼ï¼Œ å®ƒçš„ç•¸å˜å€¼ä¼šè¿…é€Ÿä¸‹é™ï¼Œä» 1 åˆ° 2ï¼Œä» 2 åˆ° 3 ä¹‹åï¼Œä½ ä¼šåœ¨ 3 çš„æ—¶å€™è¾¾åˆ°ä¸€ä¸ªè‚˜ç‚¹ã€‚åœ¨æ­¤ä¹‹ åï¼Œç•¸å˜å€¼å°±ä¸‹é™çš„éå¸¸æ…¢ï¼Œçœ‹èµ·æ¥å°±åƒä½¿ç”¨ 3 ä¸ªèšç±»æ¥è¿›è¡Œèšç±»æ˜¯æ­£ç¡®çš„ï¼Œè¿™æ˜¯å› ä¸ºé‚£ä¸ª ç‚¹æ˜¯æ›²çº¿çš„è‚˜ç‚¹ï¼Œç•¸å˜å€¼ä¸‹é™å¾—å¾ˆå¿«ï¼Œğ¾ = 3ä¹‹åå°±ä¸‹é™å¾—å¾ˆæ…¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±é€‰ğ¾ = 3ã€‚å½“ä½  åº”ç”¨â€œè‚˜éƒ¨æ³•åˆ™â€çš„æ—¶å€™ï¼Œå¦‚æœä½ å¾—åˆ°äº†ä¸€ä¸ªåƒä¸Šé¢è¿™æ ·çš„å›¾ï¼Œé‚£ä¹ˆè¿™å°†æ˜¯ä¸€ç§ç”¨æ¥é€‰æ‹©èšç±» ä¸ªæ•°çš„åˆç†æ–¹æ³•ã€‚</p><p>èšç±»å‚è€ƒèµ„æ–™:</p><ol><li><p>ç›¸ä¼¼åº¦/è·ç¦»è®¡ç®—æ–¹æ³•æ€»ç»“</p><ul><li>é—µå¯å¤«æ–¯åŸºè·ç¦» Minkowski/ï¼ˆå…¶ä¸­æ¬§å¼è·ç¦»ï¼š $p=2$ )<script type="math/tex; mode=display">\operatorname{dist}(X, Y)=\left(\sum_{i=1}^{n}\left|x_{i}-y_{i}\right|\right)^{\frac{1}{p}}</script></li><li>æ°å¡å¾·ç›¸ä¼¼ç³»æ•°(Jaccard):<script type="math/tex; mode=display">       J(A, B)=\frac{|A \cap B|}{|A \cup B|}</script></li><li><p>ä½™å¼¦ç›¸ä¼¼åº¦(cosine similarity):$n$ ç»´å‘é‡ $x$ å’Œ $y$ çš„å¤¹è§’è®°åš $\theta$, æ ¹æ®ä½™å¼¦å®šç†ï¼Œå…¶ä½™å¼¦å€¼ä¸º:</p><script type="math/tex; mode=display">\cos (\theta)=\frac{x^{T} y}{|x| \cdot|y|}=\frac{\sum_{i=1}^{n} x_{i} y_{i}}{\sqrt{\sum_{i=1}^{n} x_{i}^{2}} \sqrt{\sum_{i=1}^{n} y_{i}^{2}}}</script></li><li><p>Pearson çš®å°”é€Šç›¸å…³ç³»æ•°:Pearson ç›¸å…³ç³»æ•°å³å°† $x ã€ y$ åæ ‡å‘é‡å„è‡ªå¹³ç§»åˆ°åŸç‚¹åçš„å¤¹è§’ä½™å¼¦ã€‚</p><script type="math/tex; mode=display">\rho_{X Y}=\frac{\operatorname{cov}(X, Y)}{\sigma_{X} \sigma_{Y}}=\frac{E\left[\left(X-\mu_{X}\right)\left(Y-\mu_{Y}\right)\right]}{\sigma_{X} \sigma_{Y}}=\frac{\sum_{i=1}^{n}\left(x-\mu_{X}\right)\left(y-\mu_{Y}\right)}{\sqrt{\sum_{i=1}^{n}\left(x-\mu_{X}\right)^{2}} \sqrt{\sum_{i=1}^{n}\left(y-\mu_{Y}\right)^{2}}}</script></li></ul></li><li><p>èšç±»çš„è¡¡é‡æŒ‡æ ‡</p><ul><li><p>å‡ä¸€æ€§:ğ‘</p><p>ç±»ä¼¼äºç²¾ç¡®ç‡ï¼Œä¸€ä¸ªç°‡ä¸­åªåŒ…å«ä¸€ä¸ªç±»åˆ«çš„æ ·æœ¬ï¼Œåˆ™æ»¡è¶³å‡ä¸€æ€§ã€‚å…¶å®ä¹Ÿå¯ä»¥è®¤ä¸ºå°±æ˜¯æ­£ç¡®ç‡ï¼ˆæ¯ä¸ªèšç°‡ä¸­æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬æ•°å è¯¥èšç°‡æ€»æ ·æœ¬æ•°çš„æ¯”ä¾‹å’Œï¼‰</p></li><li><p>å®Œæ•´æ€§:ğ‘Ÿ</p><p>ç±»ä¼¼äºå¬å›ç‡ï¼ŒåŒç±»åˆ«æ ·æœ¬è¢«å½’ç±»åˆ°ç›¸åŒç°‡ä¸­ï¼Œåˆ™æ»¡è¶³å®Œæ•´æ€§;(æ¯ä¸ªèšç°‡ä¸­æ­£ç¡®åˆ†ç±»çš„ æ ·æœ¬æ•°å è¯¥ç±»å‹çš„æ€»æ ·æœ¬æ•°æ¯”ä¾‹çš„å’Œ)</p></li><li><p>V-measure:</p><p>å‡ä¸€æ€§å’Œå®Œæ•´æ€§çš„åŠ æƒå¹³å‡ï¼š</p><script type="math/tex; mode=display">V=\frac{\left(1+\beta^{2}\right) * p r}{\beta^{2} * p+r}</script></li><li><p>è½®å»“ç³»æ•°</p><p>æ ·æœ¬içš„è½®å»“ç³»æ•°: $s(i)$<br>æ—å†…ä¸ç›¸ä¼¼åº¦:è®¡ç®—æ ·æœ¬iåˆ°åŒæ—å…¶å®ƒæ ·æœ¬çš„å¹³å‡è·ç¦»ä¸º $a(i),$ åº”å°½å¯èƒ½å°ã€‚<br>æ—é—´ä¸ç›¸ä¼¼åº¦:è®¡ç®—æ ·æœ¬ $i$ åˆ°å…¶å®ƒæ— $C_{j}$ çš„æ‰€æœ‰æ ·æœ¬çš„å¹³å‡è·ç¦» $b_{i j},$ åº”å°½å¯èƒ½å¤§ã€‚<br>è½®å»“ç³»æ•° $s(i)$ å€¼è¶Šæ¥è¿‘ 1 è¡¨ç¤ºæ ·æœ¬ $i$ èšç±»è¶Šåˆç†ï¼Œè¶Šæ¥è¿‘-1ï¼Œè¡¨ç¤ºæ ·æœ¬ $i$ åº”è¯¥åˆ†ç±»åˆ°å¦å¤–çš„ç°‡ä¸­ï¼Œè¿‘ä¼¼ä¸º 0ï¼Œè¡¨ç¤ºæ ·æœ¬$ğ‘–$åº”è¯¥åœ¨è¾¹ç•Œä¸Šï¼Œæ‰€æœ‰æ ·æœ¬çš„$ğ‘ (ğ‘–)$çš„å‡å€¼è¢«æˆä¸ºèšç±»ç»“æœçš„è½®å»“ç³»æ•°ã€‚</p><script type="math/tex; mode=display">s(i)=\frac{b(i)-a(i)}{\max \{a(i), b(i)\}}</script></li></ul></li></ol><ul><li><p>ARI</p><p>æ•°æ®é›†Så…±æœ‰Nä¸ªå…ƒç´ ï¼Œ ä¸¤ä¸ªèšç±»ç»“æœåˆ†åˆ«æ˜¯:</p><script type="math/tex; mode=display">X=\left\{X_{1}, X_{2}, \ldots, X_{r}\right\}, Y=\left\{Y_{1}, Y_{2}, \ldots, Y_{S}\right\}</script><p>  $X$ å’Œ $Y$ çš„å…ƒç´ ä¸ªæ•°ä¸º:</p><script type="math/tex; mode=display">  a=\left\{a_{1}, a_{2}, \ldots, a_{r}\right\}, b=\left\{b_{1}, b_{2}, \ldots, b_{s}\right\}</script><p>  è®°: $n_{i j}=\left|X_{i} \cap Y_{i}\right|$</p><script type="math/tex; mode=display">  A R I=\frac{\sum_{i, j} C_{n_{i j}}^{2}-\left[\left(\sum_{i} C_{a_{i}}^{2}\right) \cdot\left(\sum_{i} C_{b_{i}}^{2}\right)\right] / C_{n}^{2}}{\frac{1}{2}\left[\left(\sum_{i} C_{a_{i}}^{2}\right)+\left(\Sigma_{i} C_{b_{i}}^{2}\right)\right]-\left[\left(\sum_{i} C_{a_{i}}^{2}\right) \cdot\left(\sum_{i} C_{b_{i}}^{2}\right)\right] / C_{n}^{2}}</script></li></ul>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> èšç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>06_æ”¯æŒå‘é‡æœº(SupportVectorMachines)</title>
      <link href="2020/12/08/machinelearning/wu-en-da-ji-qi-xue-xi/06-support-vector-machines/"/>
      <url>2020/12/08/machinelearning/wu-en-da-ji-qi-xue-xi/06-support-vector-machines/</url>
      
        <content type="html"><![CDATA[<h1 id="æ”¯æŒå‘é‡æœº-Support-Vector-Machines"><a href="#æ”¯æŒå‘é‡æœº-Support-Vector-Machines" class="headerlink" title="æ”¯æŒå‘é‡æœº_Support_Vector_Machines"></a>æ”¯æŒå‘é‡æœº_Support_Vector_Machines</h1><h2 id="1-ä¼˜åŒ–ç›®æ ‡ï¼ˆoptimization-objectiveï¼‰"><a href="#1-ä¼˜åŒ–ç›®æ ‡ï¼ˆoptimization-objectiveï¼‰" class="headerlink" title="1.ä¼˜åŒ–ç›®æ ‡ï¼ˆoptimization objectiveï¼‰"></a>1.ä¼˜åŒ–ç›®æ ‡ï¼ˆoptimization objectiveï¼‰</h2><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208155835.png" alt="image-20201208155835819"></p><p>é‚£ä¹ˆï¼Œåœ¨é€»è¾‘å›å½’ä¸­æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰äº†è¿™é‡Œçš„å‡è®¾å‡½æ•°å½¢å¼ï¼Œå’Œå³è¾¹çš„ S å‹æ¿€åŠ±å‡½æ•°ã€‚ç„¶è€Œï¼Œä¸ºäº†è§£é‡Šä¸€äº›æ•°å­¦çŸ¥è¯†ã€‚å°†ç”¨z è¡¨ç¤º $\theta^{T} x_{\circ}$<br>ç°åœ¨è€ƒè™‘ä¸‹æˆ‘ä»¬æƒ³è¦é€»è¾‘å›å½’åšä»€ä¹ˆï¼šå¦‚æœæœ‰ä¸€ä¸ª $y=1$ çš„æ ·æœ¬ï¼Œæˆ‘çš„æ„æ€æ˜¯ä¸ç®¡æ˜¯åœ¨è®­ç»ƒé›†ä¸­æˆ–æ˜¯åœ¨æµ‹è¯•é›†ä¸­ï¼Œåˆæˆ–è€…åœ¨äº¤ä¹‰éªŒè¯é›†ä¸­ï¼Œæ€»ä¹‹æ˜¯ $y=1,$ ç°åœ¨æˆ‘ä»¬å¸Œæœ› $h_{\theta}(x)$ è¶‹è¿‘1ã€‚å› ä¸ºæˆ‘ä»¬æƒ³è¦æ­£ç¡®åœ°å°†æ­¤æ ·æœ¬åˆ†ç±»ï¼Œè¿™å°±æ„å‘³ç€å½“ $h_{\theta}(x)$ è¶‹è¿‘äº 1 æ—¶, $\theta^{T} x$ åº”å½“è¿œå¤§äº 0ï¼Œè¿™é‡Œçš„&gt;&gt;æ„æ€æ˜¯è¿œè¿œå¤§äº 0 ã€‚è¿™æ˜¯å› ä¸ºç”±äº $z$ è¡¨ç¤º $\theta^{T} x,$ å½“ Zè¿œå¤§äº 0 æ—¶ï¼Œå³åˆ°äº†è¯¥å›¾çš„å³è¾¹, ä½ ä¸éš¾å‘ç°æ­¤æ—¶é€»è¾‘å›å½’çš„è¾“å‡ºå°†è¶‹è¿‘äº 1 ã€‚ç›¸ååœ°, å¦‚æœæˆ‘ä»¬æœ‰å¦ä¸€ä¸ªæ ·æœ¬,å³ $y=0$ ã€‚æˆ‘ä»¬å¸Œæœ›å‡è®¾å‡½æ•°çš„è¾“å‡ºå€¼å°†è¶‹è¿‘äº 0ï¼Œè¿™å¯¹åº”äº $\theta^{T} x,$ æˆ–è€…å°±æ˜¯ $z$ ä¼šè¿œå°äº $0,$<br>å› ä¸ºå¯¹åº”çš„å‡è®¾å‡½æ•°çš„è¾“å‡ºå€¼è¶‹è¿‘ 0 ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208172623.png" alt="image-20201208155942584"></p><p>å¦‚æœä½ è¿›ä¸€æ­¥è§‚å¯Ÿé€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ï¼Œä½ ä¼šå‘ç°æ¯ä¸ªæ ·æœ¬ (ğ‘¥,ğ‘¦)éƒ½ä¼šä¸ºæ€»ä»£ä»·å‡½æ•°ï¼Œ å¢åŠ è¿™é‡Œçš„ä¸€é¡¹ï¼Œ</p><script type="math/tex; mode=display">-\left(y \log h_{\theta}(x)+(1-y) \log \left(1-h_{\theta}(x)\right)\right)</script><p>å› æ­¤ï¼Œå¯¹äºæ€»ä»£ä»·å‡½æ•°é€šå¸¸ä¼šæœ‰å¯¹æ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬æ±‚å’Œï¼Œå¹¶ä¸”è¿™é‡Œè¿˜æœ‰ä¸€ ä¸ª1/ğ‘šé¡¹ï¼Œä½†æ˜¯ï¼Œåœ¨é€»è¾‘å›å½’ä¸­ï¼Œè¿™é‡Œçš„è¿™ä¸€é¡¹å°±æ˜¯è¡¨ç¤ºä¸€ä¸ªè®­ç»ƒæ ·æœ¬æ‰€å¯¹åº”çš„è¡¨è¾¾å¼ã€‚ç° åœ¨ï¼Œå¦‚æœæˆ‘å°†å®Œæ•´å®šä¹‰çš„å‡è®¾å‡½æ•°ä»£å…¥è¿™é‡Œã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°æ¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬éƒ½å½±å“è¿™ä¸€é¡¹ã€‚</p><p>ç°åœ¨ï¼Œä¸€èµ·æ¥è€ƒè™‘ä¸¤ç§æƒ…å†µ:</p><p>ä¸€ç§æ˜¯ğ‘¦ç­‰äº 1 çš„æƒ…å†µ;å¦ä¸€ç§æ˜¯ ğ‘¦ ç­‰äº 0 çš„æƒ…å†µã€‚</p><p>åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸­ï¼Œå‡è®¾ $ğ‘¦ = 1$ ï¼Œæ­¤æ—¶åœ¨ç›®æ ‡å‡½æ•°ä¸­åªéœ€æœ‰ç¬¬ä¸€é¡¹èµ·ä½œç”¨ï¼Œå› ä¸º$ğ‘¦ = 1$æ—¶ï¼Œ$(1âˆ’ğ‘¦)$é¡¹å°†ç­‰äº 0ã€‚å› æ­¤ï¼Œå½“åœ¨$ ğ‘¦=1 $çš„æ ·æœ¬ä¸­æ—¶ï¼Œå³åœ¨ $(ğ‘¥,ğ‘¦)$ä¸­ ï¼Œæˆ‘ä»¬å¾—åˆ°$y=1-\log \left(1-\frac{1}{1+e^{-z}}\right)$è¿™æ ·ä¸€é¡¹</p><p>æˆ‘ä»¬ç”¨ $z$ è¡¨ç¤º $\theta^{T} x,$ å³ $: \quad z=\theta^{T} x_{\circ}$ å½“ç„¶ï¼Œåœ¨ä»£ä»·å‡½æ•°ä¸­ï¼Œ $y$ å‰é¢æœ‰è´Ÿå·ã€‚æˆ‘ä»¬åªæ˜¯è¿™æ ·è¡¨ç¤ºï¼Œå¦‚æœ $y=1$ ä»£ä»·å‡½æ•°ä¸­ï¼Œè¿™ä¸€é¡¹ä¹Ÿç­‰äº 1 ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†ç®€åŒ–æ­¤å¤„çš„è¡¨è¾¾å¼ã€‚å¦‚æœç”»å‡ºå…³äº $z$ çš„å‡½æ•°ï¼Œä½ ä¼šçœ‹åˆ°å·¦ä¸‹è§’çš„è¿™æ¡æ›²çº¿ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥çœ‹åˆ°ï¼Œå½“z å¢å¤§æ—¶ï¼Œä¹Ÿå°±æ˜¯ç›¸<br>å½“äº $\theta^{T} x$ å¢å¤§æ—¶ï¼Œ $z$ å¯¹åº”çš„å€¼ä¼šå˜çš„éå¸¸å°ã€‚å¯¹æ•´ä¸ªä»£ä»·å‡½æ•°è€Œè¨€ï¼Œå½±å“ä¹Ÿéå¸¸å°ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆé€»è¾‘å›å½’åœ¨è§‚å¯Ÿåˆ°æ­£æ ·æœ¬ $y=1$ æ—¶ï¼Œè¯•å›¾å°† $\theta^{T} x$ è®¾ç½®å¾—éå¸¸å¤§ã€‚å› ä¸ºï¼Œåœ¨ä»£ä»·å‡½æ•°ä¸­çš„è¿™ä¸€é¡¹ä¼šå˜çš„éå¸¸å°ã€‚ç°åœ¨å¼€å§‹å»ºç«‹æ”¯æŒå‘é‡æœºï¼Œæˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹:æˆ‘ä»¬ä¼šä»è¿™ä¸ªä»£ä»·å‡½æ•°å¼€å§‹, ä¹Ÿå°±æ˜¯$- \log \left(1-\frac{1}{1+e^{-z}}\right)$ ä¸€ç‚¹ä¸€ç‚¹ä¿®æ”¹ï¼Œè®©æˆ‘å–è¿™é‡Œçš„$z=1$ç‚¹ï¼Œæˆ‘å…ˆç”»å‡ºå°†è¦ç”¨çš„ä»£ä»·å‡½æ•°ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208172713.png" alt="image-20201208162008412"></p><p>æ–°çš„ä»£ä»·å‡½æ•°å°†ä¼šæ°´å¹³çš„ä»è¿™é‡Œåˆ°å³è¾¹(å›¾å¤–)ï¼Œç„¶åæˆ‘å†ç”»ä¸€æ¡åŒé€»è¾‘å›å½’éå¸¸ç›¸ä¼¼çš„ ç›´çº¿ï¼Œä½†æ˜¯ï¼Œåœ¨è¿™é‡Œæ˜¯ä¸€æ¡ç›´çº¿ï¼Œä¹Ÿå°±æ˜¯æˆ‘ç”¨ç´«çº¢è‰²ç”»çš„æ›²çº¿ï¼Œå°±æ˜¯è¿™æ¡ç´«çº¢è‰²çš„æ›²çº¿ã€‚é‚£ä¹ˆï¼Œåˆ°äº†è¿™é‡Œå·²ç»éå¸¸æ¥è¿‘é€»è¾‘å›å½’ä¸­ä½¿ç”¨çš„ä»£ä»·å‡½æ•°äº†ã€‚åªæ˜¯è¿™é‡Œæ˜¯ç”±ä¸¤æ¡çº¿æ®µç»„æˆï¼Œå³ä½äºå³è¾¹çš„æ°´å¹³éƒ¨åˆ†å’Œä½äºå·¦è¾¹çš„ç›´çº¿éƒ¨åˆ†ï¼Œå…ˆåˆ«è¿‡å¤šçš„è€ƒè™‘å·¦è¾¹ç›´çº¿éƒ¨åˆ†çš„æ–œç‡ï¼Œè¿™å¹¶ä¸æ˜¯å¾ˆé‡è¦ã€‚ä½†æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨çš„æ–°çš„ä»£ä»·å‡½æ•°ï¼Œæ˜¯åœ¨$ğ‘¦ = 1$çš„å‰æä¸‹çš„ã€‚ä½ ä¹Ÿè®¸èƒ½æƒ³åˆ°ï¼Œ è¿™åº”è¯¥èƒ½åšåŒé€»è¾‘å›å½’ä¸­ç±»ä¼¼çš„äº‹æƒ…ï¼Œä½†äº‹å®ä¸Šï¼Œåœ¨ä¹‹åçš„ä¼˜åŒ–é—®é¢˜ä¸­ï¼Œè¿™ä¼šå˜å¾—æ›´åšå®šï¼Œ å¹¶ä¸”ä¸ºæ”¯æŒå‘é‡æœºï¼Œå¸¦æ¥è®¡ç®—ä¸Šçš„ä¼˜åŠ¿ã€‚ä¾‹å¦‚ï¼Œæ›´å®¹æ˜“è®¡ç®—è‚¡ç¥¨äº¤æ˜“çš„é—®é¢˜ç­‰ç­‰ã€‚</p><p>ç›®å‰ï¼Œæˆ‘ä»¬åªæ˜¯è®¨è®ºäº†ğ‘¦ = 1çš„æƒ…å†µï¼Œå¦å¤–ä¸€ç§æƒ…å†µæ˜¯å½“ğ‘¦ = 0æ—¶ï¼Œæ­¤æ—¶å¦‚æœä½ ä»”ç»†è§‚å¯Ÿ ä»£ä»·å‡½æ•°åªç•™ä¸‹äº†ç¬¬äºŒé¡¹ï¼Œå› ä¸ºç¬¬ä¸€é¡¹è¢«æ¶ˆé™¤äº†ã€‚å¦‚æœå½“ğ‘¦ = 0æ—¶ï¼Œé‚£ä¹ˆè¿™ä¸€é¡¹ä¹Ÿå°±æ˜¯ 0 äº†ã€‚ æ‰€ä»¥ä¸Šè¿°è¡¨è¾¾å¼åªç•™ä¸‹äº†ç¬¬äºŒé¡¹ã€‚å› æ­¤ï¼Œè¿™ä¸ªæ ·æœ¬çš„ä»£ä»·æˆ–æ˜¯ä»£ä»·å‡½æ•°çš„è´¡çŒ®ã€‚å°†ä¼šç”±è¿™ä¸€ é¡¹è¡¨ç¤ºã€‚å¹¶ä¸”ï¼Œå¦‚æœä½ å°†è¿™ä¸€é¡¹ä½œä¸ºğ‘§çš„å‡½æ•°ï¼Œé‚£ä¹ˆï¼Œè¿™é‡Œå°±ä¼šå¾—åˆ°æ¨ªè½´ğ‘§ã€‚ç°åœ¨ï¼Œä½ å®Œæˆäº† æ”¯æŒå‘é‡æœºä¸­çš„éƒ¨åˆ†å†…å®¹ï¼ŒåŒæ ·åœ°ï¼Œæˆ‘ä»¬è¦æ›¿ä»£è¿™ä¸€æ¡è“è‰²çš„çº¿ï¼Œç”¨ç›¸ä¼¼çš„æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208172716.png" alt="image-20201208162104035"></p><p>å¦‚æœæˆ‘ä»¬ç”¨ä¸€ä¸ªæ–°çš„ä»£ä»·å‡½æ•°æ¥ä»£æ›¿ï¼Œå³è¿™æ¡ä» 0 ç‚¹å¼€å§‹çš„æ°´å¹³ç›´çº¿ï¼Œç„¶åæ˜¯ä¸€æ¡æ–œçº¿, åƒä¸Šå›¾ã€‚é‚£ä¹ˆï¼Œç°åœ¨è®©æˆ‘ç»™è¿™ä¸¤ä¸ªæ–¹ç¨‹å‘½åï¼Œå·¦è¾¹çš„å‡½æ•°ï¼Œæˆ‘ç§°ä¹‹ä¸º $cost_{1}(z),$ åŒæ—¶,å³è¾¹å‡½æ•°æˆ‘ç§°å®ƒä¸º $cost_{0}(z)$ã€‚ è¿™é‡Œçš„ä¸‹æ ‡æ˜¯æŒ‡åœ¨ä»£ä»·å‡½æ•°ä¸­ï¼Œå¯¹åº”çš„ $y=1$ å’Œ $y=0$ çš„æƒ…<br>å†µï¼Œæ‹¥æœ‰äº†è¿™äº›å®šä¹‰åï¼Œç°åœ¨ï¼Œæˆ‘ä»¬å°±å¼€å§‹æ„å»ºæ”¯æŒå‘é‡æœºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208172748.png" alt="image-20201208162206375"></p><p>è¿™æ˜¯æˆ‘ä»¬åœ¨é€»è¾‘å›å½’ä¸­ä½¿ç”¨ä»£ä»·å‡½æ•° $J(\theta)$ ã€‚ä¹Ÿè®¸è¿™ä¸ªæ–¹ç¨‹çœ‹èµ·æ¥ä¸æ˜¯éå¸¸ç†Ÿæ‚‰ã€‚è¿™æ˜¯å› ä¸ºä¹‹å‰æœ‰ä¸ªè´Ÿå·åœ¨æ–¹ç¨‹å¤–é¢ï¼Œä½†æ˜¯ï¼Œè¿™é‡Œæˆ‘æ‰€åšçš„æ˜¯ï¼Œå°†è´Ÿå·ç§»åˆ°äº†è¡¨è¾¾å¼çš„é‡Œé¢ï¼Œè¿™æ ·åšä½¿å¾—æ–¹ç¨‹çœ‹èµ·æ¥æœ‰äº›ä¸åŒã€‚å¯¹äºæ”¯æŒå‘é‡æœºè€Œè¨€ï¼Œå®è´¨ä¸Šæˆ‘ä»¬è¦å°†è¿™æ›¿æ¢ä¸º $cost_{1}(z),$ ä¹Ÿå°±<br>æ˜¯ $cost_{1}\left(\theta^{T} x\right),$ åŒæ ·åœ°ï¼Œæˆ‘ä¹Ÿå°†è¿™ä¸€é¡¹æ›¿æ¢ä¸º $cost_{0}(z),$ ä¹Ÿå°±æ˜¯ä»£ä»· $\cos t_{0}\left(\theta^{T} x\right)$ ã€‚è¿™é‡Œçš„ä»£ä»·å‡½æ•° $cost_{1}$, å°±æ˜¯ä¹‹å‰æ‰€æåˆ°çš„é‚£æ¡çº¿ã€‚æ­¤å¤–ï¼Œä»£ä»·å‡½æ•° $cost_{0}$, ä¹Ÿæ˜¯ä¸Šé¢æ‰€ä»‹ç»è¿‡çš„é‚£æ¡çº¿ã€‚å› æ­¤ï¼Œå¯¹äºæ”¯æŒå‘é‡æœºï¼Œæˆ‘ä»¬å¾—åˆ°äº†è¿™é‡Œçš„æœ€å°åŒ–é—®é¢˜ï¼Œå³:</p><script type="math/tex; mode=display">\min _{\theta} C \sum_{i=1}^{m}\left[y^{(i)} \cos t_{1}\left(\theta^{T} x^{(i)}\right)+\left(1-y^{(i)}\right) \operatorname{cost}_{0}\left(\theta^{T} x^{(i)}\right)\right]+\frac{1}{2} \sum_{i=1}^{n} \theta_{j}^{2}</script><p>ç„¶åï¼Œå†åŠ ä¸Šæ­£åˆ™åŒ–å‚æ•°ã€‚ç°åœ¨ï¼ŒæŒ‰ç…§æ”¯æŒå‘é‡æœºçš„æƒ¯ä¾‹ï¼Œäº‹å®ä¸Šï¼Œæˆ‘ä»¬çš„ä¹¦å†™ä¼šç¨å¾® æœ‰äº›ä¸åŒï¼Œä»£ä»·å‡½æ•°çš„å‚æ•°è¡¨ç¤ºä¹Ÿä¼šç¨å¾®æœ‰äº›ä¸åŒã€‚</p><p>æœ€åæœ‰åˆ«äºé€»è¾‘å›å½’è¾“å‡ºçš„æ¦‚ç‡ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çš„ä»£ä»·å‡½æ•°ï¼Œå½“æœ€å°åŒ–ä»£ä»·å‡½æ•°ï¼Œè·å¾—å‚æ•° $\theta$ æ—¶ï¼Œæ”¯æŒå‘é‡æœºæ‰€åšçš„æ˜¯å®ƒæ¥ç›´æ¥é¢„æµ‹ $y$ çš„å€¼ç­‰äº 1ï¼Œè¿˜æ˜¯ç­‰äº 0 ã€‚å› æ­¤ï¼Œè¿™ä¸ªå‡è®¾å‡½æ•°ä¼šé¢„æµ‹ 1ã€‚å½“ $\theta^{T} x$ å¤§äºæˆ–è€…ç­‰äº 0 æ—¶ï¼Œæˆ–è€…ç­‰äº 0 æ—¶ï¼Œæ‰€ä»¥å­¦ä¹ å‚æ•° $\theta$ å°±æ˜¯æ”¯æŒå‘é‡æœºå‡è®¾å‡½æ•°çš„å½¢å¼ã€‚é‚£ä¹ˆï¼Œè¿™å°±æ˜¯æ”¯æŒå‘é‡æœºæ•°å­¦ä¸Šçš„å®šä¹‰ã€‚</p><h2 id="2-å¤§è¾¹ç•Œçš„ç›´è§‚ç†è§£"><a href="#2-å¤§è¾¹ç•Œçš„ç›´è§‚ç†è§£" class="headerlink" title="2.å¤§è¾¹ç•Œçš„ç›´è§‚ç†è§£"></a>2.å¤§è¾¹ç•Œçš„ç›´è§‚ç†è§£</h2><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208165502.png" alt="image-20201208165502304"></p><p>è¿™æ˜¯æˆ‘çš„æ”¯æŒå‘é‡æœºæ¨¡å‹çš„ä»£ä»·å‡½æ•°ï¼Œåœ¨å·¦è¾¹è¿™é‡Œæˆ‘ç”»å‡ºäº†å…³äºzçš„ä»£ä»·å‡½æ•° $cost_{1}(z)$,æ­¤å‡½æ•°ç”¨äºæ­£æ ·æœ¬ï¼Œè€Œåœ¨å³è¾¹è¿™é‡Œæˆ‘ç”»å‡ºäº†å…³äºzçš„ä»£ä»·å‡½æ•° $cost_{0}(z),$ æ¨ªè½´è¡¨ç¤º $z$ ï¼Œç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹ï¼Œæœ€å°åŒ–è¿™äº›ä»£ä»·å‡½æ•°çš„å¿…è¦æ¡ä»¶æ˜¯ä»€ä¹ˆã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªæ­£æ ·æœ¬ï¼Œ $y=1$, åˆ™åªæœ‰åœ¨ $z&gt;=1$ æ—¶ï¼Œä»£ä»·å‡½æ•° $\cos t_{1}(z)$ æ‰ç­‰äº 0 ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæ­£æ ·æœ¬ï¼Œæˆ‘ä»¬ä¼šå¸Œæœ› $\theta^{T} x&gt;=1,$ åä¹‹ï¼Œå¦‚æœ $y=0,$ æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹ï¼Œå‡½æ•°cost $_{0}(z),$ å®ƒåªæœ‰åœ¨ $z&lt;=-1$ çš„åŒºé—´é‡Œå‡½æ•°å€¼ä¸º 0 ã€‚</p><p>è¿™æ˜¯æ”¯æŒå‘é‡æœºçš„ä¸€ä¸ªæœ‰è¶£æ€§è´¨ã€‚äº‹å®ä¸Šï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæ­£æ ·æœ¬ $y=1$ ï¼Œåˆ™å…¶å®æˆ‘ä»¬ä»…ä»…è¦æ±‚ $\theta^{T} x$ å¤§äºç­‰äº 0ï¼Œå°±èƒ½å°†è¯¥æ ·æœ¬æ°å½“åˆ†å‡ºï¼Œè¿™æ˜¯å› ä¸ºå¦‚æœ $\theta^{T} x&gt;0$ å¤§çš„è¯ï¼Œæˆ‘ä»¬çš„æ¨¡å‹ä»£ä»·å‡½æ•°å€¼ä¸º 0ï¼Œç±»ä¼¼åœ°ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªè´Ÿæ ·æœ¬ï¼Œåˆ™ä»…éœ€è¦ $\theta^{T} x&lt;=0$ å°±ä¼šå°†è´Ÿä¾‹æ­£ç¡®åˆ†ç¦»ï¼Œä½†æ˜¯ï¼Œæ”¯æŒå‘é‡æœºçš„è¦æ±‚æ›´é«˜ï¼Œä¸ä»…ä»…è¦èƒ½æ­£ç¡®åˆ†å¼€è¾“å…¥çš„æ ·æœ¬ï¼Œå³ä¸ä»…ä»…è¦æ±‚ $\theta^{T} x&gt;0,$ æˆ‘ä»¬éœ€è¦çš„æ˜¯æ¯” 0 å€¼å¤§å¾ˆå¤šï¼Œæ¯”å¦‚å¤§äº<br>ç­‰äº 1ï¼Œæˆ‘ä¹Ÿæƒ³è¿™ä¸ªæ¯” 0 å°å¾ˆå¤šï¼Œæ¯”å¦‚æˆ‘å¸Œæœ›å®ƒå°äºç­‰äº-1ï¼Œè¿™å°±ç›¸å½“äºåœ¨æ”¯æŒå‘é‡æœºä¸­åµŒå…¥äº†ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å› å­ï¼Œæˆ–è€…è¯´å®‰å…¨çš„é—´è·å› å­ã€‚</p><p>å½“ç„¶ï¼Œé€»è¾‘å›å½’åšäº†ç±»ä¼¼çš„äº‹æƒ…ã€‚ä½†æ˜¯è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œåœ¨æ”¯æŒå‘é‡æœºä¸­ï¼Œè¿™ä¸ªå› å­ä¼šå¯¼ è‡´ä»€ä¹ˆç»“æœã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘æ¥ä¸‹æ¥ä¼šè€ƒè™‘ä¸€ä¸ªç‰¹ä¾‹ã€‚æˆ‘ä»¬å°†è¿™ä¸ªå¸¸æ•°ğ¶è®¾ç½®æˆä¸€ä¸ªéå¸¸å¤§çš„ å€¼ã€‚æ¯”å¦‚æˆ‘ä»¬å‡è®¾ğ¶çš„å€¼ä¸º 100000 æˆ–è€…å…¶å®ƒéå¸¸å¤§çš„æ•°ï¼Œç„¶åæ¥è§‚å¯Ÿæ”¯æŒå‘é‡æœºä¼šç»™å‡ºä»€ ä¹ˆç»“æœ?</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208165637.png" alt="image-20201208165636975"></p><p>å¦‚æœ $C$ éå¸¸å¤§ï¼Œåˆ™æœ€å°åŒ–ä»£ä»·å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†ä¼šå¾ˆå¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªä½¿ç¬¬ä¸€é¡¹ä¸º 0 çš„æœ€ä¼˜è§£ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬å°è¯•åœ¨ä»£ä»·é¡¹çš„ç¬¬ä¸€é¡¹ä¸º 0 çš„æƒ…å½¢ä¸‹ç†è§£è¯¥ä¼˜åŒ–é—®é¢˜ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥æŠŠCè®¾ç½®æˆäº†éå¸¸å¤§çš„å¸¸æ•°ï¼Œè¿™å°†ç»™æˆ‘ä»¬ä¸€äº›å…³äºæ”¯æŒå‘é‡æœºæ¨¡å‹çš„ç›´è§‚æ„Ÿå—ã€‚</p><script type="math/tex; mode=display">\min _{\theta} C \sum_{i=1}^{m}\left[y^{(i)} \cos t_{1}\left(\theta^{T} x^{(i)}\right)+\left(1-y^{(i)}\right) \cos t\left(\theta^{T} x^{(i)}\right)\right]+\frac{1}{2} \sum_{i=1}^{n} \theta_{j}^{2}</script><p>æˆ‘ä»¬å·²ç»çœ‹åˆ°è¾“å…¥ä¸€ä¸ªè®­ç»ƒæ ·æœ¬æ ‡ç­¾ä¸º $y=1,$ ä½ æƒ³ä»¤ç¬¬ä¸€é¡¹ä¸º $0,$ ä½ éœ€è¦åšçš„æ˜¯æ‰¾åˆ°ä¸€ä¸ª $\theta,$ ä½¿å¾— $\theta^{T} x&gt;=1,$ ç±»ä¼¼åœ°ï¼Œå¯¹äºä¸€ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œæ ‡ç­¾ä¸º $y=0,$ ä¸ºäº†ä½¿ $cost_{0}(z)$ å‡½æ•°çš„å€¼ä¸º 0ï¼Œæˆ‘ä»¬éœ€è¦ $\theta^{T} x&lt;=-1$ ã€‚å› æ­¤ï¼Œç°åœ¨è€ƒè™‘æˆ‘ä»¬çš„ä¼˜åŒ–é—®é¢˜ã€‚é€‰æ‹©å‚æ•°ï¼Œä½¿å¾—ç¬¬ä¸€é¡¹ç­‰<br>äº 0ï¼Œå°±ä¼šå¯¼è‡´ä¸‹é¢çš„ä¼˜åŒ–é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬å°†é€‰æ‹©å‚æ•°ä½¿ç¬¬ä¸€é¡¹ä¸º 0ï¼Œå› æ­¤è¿™ä¸ªå‡½æ•°çš„ç¬¬ä¸€é¡¹ä¸º 0ï¼Œå› æ­¤æ˜¯Cä¹˜ä»¥ 0 åŠ ä¸ŠäºŒåˆ†ä¹‹ä¸€ä¹˜ä»¥ç¬¬äºŒé¡¹ã€‚è¿™é‡Œç¬¬ä¸€é¡¹æ˜¯Cä¹˜ä»¥ 0ï¼Œå› æ­¤å¯ä»¥å°†å…¶åˆ å»ï¼Œå› ä¸ºæˆ‘çŸ¥é“å®ƒæ˜¯ 0ã€‚<br>è¿™å°†éµä»ä»¥ä¸‹çš„çº¦æŸ: $\theta^{T} x^{(i)}&gt;=1,$ å¦‚æœ $y^{(i)}$ æ˜¯ç­‰äº 1 çš„, $\theta^{T} x^{(i)}&lt;=-1,$ å¦‚æœæ ·æœ¬ $i$æ˜¯ä¸€ä¸ªè´Ÿæ ·æœ¬ï¼Œè¿™æ ·å½“ä½ æ±‚è§£è¿™ä¸ªä¼˜åŒ–é—®é¢˜çš„æ—¶å€™ï¼Œå½“ä½ æœ€å°åŒ–è¿™ä¸ªå…³äºå˜é‡ $\theta$ çš„å‡½æ•°çš„æ—¶å€™ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªéå¸¸æœ‰è¶£çš„å†³ç­–è¾¹ç•Œã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208171625.png" alt="image-20201208171625321"></p><p>å…·ä½“è€Œè¨€ï¼Œå¦‚æœä½ è€ƒå¯Ÿè¿™æ ·ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­æœ‰æ­£æ ·æœ¬ï¼Œä¹Ÿæœ‰è´Ÿæ ·æœ¬ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ•°æ®é›†æ˜¯çº¿æ€§å¯åˆ†çš„ã€‚å­˜åœ¨ä¸€æ¡ç›´çº¿æŠŠæ­£è´Ÿæ ·æœ¬åˆ†å¼€ã€‚å½“ç„¶æœ‰å¤šæ¡ä¸åŒçš„ç›´çº¿ï¼Œ å¯ä»¥æŠŠæ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬å®Œå…¨åˆ†å¼€ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208172849.png" alt="image-20201208171752369"></p><p>æ¯”å¦‚ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªå†³ç­–è¾¹ç•Œå¯ä»¥æŠŠæ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬åˆ†å¼€ã€‚ä½†æ˜¯å¤šå¤šå°‘å°‘è¿™ä¸ªçœ‹èµ·æ¥å¹¶ä¸ æ˜¯éå¸¸è‡ªç„¶æ˜¯ä¹ˆ?</p><p>æˆ–è€…æˆ‘ä»¬å¯ä»¥ç”»ä¸€æ¡æ›´å·®çš„å†³ç­–ç•Œï¼Œè¿™æ˜¯å¦ä¸€æ¡å†³ç­–è¾¹ç•Œï¼Œå¯ä»¥å°†æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬åˆ†å¼€ï¼Œ ä½†ä»…ä»…æ˜¯å‹‰å¼ºåˆ†å¼€ï¼Œè¿™äº›å†³ç­–è¾¹ç•Œçœ‹èµ·æ¥éƒ½ä¸æ˜¯ç‰¹åˆ«å¥½çš„é€‰æ‹©ï¼Œæ”¯æŒå‘é‡æœºå°†ä¼šé€‰æ‹©è¿™ä¸ªé»‘è‰²çš„å†³ç­–è¾¹ç•Œï¼Œç›¸è¾ƒäºä¹‹å‰æˆ‘ç”¨ç²‰è‰²æˆ–è€…ç»¿è‰²ç”»çš„å†³ç­–ç•Œã€‚è¿™æ¡é»‘è‰²çš„çœ‹èµ·æ¥å¥½å¾—å¤šï¼Œé»‘çº¿ çœ‹èµ·æ¥æ˜¯æ›´ç¨³å¥çš„å†³ç­–ç•Œã€‚åœ¨åˆ†ç¦»æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬ä¸Šå®ƒæ˜¾å¾—çš„æ›´å¥½ã€‚æ•°å­¦ä¸Šæ¥è®²ï¼Œè¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢?è¿™æ¡é»‘çº¿æœ‰æ›´å¤§çš„è·ç¦»ï¼Œè¿™ä¸ªè·ç¦»å«åšé—´è·ï¼ˆmarginï¼‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208171859.png" alt="image-20201208171859274"></p><p>å½“ç”»å‡ºè¿™ä¸¤æ¡é¢å¤–çš„è“çº¿ï¼Œæˆ‘ä»¬çœ‹åˆ°é»‘è‰²çš„å†³ç­–ç•Œå’Œè®­ç»ƒæ ·æœ¬ä¹‹é—´æœ‰æ›´å¤§çš„æœ€çŸ­è·ç¦»ã€‚ ç„¶è€Œç²‰çº¿å’Œè“çº¿ç¦»è®­ç»ƒæ ·æœ¬å°±éå¸¸è¿‘ï¼Œåœ¨åˆ†ç¦»æ ·æœ¬çš„æ—¶å€™å°±ä¼šæ¯”é»‘çº¿è¡¨ç°å·®ã€‚å› æ­¤ï¼Œè¿™ä¸ªè·ç¦»å«åšæ”¯æŒå‘é‡æœºçš„é—´è·ï¼Œè€Œè¿™æ˜¯æ”¯æŒå‘é‡æœºå…·æœ‰é²æ£’æ€§çš„åŸå› ï¼Œå› ä¸ºå®ƒåŠªåŠ›ç”¨ä¸€ä¸ªæœ€å¤§é—´ è·æ¥åˆ†ç¦»æ ·æœ¬ã€‚å› æ­¤æ”¯æŒå‘é‡æœºæœ‰æ—¶è¢«ç§°ä¸ºå¤§é—´è·åˆ†ç±»å™¨ã€‚</p><p>æˆ‘ä»¬å°†è¿™ä¸ªå¤§é—´è·åˆ†ç±»å™¨ä¸­çš„æ­£åˆ™åŒ– å› å­å¸¸æ•°ğ¶è®¾ç½®çš„éå¸¸å¤§ï¼Œæˆ‘è®°å¾—æˆ‘å°†å…¶è®¾ç½®ä¸ºäº† 100000ï¼Œå› æ­¤å¯¹è¿™æ ·çš„ä¸€ä¸ªæ•°æ®é›†ï¼Œä¹Ÿè®¸ æˆ‘ä»¬å°†é€‰æ‹©è¿™æ ·çš„å†³ç­–ç•Œï¼Œä»è€Œæœ€å¤§é—´è·åœ°åˆ†ç¦»å¼€æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬ã€‚é‚£ä¹ˆåœ¨è®©ä»£ä»·å‡½æ•°æœ€å° åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾å‡ºåœ¨ğ‘¦ = 1å’Œğ‘¦ = 0ä¸¤ç§æƒ…å†µä¸‹éƒ½ä½¿å¾—ä»£ä»·å‡½æ•°ä¸­å·¦è¾¹çš„è¿™ä¸€é¡¹å°½é‡ ä¸ºé›¶çš„å‚æ•°ã€‚å¦‚æœæˆ‘ä»¬æ‰¾åˆ°äº†è¿™æ ·çš„å‚æ•°ï¼Œåˆ™æˆ‘ä»¬çš„æœ€å°åŒ–é—®é¢˜ä¾¿è½¬å˜æˆ:</p><script type="math/tex; mode=display">\min \frac{1}{2} \sum_{j=1}^{n} \theta_{j}^{2} \text { s.t }\left\{\begin{array}{c}\theta^{T} x^{(i)} \geq 1 \text { if } y^{(i)}=1 \\\theta^{T} x^{(i)} \leq-1 \text { if } y^{(i)}=0\end{array}\right.</script><p>äº‹å®ä¸Šï¼Œæ”¯æŒå‘é‡æœºç°åœ¨è¦æ¯”è¿™ä¸ªå¤§é—´è·åˆ†ç±»å™¨æ‰€ä½“ç°å¾—æ›´æˆç†Ÿï¼Œå°¤å…¶æ˜¯å½“ä½ ä½¿ç”¨å¤§é—´ è·åˆ†ç±»å™¨çš„æ—¶å€™ï¼Œä½ çš„å­¦ä¹ ç®—æ³•ä¼šå—å¼‚å¸¸ç‚¹ï¼ˆoutlierï¼‰ çš„å½±å“ã€‚æ¯”å¦‚æˆ‘ä»¬åŠ å…¥ä¸€ä¸ªé¢å¤–çš„æ­£æ ·æœ¬ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208172038.png" alt="image-20201208172018848"></p><p>åœ¨è¿™é‡Œï¼Œå¦‚æœä½ åŠ äº†è¿™ä¸ªæ ·æœ¬ï¼Œä¸ºäº†å°†æ ·æœ¬ç”¨æœ€å¤§é—´è·åˆ†å¼€ï¼Œä¹Ÿè®¸æˆ‘æœ€ç»ˆä¼šå¾—åˆ°ä¸€æ¡ç±»ä¼¼è¿™æ ·çš„å†³ç­–ç•Œï¼Œå°±æ˜¯è¿™æ¡ç²‰è‰²çš„çº¿ï¼Œä»…ä»…åŸºäºä¸€ä¸ªå¼‚å¸¸å€¼ï¼Œä»…ä»…åŸºäºä¸€ä¸ªæ ·æœ¬ï¼Œå°±å°†æˆ‘çš„å†³ç­–ç•Œä»è¿™æ¡é»‘çº¿å˜åˆ°è¿™æ¡ç²‰çº¿ï¼Œè¿™å®åœ¨æ˜¯ä¸æ˜æ™ºçš„ã€‚è€Œå¦‚æœæ­£åˆ™åŒ–å‚æ•°ğ¶ï¼Œè®¾ç½®çš„éå¸¸å¤§ï¼Œè¿™äº‹å®ä¸Šæ­£æ˜¯æ”¯æŒå‘é‡æœºå°†ä¼šåšçš„ã€‚å®ƒå°†å†³ç­–ç•Œï¼Œä»é»‘çº¿å˜åˆ°äº†ç²‰çº¿ï¼Œä½†æ˜¯å¦‚æœğ¶è®¾ç½®çš„å°ä¸€ç‚¹ï¼Œå¦‚æœä½ å°† C è®¾ç½®çš„ä¸è¦å¤ªå¤§ï¼Œåˆ™ä½ æœ€ç»ˆä¼šå¾—åˆ°è¿™æ¡é»‘çº¿ï¼Œå½“ç„¶æ•°æ®å¦‚æœä¸æ˜¯ çº¿æ€§å¯åˆ†çš„ï¼Œå¦‚æœä½ åœ¨è¿™é‡Œæœ‰ä¸€äº›æ­£æ ·æœ¬æˆ–è€…ä½ åœ¨è¿™é‡Œæœ‰ä¸€äº›è´Ÿæ ·æœ¬ï¼Œåˆ™æ”¯æŒå‘é‡æœºä¹Ÿä¼šå°† å®ƒä»¬æ°å½“åˆ†å¼€ã€‚å› æ­¤ï¼Œå¤§é—´è·åˆ†ç±»å™¨çš„æè¿°ï¼Œä»…ä»…æ˜¯ä»ç›´è§‚ä¸Šç»™å‡ºäº†æ­£åˆ™åŒ–å‚æ•°ğ¶éå¸¸å¤§çš„ æƒ…å½¢ï¼ŒåŒæ—¶ï¼Œè¦æé†’ä½ ğ¶çš„ä½œç”¨ç±»ä¼¼äº$1/ğœ†$ï¼Œ$ğœ†$æ˜¯æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨è¿‡çš„æ­£åˆ™åŒ–å‚æ•°ã€‚è¿™åªæ˜¯ğ¶é å¸¸å¤§çš„æƒ…å½¢ï¼Œæˆ–è€…ç­‰ä»·åœ° $ğœ†$ éå¸¸å°çš„æƒ…å½¢ã€‚ä½ æœ€ç»ˆä¼šå¾—åˆ°ç±»ä¼¼ç²‰çº¿è¿™æ ·çš„å†³ç­–ç•Œï¼Œä½†æ˜¯å® é™…ä¸Šåº”ç”¨æ”¯æŒå‘é‡æœºçš„æ—¶å€™ï¼Œå½“ğ¶ä¸æ˜¯éå¸¸éå¸¸å¤§çš„æ—¶å€™ï¼Œå®ƒå¯ä»¥å¿½ç•¥æ‰ä¸€äº›å¼‚å¸¸ç‚¹çš„å½±å“ï¼Œ å¾—åˆ°æ›´å¥½çš„å†³ç­–ç•Œã€‚ç”šè‡³å½“ä½ çš„æ•°æ®ä¸æ˜¯çº¿æ€§å¯åˆ†çš„æ—¶å€™ï¼Œæ”¯æŒå‘é‡æœºä¹Ÿå¯ä»¥ç»™å‡ºå¥½çš„ç»“æœã€‚</p><h2 id="3-æ ¸å‡½æ•°"><a href="#3-æ ¸å‡½æ•°" class="headerlink" title="3.æ ¸å‡½æ•°"></a>3.æ ¸å‡½æ•°</h2><p>å›é¡¾æˆ‘ä»¬ä¹‹å‰è®¨è®ºè¿‡å¯ä»¥ä½¿ç”¨é«˜çº§æ•°çš„å¤šé¡¹å¼æ¨¡å‹æ¥è§£å†³æ— æ³•ç”¨ç›´çº¿è¿›è¡Œåˆ†éš”çš„åˆ†ç±»é—®é¢˜:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209090403.png" alt="image-20201209090403405"></p><p>ä¸ºäº†è·å¾—ä¸Šå›¾æ‰€ç¤ºçš„åˆ¤å®šè¾¹ç•Œï¼Œæˆ‘ä»¬çš„æ¨¡å‹å¯èƒ½æ˜¯ $\theta_{0}+\theta_{1} x_{1}+\theta_{2} x_{2}+\theta_{3} x_{1} x_{2}+\theta_{4} x_{1}^{2}+\theta_{5} x_{2}^{2}+\cdots$ çš„å½¢å¼ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç³»åˆ—çš„æ–°çš„ç‰¹å¾ $\mathrm{f}$ æ¥æ›¿æ¢æ¨¡å‹ä¸­çš„æ¯ä¸€é¡¹ã€‚ä¾‹å¦‚ä»¤: $f_{1}=x_{1}, f_{2}=x_{2}, f_{3}=x_{1} x_{2}, f_{4}=x_{1}^{2}, f_{5}=x_{2}^{2}\ldots$å¾—åˆ° $h_{\theta}(x)=\theta_{1} f_{1}+\theta_{2} f_{2}+\ldots+\theta_{n} f_{n}$ ã€‚ç„¶è€Œï¼Œé™¤äº†å¯¹åŸæœ‰çš„ç‰¹å¾è¿›è¡Œç»„åˆä»¥å¤–ï¼Œæœ‰æ²¡æœ‰<br>æ›´å¥½çš„æ–¹æ³•æ¥æ„é€  $f_{1}, f_{2}, f_{3}$ ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ ¸å‡½æ•°æ¥è®¡ç®—å‡ºæ–°çš„ç‰¹å¾ã€‚</p><p>ç»™å®šä¸€ä¸ªè®­ç»ƒ å®ä¾‹ $x$, æˆ‘ä»¬åˆ© ç”¨ $x$ çš„å„ä¸ªç‰¹å¾ä¸æˆ‘ä»¬é¢„å…ˆé€‰å®šçš„åœ°æ ‡ï¼ˆlandmarksï¼‰ $l^{(1)}, l^{(2)}, l^{(3)}$ çš„è¿‘ä¼¼ç¨‹åº¦æ¥é€‰å–æ–°çš„ç‰¹å¾ $f_{1}, f_{2}, f_{3} $ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209090721.png" alt="image-20201209090721107"></p><p>ä¾‹å¦‚ï¼š</p><script type="math/tex; mode=display">f_{1}=\operatorname{similarity}\left(x, l^{(1)}\right)=exp\left(-\frac{\left\|x-l^{(1)}\right\|^{2}}{2 \sigma^{2}}\right)</script><p>å…¶ä¸­: </p><script type="math/tex; mode=display">\left\|x-l^{(1)}\right\|^{2}=\sum_{j=1}^{n}\left(x_{j}-l_{j}^{(1)}\right)^{2}</script><p>ä¸ºå®ä¾‹ $x$ ä¸­æ‰€æœ‰ç‰¹å¾ä¸åœ°æ ‡ $l^{(1)}$ ä¹‹é—´çš„è·ç¦»çš„å’Œã€‚ä¸Šä¾‹ä¸­çš„ $similarity\left(x, l^{(1)}\right)$ å°±æ˜¯æ ¸å‡½æ•°, å…·ä½“è€Œè¨€, è¿™é‡Œæ˜¯ä¸€ä¸ªé«˜æ–¯æ ¸å‡½æ•°ï¼ˆGaussian Kernelï¼‰ã€‚</p><p>è¿™äº›åœ°æ ‡çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?å¦‚æœä¸€ä¸ªè®­ç»ƒå®ä¾‹$ğ‘¥$ä¸åœ°æ ‡$ğ¿$ä¹‹é—´çš„è·ç¦»è¿‘ä¼¼äº 0ï¼Œåˆ™æ–°ç‰¹å¾ $ğ‘“$è¿‘ä¼¼äº$ğ‘’^{âˆ’0} = 1$ï¼Œå¦‚æœè®­ç»ƒå®ä¾‹$ğ‘¥$ä¸åœ°æ ‡$ğ¿$ä¹‹é—´è·ç¦»è¾ƒè¿œï¼Œåˆ™$ğ‘“$è¿‘ä¼¼äº$ğ‘’^{âˆ’(ä¸€ä¸ªè¾ƒå¤§çš„æ•°)} = 0$</p><p>å‡è®¾æˆ‘ä»¬çš„è®­ç»ƒå®ä¾‹å«æœ‰ä¸¤ä¸ªç‰¹å¾ $\left[x_{1} x_{2}\right],$ ç»™å®šåœ°æ ‡ $l^{(1)}$ ä¸ä¸åŒçš„ $\sigma$ å€¼ï¼Œè§ä¸‹å›¾:</p><script type="math/tex; mode=display">l^{(1)}=\left[\begin{array}{l}3 \\5\end{array}\right], \quad f_{1}=\exp \left(-\frac{\left\|x-l^{(1)}\right\|^{2}}{2 \sigma^{2}}\right)</script><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209091305.png" alt="image-20201209091305215"></p><p>å›¾ä¸­æ°´å¹³é¢çš„åæ ‡ä¸º $x_{1}, x_{2}$ è€Œå‚ç›´åæ ‡è½´ä»£è¡¨ $f ã€‚$ å¯ä»¥çœ‹å‡ºï¼Œåªæœ‰å½“ $x$ ä¸ $l^{(1)}$ é‡åˆæ—¶ $f$ æ‰å…·æœ‰æœ€å¤§å€¼ã€‚éšç€xçš„æ”¹å˜ $f$ å€¼æ”¹å˜çš„é€Ÿç‡å—åˆ° $\sigma^{2}$ çš„æ§åˆ¶ã€‚</p><p>åœ¨ä¸‹å›¾ä¸­ï¼Œå½“å®ä¾‹å¤„äºæ´‹çº¢è‰²çš„ç‚¹ä½ç½®å¤„ï¼Œå› ä¸ºå…¶ç¦» $l^{(1)}$ æ›´è¿‘ï¼Œä½†æ˜¯ç¦» $l^{(2)}$ å’Œ $l^{(3)}$ è¾ƒè¿œï¼Œå› æ­¤ $f_{1}$ æ¥è¿‘ 1ï¼Œè€Œ $f_{2}, f_{3}$ æ¥è¿‘ 0 ã€‚å› æ­¤ $h_{\theta}(x)=\theta_{0}+\theta_{1} f_{1}+\theta_{2} f_{2}+\theta_{1} f_{3}&gt;0,$ å› æ­¤é¢„æµ‹ $y=1$ ã€‚åŒç†å¯ä»¥æ±‚å‡ºï¼Œå¯¹äºç¦» $l^{(2)}$ è¾ƒè¿‘çš„ç»¿è‰²ç‚¹ï¼Œä¹Ÿé¢„æµ‹ $y=1$, ä½†æ˜¯å¯¹äºè“ç»¿è‰²çš„ç‚¹ï¼Œå› ä¸ºå…¶ç¦»ä¸‰ä¸ªåœ°æ ‡éƒ½è¾ƒè¿œï¼Œé¢„æµ‹ $y=0$ ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201209092707.png" alt="image-20201209092707947"></p><p>è¿™æ ·ï¼Œå›¾ä¸­çº¢è‰²çš„å°é—­æ›²çº¿æ‰€è¡¨ç¤ºçš„èŒƒå›´ï¼Œä¾¿æ˜¯æˆ‘ä»¬ä¾æ®ä¸€ä¸ªå•ä¸€çš„è®­ç»ƒå®ä¾‹å’Œæˆ‘ä»¬é€‰å–çš„åœ°æ ‡æ‰€å¾—å‡ºçš„åˆ¤å®šè¾¹ç•Œï¼Œåœ¨é¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„ç‰¹å¾ä¸æ˜¯è®­ç»ƒå®ä¾‹æœ¬èº«çš„ç‰¹å¾ï¼Œè€Œæ˜¯é€šè¿‡æ ¸å‡½æ•°è®¡ç®—å‡ºçš„æ–°ç‰¹å¾$f_1,f_2,f_3$ã€‚</p><h2 id="4-æ ¸å‡½æ•°-2"><a href="#4-æ ¸å‡½æ•°-2" class="headerlink" title="4.æ ¸å‡½æ•° 2"></a>4.æ ¸å‡½æ•° 2</h2><p>å¦‚ä½•é€‰æ‹©åœ°æ ‡?</p><p>æˆ‘ä»¬é€šå¸¸æ˜¯æ ¹æ®è®­ç»ƒé›†çš„æ•°é‡é€‰æ‹©åœ°æ ‡çš„æ•°é‡ï¼Œå³å¦‚æœè®­ç»ƒé›†ä¸­æœ‰mä¸ªå®ä¾‹ï¼Œåˆ™æˆ‘ä»¬é€‰å– $m$ ä¸ªåœ°æ ‡ï¼Œå¹¶ä¸”ä»¤: $l^{(1)}=x^{(1)}, l^{(2)}=x^{(2)}, \ldots ., l^{(m)}=x^{(m)} ã€‚$ è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼šç°åœ¨æˆ‘ä»¬å¾—åˆ°çš„æ–°ç‰¹å¾æ˜¯å»ºç«‹åœ¨åŸæœ‰ç‰¹å¾ä¸è®­ç»ƒé›†ä¸­æ‰€æœ‰å…¶ä»–ç‰¹å¾ä¹‹é—´è·ç¦»çš„åŸºç¡€ä¹‹ä¸Šçš„ï¼Œå³:</p><script type="math/tex; mode=display">f^{(i)}=\left[\begin{array}{c}f_{0}^{(i)}=1 \\f_{1}^{(i)}=\operatorname{sim}\left(x^{(i)}, l^{(1)}\right) \\f_{2}^{(i)}=\operatorname{sim}\left(x^{(i)}, l^{(2)}\right) \\f_{i}^{(i)}=\operatorname{sim}\left(x^{(i)}, l^{(i)}\right)=e^{0}=1 \\\vdots \\f_{m}^{(i)}=\operatorname{sim}\left(x^{(i)}, l^{(m)}\right)\end{array}\right]</script><p>ä¸‹é¢æˆ‘ä»¬å°†æ ¸å‡½æ•°è¿ç”¨åˆ°æ”¯æŒå‘é‡æœºä¸­ï¼Œä¿®æ”¹æˆ‘ä»¬çš„æ”¯æŒå‘é‡æœºå‡è®¾ä¸º:</p><ul><li>ç»™å®š $x,$ è®¡ç®—æ–°ç‰¹å¾ $f,$ å½“ $\theta^{T} f&gt;=0$ æ—¶ï¼Œé¢„æµ‹ $y=1,$ å¦åˆ™åä¹‹ã€‚ç›¸åº”åœ°ä¿®æ”¹ä»£ä»·å‡½æ•°ä¸º: </li></ul><script type="math/tex; mode=display">J(\theta)=\min C \sum_{i=1}^{m}\left[y^{(i)} \operatorname{cost}_{1}\left(\theta^{T} f^{(i)}\right)+\left(1-y^{(i)}\right) \operatorname{cost}_{0}\left(\theta^{T} f^{(i)}\right)\right]+\frac{1}{2} \sum_{j=1}^{n=m} \theta_{j}^{2}</script><p>åœ¨å…·ä½“å®æ–½è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹æœ€åçš„æ­£åˆ™åŒ–é¡¹è¿›è¡Œäº›å¾®è°ƒæ•´ï¼Œåœ¨è®¡ç®— $\sum_{j=1}^{n=m} \theta_{j}^{2}=\theta^{T} \theta$ æ—¶ï¼Œæˆ‘ä»¬ç”¨ $\theta^{T} M \theta$ ä»£æ›¿$\theta^{T} \theta,$ å…¶ä¸­ $M$ æ˜¯æ ¹æ®æˆ‘ä»¬é€‰æ‹©çš„æ ¸å‡½æ•°è€Œä¸åŒçš„ä¸€ä¸ªçŸ©é˜µã€‚è¿™æ ·åšçš„åŸå› æ˜¯ä¸ºäº†ç®€åŒ–è®¡ç®—ã€‚</p><p>æ”¯æŒå‘é‡æœºä¹Ÿå¯ä»¥ä¸ä½¿ç”¨æ ¸å‡½æ•°ï¼Œä¸ä½¿ç”¨æ ¸å‡½æ•°åˆç§°ä¸ºçº¿æ€§æ ¸å‡½æ•°ï¼ˆlinear kernelï¼‰ï¼Œ å½“æˆ‘ä»¬ä¸é‡‡ç”¨éå¸¸å¤æ‚çš„å‡½æ•°ï¼Œæˆ–è€…æˆ‘ä»¬çš„è®­ç»ƒé›†ç‰¹å¾éå¸¸å¤šè€Œå®ä¾‹éå¸¸å°‘çš„æ—¶å€™ï¼Œå¯ä»¥é‡‡ç”¨è¿™ç§ä¸å¸¦æ ¸å‡½æ•°çš„æ”¯æŒå‘é‡æœºã€‚</p><ul><li>ä¸‹é¢æ˜¯æ”¯æŒå‘é‡æœºçš„ä¸¤ä¸ªå‚æ•° $C$ å’Œ $\sigma$ çš„å½±å“:</li><li>$C=1 / \lambda$</li><li>$C$ è¾ƒå¤§æ—¶ï¼Œç›¸å½“äºå…¥è¾ƒå°ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆï¼Œé«˜æ–¹å·®;</li><li>$C$ è¾ƒå°æ—¶ï¼Œç›¸å½“äºå…¥è¾ƒå¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä½æ‹Ÿåˆï¼Œé«˜åå·®;</li><li>$\sigma$ è¾ƒå¤§æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä½æ–¹å·®ï¼Œé«˜åå·®;</li><li>$\sigma$ è¾ƒå°æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä½åå·®ï¼Œé«˜æ–¹å·®ã€‚</li></ul><h2 id="5-ä½¿ç”¨æ”¯æŒå‘é‡æœº"><a href="#5-ä½¿ç”¨æ”¯æŒå‘é‡æœº" class="headerlink" title="5.ä½¿ç”¨æ”¯æŒå‘é‡æœº"></a>5.ä½¿ç”¨æ”¯æŒå‘é‡æœº</h2><p>åœ¨é«˜æ–¯æ ¸å‡½æ•°ä¹‹å¤–æˆ‘ä»¬è¿˜æœ‰å…¶ä»–ä¸€äº›é€‰æ‹©ï¼Œå¦‚:</p><ul><li>å¤šé¡¹å¼æ ¸å‡½æ•°ï¼ˆPolynomial Kernelï¼‰</li><li>å­—ç¬¦ä¸²æ ¸å‡½æ•°ï¼ˆString kernelï¼‰</li><li>å¡æ–¹æ ¸å‡½æ•°ï¼ˆchi-square kernelï¼‰</li><li>ç›´æ–¹å›¾äº¤é›†æ ¸å‡½æ•°ï¼ˆhistogram intersection kernelï¼‰</li><li>ç­‰ç­‰</li></ul><p>å¤šç±»åˆ†ç±»é—®é¢˜ï¼š</p><p>å‡è®¾æˆ‘ä»¬åˆ©ç”¨ä¹‹å‰ä»‹ç»çš„ä¸€å¯¹å¤šæ–¹æ³•æ¥è§£å†³ä¸€ä¸ªå¤šç±»åˆ†ç±»é—®é¢˜ã€‚å¦‚æœä¸€å…±æœ‰ğ‘˜ä¸ªç±»ï¼Œåˆ™æˆ‘ä»¬éœ€è¦ğ‘˜ä¸ªæ¨¡å‹ï¼Œä»¥åŠğ‘˜ä¸ªå‚æ•°å‘é‡ğœƒã€‚æˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥è®­ç»ƒğ‘˜ä¸ªæ”¯æŒå‘é‡æœºæ¥è§£å†³å¤šç±»åˆ†ç±»é—®é¢˜ã€‚ä½†æ˜¯å¤§å¤šæ•°æ”¯æŒå‘é‡æœºè½¯ä»¶åŒ…éƒ½æœ‰å†…ç½®çš„å¤šç±»åˆ†ç±»åŠŸèƒ½ï¼Œæˆ‘ä»¬åªè¦ç›´æ¥ä½¿ç”¨å³å¯ã€‚</p><p>å°½ç®¡ä½ ä¸å»å†™ä½ è‡ªå·±çš„ SVM çš„ä¼˜åŒ–è½¯ä»¶ï¼Œä½†æ˜¯ä½ ä¹Ÿéœ€è¦åšå‡ ä»¶äº‹:</p><ol><li>æ˜¯æå‡ºå‚æ•°ğ¶çš„é€‰æ‹©ã€‚æˆ‘ä»¬åœ¨ä¹‹å‰çš„è§†é¢‘ä¸­è®¨è®ºè¿‡è¯¯å·®/æ–¹å·®åœ¨è¿™æ–¹é¢çš„æ€§è´¨ã€‚</li><li>ä½ ä¹Ÿéœ€è¦é€‰æ‹©å†…æ ¸å‚æ•°æˆ–ä½ æƒ³è¦ä½¿ç”¨çš„ç›¸ä¼¼å‡½æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªé€‰æ‹©æ˜¯:æˆ‘ä»¬é€‰æ‹©ä¸éœ€è¦ä»»ä½•å†…æ ¸å‚æ•°ï¼Œæ²¡æœ‰å†…æ ¸å‚æ•°çš„ç†å¿µï¼Œä¹Ÿå«çº¿æ€§æ ¸å‡½æ•°ã€‚å› æ­¤ï¼Œå¦‚æœæœ‰äººè¯´ä»–ä½¿ç”¨äº†çº¿æ€§æ ¸çš„ SVM(æ”¯æŒå‘é‡æœº)ï¼Œè¿™å°±æ„å‘³è¿™ä»–ä½¿ç”¨äº†ä¸å¸¦æœ‰æ ¸å‡½æ•°çš„ SVM(æ”¯æŒå‘é‡æœº)</li></ol><p>ä»é€»è¾‘å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ”¯æŒå‘é‡æœºæ¨¡å‹ï¼Œåœ¨ä¸¤è€…ä¹‹é—´ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©å‘¢?</p><p>ğ‘›ä¸ºç‰¹å¾æ•°ï¼Œğ‘šä¸ºè®­ç»ƒæ ·æœ¬æ•°ã€‚</p><ol><li>å¦‚æœç›¸è¾ƒäºğ‘šè€Œè¨€ï¼Œğ‘›è¦å¤§è®¸å¤šï¼Œå³è®­ç»ƒé›†æ•°æ®é‡ä¸å¤Ÿæ”¯æŒæˆ‘ä»¬è®­ç»ƒä¸€ä¸ªå¤æ‚çš„éçº¿æ€§æ¨¡å‹ï¼Œæˆ‘ä»¬é€‰ç”¨é€»è¾‘å›å½’æ¨¡å‹æˆ–è€…ä¸å¸¦æ ¸å‡½æ•°çš„æ”¯æŒå‘é‡æœºã€‚ </li><li>å¦‚æœğ‘›è¾ƒå°ï¼Œè€Œä¸”ğ‘šå¤§å°ä¸­ç­‰ï¼Œä¾‹å¦‚ğ‘›åœ¨ 1-1000 ä¹‹é—´ï¼Œè€Œğ‘šåœ¨ 10-10000 ä¹‹é—´ï¼Œä½¿ç”¨é«˜æ–¯æ ¸å‡½æ•°çš„æ”¯æŒå‘é‡æœºã€‚</li><li>å¦‚æœğ‘›è¾ƒå°ï¼Œè€Œğ‘šè¾ƒå¤§ï¼Œä¾‹å¦‚ğ‘›åœ¨ 1-1000 ä¹‹é—´ï¼Œè€Œğ‘šå¤§äº 50000ï¼Œåˆ™ä½¿ç”¨æ”¯æŒå‘é‡æœºä¼šéå¸¸æ…¢ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åˆ›é€ ã€å¢åŠ æ›´å¤šçš„ç‰¹å¾ï¼Œç„¶åä½¿ç”¨é€»è¾‘å›å½’æˆ–ä¸å¸¦æ ¸å‡½æ•°çš„æ”¯æŒå‘é‡æœºã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç¥ç»ç½‘ç»œåœ¨ä»¥ä¸Šä¸‰ç§æƒ…å†µä¸‹éƒ½å¯èƒ½ä¼šæœ‰è¾ƒå¥½çš„è¡¨ç°ï¼Œä½†æ˜¯è®­ç»ƒç¥ç»ç½‘ç»œå¯èƒ½éå¸¸æ…¢ï¼Œé€‰æ‹©æ”¯æŒå‘é‡æœºçš„åŸå› ä¸»è¦åœ¨äºå®ƒçš„ä»£ä»·å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œä¸å­˜åœ¨å±€éƒ¨æœ€å°å€¼ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> SVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>05_ç¥ç»ç½‘ç»œçš„å­¦ä¹ _Neural_Networksâ€”â€”Learning</title>
      <link href="2020/12/07/machinelearning/wu-en-da-ji-qi-xue-xi/05-neural-networks-learning/"/>
      <url>2020/12/07/machinelearning/wu-en-da-ji-qi-xue-xi/05-neural-networks-learning/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¥ç»ç½‘ç»œçš„å­¦ä¹ ï¼ˆNeural-Networks-Learningï¼‰"><a href="#ç¥ç»ç½‘ç»œçš„å­¦ä¹ ï¼ˆNeural-Networks-Learningï¼‰" class="headerlink" title="ç¥ç»ç½‘ç»œçš„å­¦ä¹ ï¼ˆNeural Networks: Learningï¼‰"></a>ç¥ç»ç½‘ç»œçš„å­¦ä¹ ï¼ˆNeural Networks: Learningï¼‰</h1><h2 id="1-ä»£ä»·å‡½æ•°-Cost-Function"><a href="#1-ä»£ä»·å‡½æ•°-Cost-Function" class="headerlink" title="1.ä»£ä»·å‡½æ•°-Cost Function"></a>1.ä»£ä»·å‡½æ•°-Cost Function</h2><p>å‡è®¾ç¥ç»ç½‘ç»œçš„è®­ç»ƒæ ·æœ¬æœ‰mä¸ªï¼Œæ¯ä¸ªåŒ…å«ä¸€ç»„è¾“å…¥xå’Œä¸€ç»„è¾“å‡ºä¿¡å·yï¼Œ $L$ è¡¨ç¤ºç¥ç»ç½‘ç»œå±‚æ•°, $S_{I}$ è¡¨ç¤ºæ¯å±‚çš„ neuron ä¸ªæ•° ï¼ˆ$S_{l}$ è¡¨ç¤ºè¾“å‡ºå±‚ç¥ç»å…ƒä¸ªæ•°ï¼‰ï¼Œ $S_{L}$ ä»£è¡¨æœ€åä¸€å±‚ä¸­å¤„ç†å•å…ƒçš„ä¸ªæ•°ã€‚</p><p>å°†ç¥ç»ç½‘ç»œçš„åˆ†ç±»å®šä¹‰ä¸ºä¸¤ç§æƒ…å†µï¼š</p><ul><li>äºŒç±»åˆ†ç±»: $S_{L}=0, y=0$ or 1è¡¨ç¤ºå“ªä¸€ç±»;</li><li>$K$ ç±»åˆ†ç±»: $S_{L}=k, y_{i}=1$ è¡¨ç¤ºåˆ†åˆ°ç¬¬ $\mathrm{i}$ ç±»; $(k&gt;2)$</li></ul><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207103355.png" alt="åˆ†ç±»ç¥ç»ç½‘ç»œ"></p><p>æˆ‘ä»¬å›é¡¾é€»è¾‘å›å½’é—®é¢˜ä¸­æˆ‘ä»¬çš„ä»£ä»·å‡½æ•°ä¸º:</p><script type="math/tex; mode=display">J(\theta)=-\frac{1}{m}\left[\sum_{j=1}^{n} y^{(i)} \log h_{\theta}\left(x^{(i)}\right)+\left(1-y^{(i)}\right) \log \left(1-h_{\theta}\left(x^{(i)}\right)\right)\right]+\frac{\lambda}{2 m} \sum_{j=1}^{n} \theta_{j}^{2}</script><p>åœ¨é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªè¾“å‡ºå˜é‡ï¼Œåˆç§°æ ‡é‡ï¼ˆscalarï¼‰ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªå› å˜é‡yï¼Œä½†æ˜¯åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰å¾ˆå¤šè¾“å‡ºå˜é‡, æˆ‘ä»¬çš„ $h_{\theta}(x)$ æ˜¯ä¸€ä¸ªç»´åº¦ä¸º $K$ çš„å‘é‡ï¼Œå¹¶ä¸”æˆ‘ä»¬è®­ç»ƒé›†ä¸­çš„å› å˜é‡ä¹Ÿæ˜¯åŒæ ·ç»´åº¦çš„ä¸€ä¸ªå‘é‡, å› æ­¤æˆ‘ä»¬çš„ä»£ä»·å‡½æ•°ä¼šæ¯”é€»è¾‘å›å½’æ›´åŠ å¤æ‚ä¸€äº›ï¼Œä¸º: $\quad h_{\theta}(x) \in \mathbb{R}^{K},\left(h_{\theta}(x)\right)_{i}=i^{t h}$ output</p><script type="math/tex; mode=display">\begin{array}{l}J(\Theta)=-\frac{1}{m}\left[\sum_{i=1}^{m} \sum_{k=1}^{k} y_{k}^{(i)} \log \left(h_{\Theta}\left(x^{(i)}\right)\right)_{k}+\left(1-y_{k}^{(i)}\right) \log \left(1-\left(h_{\Theta}\left(x^{(i)}\right)\right)_{k}\right)\right] \\+\frac{\lambda}{2 m} \sum_{l=1}^{L-1} \sum_{i=1}^{s_{l}} \sum_{j=1}^{s_{l}+1}\left(\Theta_{j i}^{(l)}\right)^{2}\end{array}</script><p>è¿™ä¸ªçœ‹èµ·æ¥å¤æ‚å¾ˆå¤šçš„ä»£ä»·å‡½æ•°èƒŒåçš„æ€æƒ³è¿˜æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡ä»£ä»·å‡½æ•°æ¥è§‚å¯Ÿ ç®—æ³•é¢„æµ‹çš„ç»“æœä¸çœŸå®æƒ…å†µçš„è¯¯å·®æœ‰å¤šå¤§ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå¯¹äºæ¯ä¸€è¡Œç‰¹å¾ï¼Œæˆ‘ä»¬éƒ½ä¼šç»™å‡º ğ¾ä¸ªé¢„æµ‹ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¾ªç¯ï¼Œå¯¹æ¯ä¸€è¡Œç‰¹å¾éƒ½é¢„æµ‹ğ¾ä¸ªä¸åŒç»“æœï¼Œç„¶ååœ¨åˆ©ç”¨å¾ªç¯ åœ¨ğ¾ä¸ªé¢„æµ‹ä¸­é€‰æ‹©å¯èƒ½æ€§æœ€é«˜çš„ä¸€ä¸ªï¼Œå°†å…¶ä¸ğ‘¦ä¸­çš„å®é™…æ•°æ®è¿›è¡Œæ¯”è¾ƒã€‚</p><p>æ­£åˆ™åŒ–çš„é‚£ä¸€é¡¹åªæ˜¯æ’é™¤äº†æ¯ä¸€å±‚ $\theta_{0}$ åï¼Œæ¯ä¸€å±‚çš„ $\theta$ çŸ©é˜µçš„å’Œã€‚æœ€é‡Œå±‚çš„å¾ªç¯jå¾ªç¯æ‰€æœ‰çš„è¡Œï¼ˆç”± $s_{l}+1$ å±‚çš„æ¿€æ´»å•å…ƒæ•°å†³å®šï¼‰ï¼Œå¾ªç¯iåˆ™å¾ªç¯æ‰€æœ‰çš„åˆ—ï¼Œç”±è¯¥å±‚ï¼ˆ $s_{l}$ å±‚ï¼‰çš„æ¿€æ´»å•å…ƒæ•°æ‰€å†³å®šã€‚å³ $: h_{\theta}(x)$ ä¸çœŸå®å€¼ä¹‹é—´çš„è·ç¦»ä¸ºæ¯ä¸ªæ ·æœ¬-æ¯ä¸ªç±»è¾“å‡ºçš„åŠ å’Œï¼Œå¯¹å‚æ•°è¿›è¡Œregularization çš„ bias é¡¹å¤„ç†æ‰€æœ‰å‚æ•°çš„å¹³æ–¹å’Œã€‚</p><h2 id="2-åå‘ä¼ æ’­ç®—æ³•ï¼ˆBackpropagation-Algorithmï¼‰"><a href="#2-åå‘ä¼ æ’­ç®—æ³•ï¼ˆBackpropagation-Algorithmï¼‰" class="headerlink" title="2.åå‘ä¼ æ’­ç®—æ³•ï¼ˆBackpropagation Algorithmï¼‰"></a>2.åå‘ä¼ æ’­ç®—æ³•ï¼ˆBackpropagation Algorithmï¼‰</h2><p>ç°åœ¨ï¼Œä¸ºäº†è®¡ç®—ä»£ä»·å‡½æ•°çš„åå¯¼æ•° $\frac{\partial}{\partial \theta_{i j}^{(l)}} J(\Theta),$ æˆ‘ä»¬éœ€è¦é‡‡ç”¨ä¸€ç§åå‘ä¼ æ’­ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯é¦–å…ˆè®¡ç®—æœ€åä¸€å±‚çš„è¯¯å·®ï¼Œç„¶åå†ä¸€å±‚ä¸€å±‚åå‘æ±‚å‡ºå„å±‚çš„è¯¯å·®ï¼Œç›´åˆ°å€’æ•°ç¬¬äºŒå±‚ã€‚ ä»¥ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜åå‘ä¼ æ’­ç®—æ³•ã€‚å‡è®¾æˆ‘ä»¬çš„è®­ç»ƒé›†åªæœ‰ä¸€ä¸ªå®ä¾‹ $\left(x^{(1)}, y^{(1)}\right),$ æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œæ˜¯ä¸€ä¸ªå››å±‚çš„ç¥ç»ç½‘ç»œ,å…¶ä¸­ $K=4, S_{L}=4, L=4$</p><p>å‰å‘ä¼ æ’­ç®—æ³•:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207162444.png" alt="Forward propagation"></p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207161326.png" alt="Forward propagation"></p><p>æˆ‘ä»¬ä»æœ€åä¸€å±‚çš„è¯¯å·®å¼€å§‹è®¡ç®—ï¼Œè¯¯å·®æ˜¯æ¿€æ´»å•å…ƒçš„é¢„æµ‹ï¼ˆ $a_{k}^{(4)}$ï¼‰ ä¸å®é™…å€¼ï¼ˆ $y^{k}$ ï¼‰ä¹‹é—´çš„è¯¯å·®ï¼Œ($ğ‘˜ = 1: ğ‘˜$)ã€‚</p><p>æˆ‘ä»¬ç”¨ $\delta$ æ¥è¡¨ç¤ºè¯¯å·®ï¼Œåˆ™ $: \delta^{(4)}=a^{(4)}-y$<br>æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªè¯¯å·®å€¼æ¥è®¡ç®—å‰ä¸€å±‚çš„è¯¯å·®: </p><script type="math/tex; mode=display">\delta^{(3)}=\left(\Theta^{(3)}\right)^{T} \delta^{(4)} * g^{\prime}\left(z^{(3)}\right)</script><p>å…¶ä¸­ </p><script type="math/tex; mode=display">g^{\prime}\left(z^{(3)}\right)</script><p>æ˜¯ $S$ å½¢å‡½æ•°çš„å¯¼æ•°ï¼Œ </p><script type="math/tex; mode=display">g^{\prime}\left(z^{(3)}\right)=a^{(3)} *\left(1-a^{(3)}\right)</script><p>è€Œ </p><script type="math/tex; mode=display">\left(\theta^{(3)}\right)^{T} \delta^{(4)}</script><p>åˆ™æ˜¯æƒé‡å¯¼è‡´çš„è¯¯å·®çš„å’Œã€‚ä¸‹ä¸€æ­¥æ˜¯ç»§ç»­è®¡ç®—ç¬¬äºŒå±‚çš„è¯¯å·®: </p><script type="math/tex; mode=display">\quad \delta^{(2)}=\left(\Theta^{(2)}\right)^{T} \delta^{(3)} * g^{\prime}\left(z^{(2)}\right)</script><p>å› ä¸ºç¬¬ä¸€å±‚æ˜¯è¾“å…¥å˜é‡ï¼Œä¸å­˜åœ¨è¯¯å·®ã€‚æˆ‘ä»¬æœ‰äº†æ‰€æœ‰çš„è¯¯å·®çš„è¡¨è¾¾å¼åï¼Œä¾¿å¯ä»¥è®¡ç®—ä»£ä»·å‡½æ•°çš„åå¯¼æ•°äº†, å‡è®¾ $\lambda=0$, å³æˆ‘ä»¬ä¸åšä»»ä½•æ­£åˆ™åŒ–å¤„ç†æ—¶æœ‰: $\frac{\partial}{\partial \theta_{i j}^{(l)}} J(\Theta)=a_{j}^{(l)} \delta_{i}^{l+1}$é‡è¦çš„æ˜¯æ¸…æ¥šåœ°çŸ¥é“ä¸Šé¢å¼å­ä¸­ä¸Šä¸‹æ ‡çš„å«ä¹‰:</p><ul><li><p>$ğ‘™$ ä»£è¡¨ç›®å‰æ‰€è®¡ç®—çš„æ˜¯ç¬¬å‡ å±‚ã€‚</p></li><li><p>$ğ‘—$ä»£è¡¨ç›®å‰è®¡ç®—å±‚ä¸­çš„æ¿€æ´»å•å…ƒçš„ä¸‹æ ‡ï¼Œä¹Ÿå°†æ˜¯ä¸‹ä¸€å±‚çš„ç¬¬$ğ‘—$ä¸ªè¾“å…¥å˜é‡çš„ä¸‹æ ‡ã€‚</p></li><li><p>$ğ‘–$ä»£è¡¨ä¸‹ä¸€å±‚ä¸­è¯¯å·®å•å…ƒçš„ä¸‹æ ‡ï¼Œæ˜¯å—åˆ°æƒé‡çŸ©é˜µä¸­ç¬¬$ğ‘–$è¡Œå½±å“çš„ä¸‹ä¸€å±‚ä¸­çš„è¯¯å·®å•å…ƒçš„ä¸‹æ ‡ã€‚</p></li></ul><p>å¦‚æœæˆ‘ä»¬è€ƒè™‘æ­£åˆ™åŒ–å¤„ç†ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„è®­ç»ƒé›†æ˜¯ä¸€ä¸ªç‰¹å¾çŸ©é˜µè€Œéå‘é‡ã€‚åœ¨ä¸Šé¢çš„ç‰¹æ®Šæƒ…å†µä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ¯ä¸€å±‚çš„è¯¯å·®å•å…ƒæ¥è®¡ç®—ä»£ä»·å‡½æ•°çš„åå¯¼æ•°ã€‚åœ¨æ›´ä¸ºä¸€èˆ¬çš„æƒ…å†µä¸­ï¼Œ æˆ‘ä»¬åŒæ ·éœ€è¦è®¡ç®—æ¯ä¸€å±‚çš„è¯¯å·®å•å…ƒï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦ä¸ºæ•´ä¸ªè®­ç»ƒé›†è®¡ç®—è¯¯å·®å•å…ƒï¼Œæ­¤æ—¶çš„è¯¯å·®å•å…ƒä¹Ÿæ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œæˆ‘ä»¬ç”¨ $\Delta_{i j}^{(l)}$ æ¥è¡¨ç¤ºè¿™ä¸ªè¯¯å·®çŸ©é˜µã€‚ç¬¬ $l$ å±‚çš„ç¬¬ $i$ ä¸ªæ¿€æ´»å•å…ƒå—åˆ°ç¬¬ $j$ä¸ªå‚æ•°å½±å“è€Œå¯¼è‡´çš„è¯¯å·®ã€‚</p><p>æˆ‘ä»¬çš„ç®—æ³•è¡¨ç¤ºä¸º:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207161945.png" alt="ç®—æ³•"></p><p>å³é¦–å…ˆç”¨æ­£å‘ä¼ æ’­æ–¹æ³•è®¡ç®—å‡ºæ¯ä¸€å±‚çš„æ¿€æ´»å•å…ƒ,åˆ©ç”¨è®­ç»ƒé›†çš„ç»“æœä¸ç¥ç»ç½‘ç»œé¢„æµ‹çš„ç»“æœæ±‚å‡ºæœ€åä¸€å±‚çš„è¯¯å·®ï¼Œç„¶ååˆ©ç”¨è¯¥è¯¯å·®è¿ç”¨åå‘ä¼ æ’­æ³•è®¡ç®—å‡ºç›´è‡³ç¬¬äºŒå±‚çš„æ‰€æœ‰è¯¯å·®ã€‚åœ¨æ±‚å‡ºäº† $\Delta_{i j}^{(l)}$ ä¹‹åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥è®¡ç®—ä»£ä»·å‡½æ•°çš„åå¯¼æ•°äº†ï¼Œè®¡ç®—æ–¹æ³•å¦‚ä¸‹:</p><script type="math/tex; mode=display">\begin{array}{l}D_{i j}^{(l)}:=\frac{1}{m} \Delta_{i j}^{(l)}+\lambda \theta_{i j}^{(l)} \text { if } j \neq 0 \\D_{i j}^{(l)}:=\frac{1}{m} \Delta_{i j}^{(l)} \text { if } j=0\end{array}</script><h2 id="3-åå‘ä¼ æ’­ç®—æ³•çš„ç›´è§‚ç†è§£"><a href="#3-åå‘ä¼ æ’­ç®—æ³•çš„ç›´è§‚ç†è§£" class="headerlink" title="3.åå‘ä¼ æ’­ç®—æ³•çš„ç›´è§‚ç†è§£"></a>3.åå‘ä¼ æ’­ç®—æ³•çš„ç›´è§‚ç†è§£</h2><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207164455.png" alt="Forward propagation"></p><p>åå‘ä¼ æ’­ç®—æ³•åšçš„æ˜¯:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207164521.png" alt="Back propagation"></p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207164616.png" alt="Back propagation"></p><h2 id="4-æ¢¯åº¦æ£€æµ‹"><a href="#4-æ¢¯åº¦æ£€æµ‹" class="headerlink" title="4.æ¢¯åº¦æ£€æµ‹"></a>4.æ¢¯åº¦æ£€æµ‹</h2><p>å½“æˆ‘ä»¬å¯¹ä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„æ¨¡å‹ï¼ˆä¾‹å¦‚ç¥ç»ç½‘ç»œï¼‰ä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æ—¶ï¼Œå¯èƒ½ä¼šå­˜åœ¨ä¸€äº› ä¸å®¹æ˜“å¯Ÿè§‰çš„é”™è¯¯ï¼Œæ„å‘³ç€ï¼Œè™½ç„¶ä»£ä»·çœ‹ä¸Šå»åœ¨ä¸æ–­å‡å°ï¼Œä½†æœ€ç»ˆçš„ç»“æœå¯èƒ½å¹¶ä¸æ˜¯æœ€ä¼˜è§£ã€‚</p><p>ä¸ºäº†é¿å…è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡å–ä¸€ç§å«åšæ¢¯åº¦çš„æ•°å€¼æ£€éªŒï¼ˆNumerical Gradient Checkingï¼‰æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•çš„æ€æƒ³æ˜¯é€šè¿‡ä¼°è®¡æ¢¯åº¦å€¼æ¥æ£€éªŒæˆ‘ä»¬è®¡ç®—çš„å¯¼æ•°å€¼æ˜¯å¦çœŸçš„æ˜¯æˆ‘ä»¬è¦æ±‚çš„ã€‚</p><p>å¯¹æ¢¯åº¦çš„ä¼°è®¡é‡‡ç”¨çš„æ–¹æ³•æ˜¯åœ¨ä»£ä»·å‡½æ•°ä¸Šæ²¿ç€åˆ‡çº¿çš„æ–¹å‘é€‰æ‹©ç¦»ä¸¤ä¸ªéå¸¸è¿‘çš„ç‚¹ç„¶åè®¡ç®—ä¸¤ä¸ªç‚¹çš„å¹³å‡å€¼ç”¨ä»¥ä¼°è®¡æ¢¯åº¦ã€‚å³å¯¹äºæŸä¸ªç‰¹å®šçš„ $\theta,$ æˆ‘ä»¬è®¡ç®—å‡ºåœ¨ $\theta-\varepsilon$ å¤„å’Œ $\theta+\varepsilon$ çš„ä»£ä»·å€¼ $(\varepsilon$ æ˜¯ä¸€ä¸ªéå¸¸å°çš„å€¼ï¼Œé€šå¸¸é€‰å– 0.001$)$ ï¼Œç„¶åæ±‚ä¸¤ä¸ªä»£ä»·çš„å¹³å‡ï¼Œç”¨ä»¥ä¼°è®¡åœ¨ $\theta$å¤„çš„ä»£ä»·å€¼ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201208153537.png" alt="image-20201208153537013"></p><p>å½“ $\theta$ æ˜¯ä¸€ä¸ªå‘é‡æ—¶ï¼Œæˆ‘ä»¬åˆ™éœ€è¦å¯¹åå¯¼æ•°è¿›è¡Œæ£€éªŒã€‚å› ä¸ºä»£ä»·å‡½æ•°çš„åå¯¼æ•°æ£€éªŒåªé’ˆå¯¹ä¸€ä¸ªå‚æ•°çš„æ”¹å˜è¿›è¡Œæ£€éªŒï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªåªé’ˆå¯¹ $\theta_{1}$ è¿›è¡Œæ£€éªŒçš„ç¤ºä¾‹:</p><script type="math/tex; mode=display">\frac{\partial}{\partial \theta_{1}}=\frac{J\left(\theta_{1}+\varepsilon_{1}, \theta_{2}, \theta_{3} \ldots \theta_{n}\right)-J\left(\theta_{1}-\varepsilon_{1}, \theta_{2}, \theta_{3} \ldots \theta_{n}\right)}{2 \varepsilon}</script><p>æ ¹æ®ä¸Šé¢çš„ç®—æ³•ï¼Œè®¡ç®—å‡ºçš„åå¯¼æ•°å­˜å‚¨åœ¨çŸ©é˜µ $D_{i j}^{(l)}$ ä¸­ã€‚æ£€éªŒæ—¶ï¼Œæˆ‘ä»¬è¦å°†è¯¥çŸ©é˜µå±•å¼€æˆä¸ºå‘é‡ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå°† $\theta$ çŸ©é˜µå±•å¼€ä¸ºå‘é‡ï¼Œæˆ‘ä»¬é’ˆå¯¹æ¯ä¸€ä¸ª $\theta$ éƒ½è®¡ç®—ä¸€ä¸ªè¿‘ä¼¼çš„æ¢¯åº¦å€¼ï¼Œå°†è¿™äº›å€¼å­˜å‚¨äºä¸€ä¸ªè¿‘ä¼¼æ¢¯åº¦çŸ©é˜µä¸­ï¼Œæœ€ç»ˆå°†å¾—å‡ºçš„è¿™ä¸ªçŸ©é˜µåŒ $D_{i j}^{(l)}$ è¿›è¡Œæ¯”è¾ƒã€‚</p><h2 id="5-éšæœºåˆå§‹åŒ–"><a href="#5-éšæœºåˆå§‹åŒ–" class="headerlink" title="5.éšæœºåˆå§‹åŒ–"></a>5.éšæœºåˆå§‹åŒ–</h2><p>ä»»ä½•ä¼˜åŒ–ç®—æ³•éƒ½éœ€è¦ä¸€äº›åˆå§‹çš„å‚æ•°ã€‚åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬éƒ½æ˜¯åˆå§‹æ‰€æœ‰å‚æ•°ä¸º 0ï¼Œè¿™æ ·çš„ åˆå§‹æ–¹æ³•å¯¹äºé€»è¾‘å›å½’æ¥è¯´æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å¯¹äºç¥ç»ç½‘ç»œæ¥è¯´æ˜¯ä¸å¯è¡Œçš„ã€‚å¦‚æœæˆ‘ä»¬ä»¤æ‰€æœ‰ çš„åˆå§‹å‚æ•°éƒ½ä¸º 0ï¼Œè¿™å°†æ„å‘³ç€æˆ‘ä»¬ç¬¬äºŒå±‚çš„æ‰€æœ‰æ¿€æ´»å•å…ƒéƒ½ä¼šæœ‰ç›¸åŒçš„å€¼ã€‚åŒç†ï¼Œå¦‚æœæˆ‘ ä»¬åˆå§‹æ‰€æœ‰çš„å‚æ•°éƒ½ä¸ºä¸€ä¸ªé 0 çš„æ•°ï¼Œç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬é€šå¸¸åˆå§‹å‚æ•°ä¸ºæ­£è´Ÿğœ€ä¹‹é—´çš„éšæœºå€¼ã€‚</p><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h2><p> å°ç»“ä¸€ä¸‹ä½¿ç”¨ç¥ç»ç½‘ç»œæ—¶çš„æ­¥éª¤:</p><p>ç½‘ç»œç»“æ„:ç¬¬ä¸€ä»¶è¦åšçš„äº‹æ˜¯é€‰æ‹©ç½‘ç»œç»“æ„ï¼Œå³å†³å®šé€‰æ‹©å¤šå°‘å±‚ä»¥åŠå†³å®šæ¯å±‚åˆ†åˆ«æœ‰å¤šå°‘ä¸ªå•å…ƒã€‚ç¬¬ä¸€å±‚çš„å•å…ƒæ•°å³æˆ‘ä»¬è®­ç»ƒé›†çš„ç‰¹å¾æ•°é‡ã€‚ æœ€åä¸€å±‚çš„å•å…ƒæ•°æ˜¯æˆ‘ä»¬è®­ç»ƒé›†çš„ç»“æœçš„ç±»çš„æ•°é‡ã€‚å¦‚æœéšè—å±‚æ•°å¤§äº 1ï¼Œç¡®ä¿æ¯ä¸ªéšè—å±‚çš„å•å…ƒä¸ªæ•°ç›¸åŒï¼Œé€šå¸¸æƒ…å†µä¸‹éšè—å±‚å•å…ƒçš„ä¸ªæ•°è¶Šå¤šè¶Šå¥½ã€‚æˆ‘ä»¬çœŸæ­£è¦å†³å®šçš„æ˜¯éšè—å±‚çš„å±‚æ•°å’Œæ¯ä¸ªä¸­é—´å±‚çš„å•å…ƒæ•°ã€‚</p><p>è®­ç»ƒç¥ç»ç½‘ç»œ:</p><ul><li>å‚æ•°çš„éšæœºåˆå§‹åŒ–</li><li>åˆ©ç”¨æ­£å‘ä¼ æ’­æ–¹æ³•è®¡ç®—æ‰€æœ‰çš„hğœƒ (ğ‘¥)</li><li>ç¼–å†™è®¡ç®—ä»£ä»·å‡½æ•° ğ½ çš„ä»£ç </li><li>åˆ©ç”¨åå‘ä¼ æ’­æ–¹æ³•è®¡ç®—æ‰€æœ‰åå¯¼æ•°</li><li>åˆ©ç”¨æ•°å€¼æ£€éªŒæ–¹æ³•æ£€éªŒè¿™äº›åå¯¼æ•°</li><li>ä½¿ç”¨ä¼˜åŒ–ç®—æ³•æ¥æœ€å°åŒ–ä»£ä»·å‡½æ•°</li></ul>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> ç¥ç»ç½‘ç»œ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>04_ç¥ç»ç½‘ç»œ_Neura_ Network</title>
      <link href="2020/12/06/machinelearning/wu-en-da-ji-qi-xue-xi/04-neural-networks/"/>
      <url>2020/12/06/machinelearning/wu-en-da-ji-qi-xue-xi/04-neural-networks/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¥ç»ç½‘ç»œNeural-Network"><a href="#ç¥ç»ç½‘ç»œNeural-Network" class="headerlink" title="ç¥ç»ç½‘ç»œNeural Network"></a>ç¥ç»ç½‘ç»œNeural Network</h1><h2 id="1-éçº¿æ€§å‡è®¾"><a href="#1-éçº¿æ€§å‡è®¾" class="headerlink" title="1.éçº¿æ€§å‡è®¾"></a>1.éçº¿æ€§å‡è®¾</h2><p>çº¿æ€§å›å½’è¿˜æ˜¯é€»è¾‘å›å½’éƒ½æœ‰è¿™æ ·ä¸€ä¸ªç¼ºç‚¹ï¼Œå³:å½“ç‰¹å¾å¤ªå¤šæ—¶ï¼Œ è®¡ç®—çš„è´Ÿè·ä¼šéå¸¸å¤§ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206183433.png" alt="ç¤ºä¾‹å›¾"></p><p>ä¹‹å‰æˆ‘ä»¬å·²ç»çœ‹åˆ°è¿‡ï¼Œä½¿ç”¨éçº¿æ€§çš„å¤šé¡¹å¼é¡¹ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å»ºç«‹æ›´å¥½çš„åˆ†ç±»æ¨¡å‹ã€‚å‡è®¾æˆ‘ä»¬æœ‰éå¸¸å¤šçš„ç‰¹å¾, ä¾‹å¦‚å¤§äº 100 ä¸ªå˜é‡, æˆ‘ä»¬å¸Œæœ›ç”¨è¿™ 100 ä¸ªç‰¹å¾æ¥æ„å»ºä¸€ä¸ªéçº¿æ€§çš„å¤šé¡¹å¼æ¨¡å‹, ç»“æœå°†æ˜¯æ•°é‡éå¸¸æƒŠäººçš„ç‰¹å¾ç»„åˆ, å³ä¾¿æˆ‘ä»¬åªé‡‡ç”¨ä¸¤ä¸¤ç‰¹å¾çš„ç»„åˆ $\left(x_{1} x_{2}+\right.\left.x_{1} x_{3}+x_{1} x_{4}+\ldots+x_{2} x_{3}+x_{2} x_{4}+\ldots+x_{99} x_{100}\right),$ æˆ‘ä»¬ä¹Ÿä¼šæœ‰æ¥è¿‘ 5000 ä¸ªç»„åˆè€Œæˆçš„ç‰¹å¾ã€‚è¿™å¯¹äºä¸€èˆ¬çš„é€»è¾‘å›å½’æ¥è¯´éœ€è¦è®¡ç®—çš„ç‰¹å¾å¤ªå¤šäº†ã€‚</p><p>å‡è®¾æˆ‘ä»¬å¸Œæœ›è®­ç»ƒä¸€ä¸ªæ¨¡å‹æ¥è¯†åˆ«è§†è§‰å¯¹è±¡ï¼ˆä¾‹å¦‚è¯†åˆ«ä¸€å¼ å›¾ç‰‡ä¸Šæ˜¯å¦æ˜¯ä¸€è¾†æ±½è½¦ï¼‰ï¼Œ æˆ‘ä»¬æ€æ ·æ‰èƒ½è¿™ä¹ˆåšå‘¢?ä¸€ç§æ–¹æ³•æ˜¯æˆ‘ä»¬åˆ©ç”¨å¾ˆå¤šæ±½è½¦çš„å›¾ç‰‡å’Œå¾ˆå¤šéæ±½è½¦çš„å›¾ç‰‡ï¼Œç„¶ååˆ©ç”¨è¿™äº›å›¾ç‰‡ä¸Šä¸€ä¸ªä¸ªåƒç´ çš„å€¼ï¼ˆé¥±å’Œåº¦æˆ–äº®åº¦ï¼‰æ¥ä½œä¸ºç‰¹å¾ã€‚</p><p>å‡å¦‚æˆ‘ä»¬åªé€‰ç”¨ç°åº¦å›¾ç‰‡ï¼Œæ¯ä¸ªåƒç´ åˆ™åªæœ‰ä¸€ä¸ªå€¼ï¼ˆè€Œé RGB å€¼ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€‰å–å›¾ç‰‡ä¸Šçš„ä¸¤ä¸ªä¸åŒä½ç½®ä¸Šçš„ä¸¤ä¸ªåƒç´ ï¼Œç„¶åè®­ç»ƒä¸€ä¸ªé€»è¾‘å›å½’ç®—æ³•åˆ©ç”¨è¿™ä¸¤ä¸ªåƒç´ çš„å€¼æ¥åˆ¤æ–­å›¾ç‰‡ä¸Šæ˜¯å¦æ˜¯æ±½è½¦:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206183716.png" alt="æ±½è½¦è¯†åˆ«"></p><p>å‡ä½¿æˆ‘ä»¬é‡‡ç”¨çš„éƒ½æ˜¯ 50x50 åƒç´ çš„å°å›¾ç‰‡ï¼Œå¹¶ä¸”æˆ‘ä»¬å°†æ‰€æœ‰çš„åƒç´ è§†ä¸ºç‰¹å¾ï¼Œåˆ™ä¼šæœ‰ 2500 ä¸ªç‰¹å¾ï¼Œå¦‚æœæˆ‘ä»¬è¦è¿›ä¸€æ­¥å°†ä¸¤ä¸¤ç‰¹å¾ç»„åˆæ„æˆä¸€ä¸ªå¤šé¡¹å¼æ¨¡å‹ï¼Œåˆ™ä¼šæœ‰çº¦25002/2ä¸ª ï¼ˆæ¥è¿‘ 3 ç™¾ä¸‡ä¸ªï¼‰ç‰¹å¾ã€‚æ™®é€šçš„é€»è¾‘å›å½’æ¨¡å‹ï¼Œä¸èƒ½æœ‰æ•ˆåœ°å¤„ç†è¿™ä¹ˆå¤šçš„ç‰¹å¾ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ç¥ç»ç½‘ç»œã€‚</p><h2 id="2-æ¨¡å‹è¡¨ç¤º-1"><a href="#2-æ¨¡å‹è¡¨ç¤º-1" class="headerlink" title="2.æ¨¡å‹è¡¨ç¤º 1"></a>2.æ¨¡å‹è¡¨ç¤º 1</h2><p>ä¸ºäº†æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆæ€è€ƒå¤§è„‘ä¸­çš„ç¥ç»ç½‘ç»œæ˜¯æ€æ ·çš„?æ¯ä¸€ä¸ªç¥ç»å…ƒ éƒ½å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå¤„ç†å•å…ƒ/ç¥ç»æ ¸ï¼ˆprocessing unit/Nucleusï¼‰ï¼Œå®ƒå«æœ‰è®¸å¤šè¾“å…¥/æ ‘çª ï¼ˆinput/Dendriteï¼‰ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªè¾“å‡º/è½´çªï¼ˆoutput/Axonï¼‰ã€‚ç¥ç»ç½‘ç»œæ˜¯å¤§é‡ç¥ç»å…ƒç›¸äº’é“¾ æ¥å¹¶é€šè¿‡ç”µè„‰å†²æ¥äº¤æµçš„ä¸€ä¸ªç½‘ç»œã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206223440.png" alt="äººä½“ç¥ç»ç½‘ç»œå›¾"></p><p>ç¥ç»ç½‘ç»œæ¨¡å‹å»ºç«‹åœ¨å¾ˆå¤šç¥ç»å…ƒä¹‹ä¸Šï¼Œæ¯ä¸€ä¸ªç¥ç»å…ƒåˆæ˜¯ä¸€ä¸ªä¸ªå­¦ä¹ æ¨¡å‹ã€‚è¿™äº›ç¥ç»å…ƒ ï¼ˆä¹Ÿå«æ¿€æ´»å•å…ƒï¼Œactivation unitï¼‰é‡‡çº³ä¸€äº›ç‰¹å¾ä½œä¸ºè¾“å‡ºï¼Œå¹¶ä¸”æ ¹æ®æœ¬èº«çš„æ¨¡å‹æä¾›ä¸€ä¸ªè¾“å‡ºã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªä»¥é€»è¾‘å›å½’æ¨¡å‹ä½œä¸ºè‡ªèº«å­¦ä¹ æ¨¡å‹çš„ç¥ç»å…ƒç¤ºä¾‹ï¼Œåœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œå‚æ•°åˆå¯ è¢«æˆä¸ºæƒé‡ï¼ˆweightï¼‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206184747.png" alt="ç¥ç»å…ƒç¤ºä¾‹"></p><p>æˆ‘ä»¬è®¾è®¡å‡ºäº†ç±»ä¼¼äºç¥ç»å…ƒçš„ç¥ç»ç½‘ç»œï¼Œæ•ˆæœå¦‚ä¸‹:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206223511.png" alt="ç¥ç»ç½‘ç»œæ¨¡å‹"></p><p>å…¶ä¸­ $x_{1}, x_{2}, x_{3}$ æ˜¯è¾“å…¥å•å…ƒï¼ˆinput unitsï¼‰ï¼Œæˆ‘ä»¬å°†åŸå§‹æ•°æ®è¾“å…¥ç»™å®ƒä»¬ã€‚$a_{1}, a_{2}, a_{3}$ æ˜¯ä¸­é—´å•å…ƒï¼Œå®ƒä»¬è´Ÿè´£å°†æ•°æ®è¿›è¡Œå¤„ç†ï¼Œç„¶åå‘ˆé€’åˆ°ä¸‹ä¸€å±‚ã€‚æœ€åæ˜¯è¾“å‡ºå•å…ƒï¼Œå®ƒè´Ÿè´£è®¡ç®— $h_{\theta}(x)$ ã€‚</p><p>ç¥ç»ç½‘ç»œæ¨¡å‹æ˜¯è®¸å¤šé€»è¾‘å•å…ƒæŒ‰ç…§ä¸åŒå±‚çº§ç»„ç»‡èµ·æ¥çš„ç½‘ç»œï¼Œæ¯ä¸€å±‚çš„è¾“å‡ºå˜é‡éƒ½æ˜¯ä¸‹ ä¸€å±‚çš„è¾“å…¥å˜é‡ã€‚ä¸‹å›¾ä¸ºä¸€ä¸ª 3 å±‚çš„ç¥ç»ç½‘ç»œï¼Œç¬¬ä¸€å±‚æˆä¸ºè¾“å…¥å±‚ï¼ˆInput Layerï¼‰ï¼Œæœ€åä¸€ å±‚ç§°ä¸ºè¾“å‡ºå±‚ï¼ˆOutput Layerï¼‰ï¼Œä¸­é—´ä¸€å±‚æˆä¸ºéšè—å±‚ï¼ˆHidden Layersï¼‰ã€‚æˆ‘ä»¬ä¸ºæ¯ä¸€å±‚éƒ½å¢ åŠ ä¸€ä¸ªåå·®å•ä½ï¼ˆbias unitï¼‰ï¼Œä¸‹é¢å¼•å…¥ä¸€äº›æ ‡è®°æ³•æ¥å¸®åŠ©æè¿°æ¨¡å‹:</p><p>$a_{i}^{(j)}$ ä»£è¡¨ç¬¬j å±‚çš„ç¬¬ $i$ ä¸ªæ¿€æ´»å•å…ƒã€‚ $\theta^{(j)}$ ä»£è¡¨ä»ç¬¬ $j$ å±‚æ˜ å°„åˆ°ç¬¬ $j+1$ å±‚æ—¶çš„æƒé‡çš„çŸ©é˜µï¼Œä¾‹å¦‚ $\theta^{(1)}$ ä»£è¡¨ä»ç¬¬ä¸€å±‚æ˜ å°„åˆ°ç¬¬äºŒå±‚çš„æƒé‡çš„çŸ©é˜µã€‚å…¶å°ºå¯¸ä¸º: ä»¥ç¬¬ $j+1$ å±‚çš„æ¿€æ´»å•å…ƒæ•°é‡ä¸ºè¡Œæ•°ï¼Œä»¥ç¬¬ $j$ å±‚çš„æ¿€æ´»å•å…ƒæ•°åŠ ä¸€ä¸ºåˆ—æ•°çš„çŸ©é˜µã€‚ä¾‹å¦‚ï¼šä¸Šå›¾æ‰€ç¤ºçš„ç¥ç»ç½‘ç»œä¸­$\theta^{(1)}$ çš„å°ºå¯¸ä¸º $3^{*} 4$ ã€‚</p><p>å¯¹äºä¸Šå›¾æ‰€ç¤ºçš„æ¨¡å‹ï¼Œæ¿€æ´»å•å…ƒå’Œè¾“å‡ºåˆ†åˆ«è¡¨è¾¾ä¸º:</p><script type="math/tex; mode=display">\begin{array}{l}a_{1}^{(2)}=g\left(\Theta_{10}^{(1)} x_{0}+\Theta_{11}^{(1)} x_{1}+\Theta_{12}^{(1)} x_{2}+\Theta_{13}^{(1)} x_{3}\right) \\a_{2}^{(2)}=g\left(\theta_{20}^{(1)} x_{0}+\Theta_{21}^{(1)} x_{1}+\Theta_{22}^{(1)} x_{2}+\theta_{23}^{(1)} x_{3}\right) \\a_{3}^{(2)}=g\left(\theta_{30}^{(1)} x_{0}+\Theta_{31}^{(1)} x_{1}+\theta_{32}^{(1)} x_{2}+\theta_{33}^{(1)} x_{3}\right) \\h_{\theta}(x)=g\left(\Theta_{10}^{(2)} a_{0}^{(2)}+\Theta_{11}^{(2)} a_{1}^{(2)}+\Theta_{12}^{(2)} a_{2}^{(2)}+\Theta_{13}^{(2)} a_{3}^{(2)}\right)\end{array}</script><p>ä¸Šé¢è¿›è¡Œçš„è®¨è®ºä¸­åªæ˜¯å°†ç‰¹å¾çŸ©é˜µä¸­çš„ä¸€è¡Œï¼ˆä¸€ä¸ªè®­ç»ƒå®ä¾‹ï¼‰å–‚ç»™äº†ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬éœ€è¦å°†æ•´ä¸ªè®­ç»ƒé›†éƒ½å–‚ç»™æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œç®—æ³•æ¥å­¦ä¹ æ¨¡å‹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“:æ¯ä¸€ä¸ªğ‘éƒ½æ˜¯ç”±ä¸Šä¸€å±‚æ‰€æœ‰çš„ğ‘¥å’Œæ¯ä¸€ä¸ªğ‘¥æ‰€å¯¹åº”çš„å†³å®šçš„ã€‚ ï¼ˆæˆ‘ä»¬æŠŠè¿™æ ·ä»å·¦åˆ°å³çš„ç®—æ³•ç§°ä¸ºå‰å‘ä¼ æ’­ç®—æ³•ï¼ˆFORWARD PROPAGATIONï¼‰ï¼‰</p><p>æŠŠğ‘¥, ğœƒ, ğ‘ åˆ†åˆ«ç”¨çŸ©é˜µè¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ğœƒ â‹… ğ‘‹ = ğ‘ :</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206223520.png" alt="image-20201206185810317"></p><h2 id="3-æ¨¡å‹è¡¨ç¤º-2"><a href="#3-æ¨¡å‹è¡¨ç¤º-2" class="headerlink" title="3.æ¨¡å‹è¡¨ç¤º 2"></a>3.æ¨¡å‹è¡¨ç¤º 2</h2><p>ï¼ˆFORWARD PROPAGATIONï¼‰ç›¸å¯¹äºä½¿ç”¨å¾ªç¯æ¥ç¼–ç ï¼Œåˆ©ç”¨å‘é‡åŒ–çš„æ–¹æ³•ä¼šä½¿å¾—è®¡ç®—æ›´ ä¸ºç®€ä¾¿ã€‚ä»¥ä¸Šé¢çš„ç¥ç»ç½‘ç»œä¸ºä¾‹ï¼Œè¯•ç€è®¡ç®—ç¬¬äºŒå±‚çš„å€¼:</p><script type="math/tex; mode=display">x=\left[\begin{array}{l}x_{0} \\x_{1} \\x_{2} \\x_{3}\end{array}\right] \quad z^{(2)}=\left[\begin{array}{l}z_{1}^{(2)} \\z_{2}^{(2)} \\z_{3}^{(2)}\end{array}\right]</script><script type="math/tex; mode=display">\begin{array}{l}z^{(2)}=\Theta^{(1)} x \\a^{(2)}=g\left(z^{(2)}\right)\end{array}</script><script type="math/tex; mode=display">g\left(\left[\begin{array}{llll}\theta_{10}^{(1)} & \theta_{11}^{(1)} & \theta_{12}^{(1)} & \theta_{13}^{(1)} \\\theta_{20}^{(1)} & \theta_{21}^{(1)} & \theta_{22}^{(1)} & \theta_{23}^{(1)} \\\theta_{30}^{(1)} & \theta_{31}^{(1)} & \theta_{32}^{(1)} & \theta_{33}^{(1)}\end{array}\right] \times\left[\begin{array}{l}x_{0} \\x_{1} \\x_{2} \\x_{3}\end{array}\right]\right)=g\left(\left[\begin{array}{l}\theta_{10}^{(1)} x_{0}+\theta_{11}^{(1)} x_{1}+\theta_{12}^{(1)} x_{2}+\theta_{13}^{(1)} x_{3} \\\theta_{20}^{(1)} x_{0}+\theta_{21}^{(1)} x_{1}+\theta_{22}^{(1)} x_{2}+\theta_{23}^{(1)} x_{3} \\\theta_{30}^{(1)} x_{0}+\theta_{31}^{(1)} x_{1}+\theta_{32}^{(1)} x_{2}+\theta_{33}^{(1)} x_{3}\end{array}\right]\right)=\left[\begin{array}{l}a_{1}^{(2)} \\a_{2}^{(2)} \\a_{3}^{(2)}\end{array}\right]</script><p>æˆ‘ä»¬ä»¤ $z^{(2)}=\theta^{(1)} x,$ åˆ™ $a^{(2)}=g\left(z^{(2)}\right),$ è®¡ç®—åæ·»åŠ  $a_{0}^{(2)}=1$ã€‚è®¡ç®—è¾“å‡ºçš„å€¼ä¸º :</p><script type="math/tex; mode=display">\left.g\left(\left[\begin{array}{llll}\theta_{10}^{(2)} & \theta_{11}^{(2)} & \theta_{12}^{(2)} & \theta_{13}^{(2)}\end{array}\right] \times \mid \begin{array}{l}u_{0} \\a_{1}^{(2)} \\a_{2}^{(2)} \\a_{3}^{(2)}\end{array}\right]\right)=g\left(\theta_{10}^{(2)} a_{0}^{(2)}+\theta_{11}^{(2)} a_{1}^{(2)}+\theta_{12}^{(2)} a_{2}^{(2)}+\theta_{13}^{(2)} a_{3}^{(2)}\right)=h_{\theta}(x)</script><p>æˆ‘ä»¬ä»¤ $z^{(3)}=\theta^{(2)} a^{(2)},$ åˆ™ $h_{\theta}(x)=a^{(3)}=g\left(z^{(3)}\right)$ ã€‚</p><p>è¿™åªæ˜¯é’ˆå¯¹è®­ç»ƒé›†ä¸­ä¸€ä¸ªè®­ç»ƒå®ä¾‹æ‰€è¿›è¡Œçš„è®¡ç®—ã€‚å¦‚æœæˆ‘ä»¬è¦å¯¹æ•´ä¸ªè®­ç»ƒé›†è¿›è¡Œè®¡ç®—ï¼Œ æˆ‘ä»¬éœ€è¦å°†è®­ç»ƒé›†ç‰¹å¾çŸ©é˜µè¿›è¡Œè½¬ç½®ï¼Œä½¿å¾—åŒä¸€ä¸ªå®ä¾‹çš„ç‰¹å¾éƒ½åœ¨åŒä¸€åˆ—é‡Œã€‚å³:</p><script type="math/tex; mode=display">\begin{array}{l}z^{(2)}=\Theta^{(1)} \times X^{T} \\a^{(2)}=g\left(z^{(2)}\right)\end{array}</script><p>ä¸ºäº†æ›´å¥½äº†äº†è§£ Neuron Networks çš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å…ˆæŠŠå·¦åŠéƒ¨åˆ†é®ä½:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206192646.png" alt="é®ä½"></p><p>å…¶å®ç¥ç»ç½‘ç»œå°±åƒæ˜¯ logistic regressionï¼Œ åªä¸è¿‡æˆ‘ä»¬æŠŠ logistic regression ä¸­çš„è¾“å…¥å‘é‡<br>$\left[x_{1} \sim x_{3}\right]$ å˜æˆäº†ä¸­é—´å±‚çš„ $\left[a_{1}^{(2)} \sim a_{3}^{(2)}\right],$ å³:</p><p>$h_{\theta}(x)=g\left(\theta_{0}^{(2)} a_{0}^{(2)}+\theta_{1}^{(2)} a_{1}^{(2)}+\theta_{2}^{(2)} a_{2}^{(2)}+\theta_{3}^{(2)} a_{3}^{(2)}\right)$</p><p>æˆ‘ä»¬å¯ä»¥æŠŠ $a_{0}, a_{1}, a_{2}, a_{3}$ çœ‹æˆæ›´ä¸ºé«˜çº§çš„ç‰¹å¾å€¼, ä¹Ÿå°±æ˜¯ $x_{0}, x_{1}, x_{2}, x_{3}$ çš„è¿›åŒ–ä½“, å¹¶ä¸”å®ƒä»¬æ˜¯ç”± $x$ ä¸å†³å®šçš„, å› ä¸ºæ˜¯æ¢¯åº¦ä¸‹é™çš„ï¼Œæ‰€ä»¥ $a$ æ˜¯å˜åŒ–çš„ï¼Œå¹¶ä¸”å˜å¾—è¶Šæ¥è¶Šå‰å®³ï¼Œæ‰€ä»¥è¿™äº›æ›´é«˜çº§çš„ç‰¹å¾å€¼è¿œæ¯”ä»…ä»…å°† $x$ æ¬¡æ–¹å‰å®³ï¼Œä¹Ÿèƒ½æ›´å¥½çš„é¢„æµ‹æ–°æ•°æ®ã€‚è¿™å°±æ˜¯ç¥ç»ç½‘ç»œç›¸æ¯”äºé€»è¾‘å›å½’å’Œçº¿æ€§å›å½’çš„ä¼˜åŠ¿ã€‚</p><h2 id="4-ç‰¹å¾å’Œç›´è§‚ç†è§£-1"><a href="#4-ç‰¹å¾å’Œç›´è§‚ç†è§£-1" class="headerlink" title="4.ç‰¹å¾å’Œç›´è§‚ç†è§£ 1"></a>4.ç‰¹å¾å’Œç›´è§‚ç†è§£ 1</h2><p>ç¥ç»ç½‘ç»œä¸­ï¼Œå•å±‚ç¥ç»å…ƒï¼ˆæ— ä¸­é—´å±‚ï¼‰çš„è®¡ç®—å¯ç”¨æ¥è¡¨ç¤ºé€»è¾‘è¿ç®—ï¼Œæ¯”å¦‚é€»è¾‘ä¸ï¼ˆANDï¼‰ã€ é€»è¾‘æˆ–ï¼ˆORï¼‰ã€‚</p><p>ä¸¾ä¾‹è¯´æ˜:é€»è¾‘ä¸ï¼ˆANDï¼‰;ä¸‹å›¾ä¸­å·¦åŠéƒ¨åˆ†æ˜¯ç¥ç»ç½‘ç»œçš„è®¾è®¡ä¸ output å±‚è¡¨è¾¾å¼ï¼Œå³è¾¹ ä¸Šéƒ¨åˆ†æ˜¯ sigmod å‡½æ•°ï¼Œä¸‹åŠéƒ¨åˆ†æ˜¯çœŸå€¼è¡¨ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨è¿™æ ·çš„ä¸€ä¸ªç¥ç»ç½‘ç»œè¡¨ç¤º AND å‡½æ•°:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206194031.png" alt="ç¥ç»ç½‘ç»œè¡¨ç¤º AND å‡½æ•°"></p><p>å…¶ä¸­ $\theta_{0}=-30, \theta_{1}=20, \theta_{2}=20$ æˆ‘ä»¬çš„è¾“å‡ºå‡½æ•° $h_{\theta}(x)$ å³ä¸º: $h_{\theta}(x)=g\left(-30+20 x_{1}+20 x_{2}\right)$</p><p>æˆ‘ä»¬çŸ¥é“ $g(x)$ çš„å›¾åƒæ˜¯:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206194157.png" alt="Sigmoid Function"></p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206223530.png" alt="image-20201206194239927"></p><p>æ‰€ä»¥æˆ‘ä»¬æœ‰: $h_{\theta}(x) \approx \mathrm{x}_{1} \mathrm{AND} \mathrm{x}_{2}$<br>æ¥ä¸‹æ¥å†ä»‹ç»ä¸€ä¸ª OR å‡½æ•°:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206194319.png" alt="OR å‡½æ•°"></p><h2 id="5-æ ·æœ¬å’Œç›´è§‚ç†è§£-II"><a href="#5-æ ·æœ¬å’Œç›´è§‚ç†è§£-II" class="headerlink" title="5.æ ·æœ¬å’Œç›´è§‚ç†è§£ II"></a>5.æ ·æœ¬å’Œç›´è§‚ç†è§£ II</h2><p>äºŒå…ƒé€»è¾‘è¿ç®—ç¬¦ï¼ˆBINARY LOGICAL OPERATORSï¼‰å½“è¾“å…¥ç‰¹å¾ä¸ºå¸ƒå°”å€¼ï¼ˆ0 æˆ– 1ï¼‰æ—¶ï¼Œæˆ‘ ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå•ä¸€çš„æ¿€æ´»å±‚å¯ä»¥ä½œä¸ºäºŒå…ƒé€»è¾‘è¿ç®—ç¬¦ï¼Œä¸ºäº†è¡¨ç¤ºä¸åŒçš„è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬åªéœ€è¦ é€‰æ‹©ä¸åŒçš„æƒé‡å³å¯ã€‚</p><p>ä¸‹å›¾çš„ç¥ç»å…ƒï¼ˆä¸‰ä¸ªæƒé‡åˆ†åˆ«ä¸º-30ï¼Œ20ï¼Œ20ï¼‰å¯ä»¥è¢«è§†ä¸ºä½œç”¨åŒäºé€»è¾‘ä¸ï¼ˆANDï¼‰:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206222420.png" alt="AND"></p><p>ä¸‹å›¾çš„ç¥ç»å…ƒï¼ˆä¸‰ä¸ªæƒé‡åˆ†åˆ«ä¸º-10ï¼Œ20ï¼Œ20ï¼‰å¯ä»¥è¢«è§†ä¸ºä½œç”¨ç­‰åŒäºé€»è¾‘æˆ–ï¼ˆORï¼‰:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206223540.png" alt="OR"></p><p>ä¸‹å›¾çš„ç¥ç»å…ƒï¼ˆä¸¤ä¸ªæƒé‡åˆ†åˆ«ä¸º 10ï¼Œ-20ï¼‰å¯ä»¥è¢«è§†ä¸ºä½œç”¨ç­‰åŒäºé€»è¾‘éï¼ˆNOTï¼‰:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206223543.png" alt="NOT"></p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç¥ç»å…ƒæ¥ç»„åˆæˆæ›´ä¸ºå¤æ‚çš„ç¥ç»ç½‘ç»œä»¥å®ç°æ›´å¤æ‚çš„è¿ç®—ã€‚ä¾‹å¦‚æˆ‘ä»¬è¦å®ç° XNOR åŠŸèƒ½ï¼ˆè¾“å…¥çš„ä¸¤ä¸ªå€¼å¿…é¡»ä¸€æ ·ï¼Œå‡ä¸º 1 æˆ–å‡ä¸º 0ï¼‰ï¼Œå³:</p><script type="math/tex; mode=display">\mathrm{XNOR}=\left(\mathrm{x}_{1} \mathrm{AND} \mathrm{x}_{2}\right) \mathrm{OR}\left(\left(\mathrm{NOT} \mathrm{x}_{1}\right) \mathrm{AND}\left(\mathrm{NOT} \mathrm{x}_{2}\right)\right)</script><p>é¦–å…ˆæ„é€ ä¸€ä¸ªèƒ½è¡¨è¾¾$(NOTx_{1}) AND(NOT x_{2})$ éƒ¨åˆ†çš„ç¥ç»å…ƒ:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206223611.png" alt="AND"></p><p>ç„¶åå°†è¡¨ç¤º AND çš„ç¥ç»å…ƒå’Œè¡¨ç¤º $\left(\mathrm{NOT} \mathrm{x}_{1}\right) \mathrm{AND}\left(\mathrm{NOT} \mathrm{x}_{2}\right)$ çš„ç¥ç»å…ƒä»¥åŠè¡¨ç¤º $\mathrm{OR}$ çš„ç¥ç»å…ƒè¿›è¡Œç»„åˆ:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206222706.png" alt="XNOR"></p><p>æŒ‰è¿™ç§æ–¹æ³•æˆ‘ä»¬å¯ä»¥é€æ¸æ„é€ å‡ºè¶Šæ¥è¶Šå¤æ‚çš„å‡½æ•°ï¼Œä¹Ÿèƒ½å¾—åˆ°æ›´åŠ å‰å®³çš„ç‰¹å¾å€¼ã€‚ è¿™å°±æ˜¯ç¥ç»ç½‘ç»œçš„å‰å®³ä¹‹å¤„ã€‚</p><h2 id="6-å¤šç±»åˆ†ç±»"><a href="#6-å¤šç±»åˆ†ç±»" class="headerlink" title="6.å¤šç±»åˆ†ç±»"></a>6.å¤šç±»åˆ†ç±»</h2><p>å½“æˆ‘ä»¬æœ‰ä¸æ­¢ä¸¤ç§åˆ†ç±»æ—¶ ï¼ˆä¹Ÿå°±æ˜¯ $y=1,2,3 \ldots $.ï¼‰æ¯”å¦‚ä»¥ä¸‹è¿™ç§æƒ…å†µï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿå¦‚æœæˆ‘ä»¬è¦è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œç®—æ³•æ¥è¯†åˆ«è·¯äººã€æ±½è½¦ã€æ‘©æ‰˜è½¦å’Œå¡è½¦ï¼Œåœ¨è¾“å‡ºå±‚æˆ‘ä»¬åº”è¯¥æœ‰ 4 ä¸ªå€¼ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ªå€¼ä¸º 1 æˆ– 0 ç”¨äºé¢„æµ‹æ˜¯å¦æ˜¯è¡Œäººï¼Œç¬¬äºŒä¸ªå€¼ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºæ±½è½¦ã€‚è¾“å…¥å‘é‡xæœ‰ä¸‰ä¸ªç»´åº¦ï¼Œä¸¤ä¸ªä¸­é—´å±‚ï¼Œè¾“å‡ºå±‚ 4 ä¸ªç¥ç»å…ƒåˆ†åˆ«ç”¨æ¥è¡¨ç¤º 4 ç±»ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€ä¸ªæ•°æ®åœ¨è¾“å‡ºå±‚éƒ½ä¼šå‡ºç°$[a,b,c,d]^{T},$ ä¸” $a, b, c, d$ ä¸­ä»…æœ‰ä¸€ä¸ªä¸º $1,$ è¡¨ç¤ºå½“å‰ç±»ã€‚ä¸‹é¢æ˜¯è¯¥ç¥ç»ç½‘ç»œçš„å¯èƒ½ç»“æ„ç¤ºä¾‹:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206223146.png" alt="å¤šç±»åˆ†ç±»ç½‘ç»œ"></p>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> ç¥ç»ç½‘ç»œ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>03_æ­£åˆ™åŒ–_Regularization</title>
      <link href="2020/12/05/machinelearning/wu-en-da-ji-qi-xue-xi/03-regularization/"/>
      <url>2020/12/05/machinelearning/wu-en-da-ji-qi-xue-xi/03-regularization/</url>
      
        <content type="html"><![CDATA[<h1 id="æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰"><a href="#æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰" class="headerlink" title="æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰"></a>æ­£åˆ™åŒ–ï¼ˆRegularizationï¼‰</h1><h2 id="1-è¿‡æ‹Ÿåˆçš„é—®é¢˜"><a href="#1-è¿‡æ‹Ÿåˆçš„é—®é¢˜" class="headerlink" title="1.è¿‡æ‹Ÿåˆçš„é—®é¢˜"></a>1.è¿‡æ‹Ÿåˆçš„é—®é¢˜</h2><p>å¦‚æœæˆ‘ä»¬æœ‰éå¸¸å¤šçš„ç‰¹å¾ï¼Œæˆ‘ä»¬é€šè¿‡å­¦ä¹ å¾—åˆ°çš„å‡è®¾å¯èƒ½èƒ½å¤Ÿéå¸¸å¥½åœ°é€‚åº”è®­ç»ƒé›†(ä»£ä»·å‡½æ•°å¯èƒ½å‡ ä¹ä¸º 0)ï¼Œä½†æ˜¯å¯èƒ½ä¼šä¸èƒ½æ¨å¹¿åˆ°æ–°çš„æ•°æ®ã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªå›å½’é—®é¢˜çš„ä¾‹å­:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207104636.png" alt="å›å½’é—®é¢˜è¿‡æ‹Ÿåˆä¾‹å­"></p><p>ç¬¬ä¸€ä¸ªæ¨¡å‹æ˜¯ä¸€ä¸ªçº¿æ€§æ¨¡å‹ï¼Œæ¬ æ‹Ÿåˆï¼Œä¸èƒ½å¾ˆå¥½åœ°é€‚åº”æˆ‘ä»¬çš„è®­ç»ƒé›†;ç¬¬ä¸‰ä¸ªæ¨¡å‹æ˜¯ä¸€ä¸ªå››æ¬¡æ–¹çš„æ¨¡å‹ï¼Œè¿‡äºå¼ºè°ƒæ‹ŸåˆåŸå§‹æ•°æ®ï¼Œè€Œä¸¢å¤±äº†ç®—æ³•çš„æœ¬è´¨:é¢„æµ‹æ–°æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè‹¥ç»™å‡ºä¸€ä¸ªæ–°çš„å€¼ä½¿ä¹‹é¢„æµ‹ï¼Œå®ƒå°†è¡¨ç°çš„å¾ˆå·®ï¼Œæ˜¯è¿‡æ‹Ÿåˆï¼Œè™½ç„¶èƒ½éå¸¸å¥½åœ°é€‚åº”æˆ‘ä»¬çš„è®­ç»ƒé›†ä½†åœ¨æ–°è¾“å…¥å˜é‡è¿›è¡Œé¢„æµ‹æ—¶å¯èƒ½ä¼šæ•ˆæœä¸å¥½ï¼Œè€Œä¸­é—´çš„æ¨¡å‹ä¼¼ä¹æœ€åˆé€‚ã€‚åˆ†ç±»é—®é¢˜ä¸­ä¹Ÿå­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207104717.png" alt="åˆ†ç±»é—®é¢˜è¿‡æ‹Ÿåˆä¾‹å­"></p><p>å°±ä»¥å¤šé¡¹å¼ç†è§£ï¼Œğ‘¥ çš„æ¬¡æ•°è¶Šé«˜ï¼Œæ‹Ÿåˆçš„è¶Šå¥½ï¼Œä½†ç›¸åº”çš„é¢„æµ‹çš„èƒ½åŠ›å°±å¯èƒ½å˜å·®ã€‚é—®é¢˜æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å‘ç°äº†è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œåº”è¯¥å¦‚ä½•å¤„ç†?</p><ul><li>ä¸¢å¼ƒä¸€äº›ä¸èƒ½å¸®åŠ©æˆ‘ä»¬æ­£ç¡®é¢„æµ‹çš„ç‰¹å¾ã€‚å¯ä»¥æ˜¯æ‰‹å·¥é€‰æ‹©ä¿ç•™å“ªäº›ç‰¹å¾ï¼Œæˆ–è€…ä½¿ç”¨ä¸€ äº›æ¨¡å‹é€‰æ‹©çš„ç®—æ³•æ¥å¸®å¿™ï¼ˆä¾‹å¦‚ PCAï¼‰</li><li>æ­£åˆ™åŒ–ã€‚ ä¿ç•™æ‰€æœ‰çš„ç‰¹å¾ï¼Œä½†æ˜¯å‡å°‘å‚æ•°çš„å¤§å°ï¼ˆmagnitudeï¼‰</li></ul><h2 id="2-ä»£ä»·å‡½æ•°"><a href="#2-ä»£ä»·å‡½æ•°" class="headerlink" title="2.ä»£ä»·å‡½æ•°"></a>2.ä»£ä»·å‡½æ•°</h2><p>å›å½’é—®é¢˜ä¸­å¦‚æœæˆ‘ä»¬çš„æ¨¡å‹æ˜¯:</p><script type="math/tex; mode=display">h_{\theta}(x)=\theta_{0}+\theta_{1} x_{1}+\theta_{2} x_{2}^{2}+\theta_{3} x_{3}^{3}+\theta_{4} x_{4}^{4}</script><p>æˆ‘ä»¬å¯ä»¥ä»ä¹‹å‰çš„äº‹ä¾‹ä¸­çœ‹å‡ºï¼Œæ­£æ˜¯é‚£äº›é«˜æ¬¡é¡¹å¯¼è‡´äº†è¿‡æ‹Ÿåˆçš„äº§ç”Ÿï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬èƒ½è®©è¿™äº›é«˜æ¬¡é¡¹çš„ç³»æ•°æ¥è¿‘äº 0 çš„è¯ï¼Œæˆ‘ä»¬å°±èƒ½å¾ˆå¥½çš„æ‹Ÿåˆäº†ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°è¿™äº›å‚æ•° $\theta$ çš„å€¼, è¿™å°±æ˜¯æ­£åˆ™åŒ–çš„åŸºæœ¬æ–¹æ³•ã€‚æˆ‘ä»¬å†³å®šè¦å‡å°‘ $\theta_{3}$ å’Œ $\theta_{4}$ çš„å¤§å°, æˆ‘ä»¬è¦åšçš„ä¾¿æ˜¯ä¿®æ”¹ä»£ä»·å‡½æ•°,åœ¨å…¶ä¸­ $\theta_{3}$ å’Œ $\theta_{4}$ è®¾ç½®ä¸€ç‚¹æƒ©ç½šã€‚è¿™æ ·åšçš„è¯ï¼Œæˆ‘ä»¬åœ¨å°è¯•æœ€å°åŒ–ä»£ä»·æ—¶ä¹Ÿéœ€è¦å°†è¿™ä¸ªæƒ©ç½šçº³å…¥è€ƒè™‘ä¸­ï¼Œå¹¶æœ€ç»ˆå¯¼è‡´é€‰æ‹©è¾ƒå°ä¸€äº›çš„ $\theta_{3}$ å’Œ $\theta_{4}$ ã€‚ä¿®æ”¹åçš„ä»£ä»·å‡½æ•°å¦‚ä¸‹: </p><script type="math/tex; mode=display">\min _{\theta} \frac{1}{2 m}\left[\sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right)^{2}+1000 \theta_{3}^{2}+10000 \theta_{4}^{2}\right]</script><p>é€šè¿‡è¿™æ ·çš„ä»£ä»·å‡½æ•°é€‰æ‹©å‡ºçš„ğœƒ3å’Œğœƒ4 å¯¹é¢„æµ‹ç»“æœçš„å½±å“å°±æ¯”ä¹‹å‰è¦å°è®¸å¤šã€‚å‡å¦‚æˆ‘ä»¬æœ‰éå¸¸å¤šçš„ç‰¹å¾ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“å…¶ä¸­å“ªäº›ç‰¹å¾æˆ‘ä»¬è¦æƒ©ç½šï¼Œæˆ‘ä»¬å°†å¯¹æ‰€æœ‰çš„ç‰¹å¾è¿›è¡Œæƒ©ç½šï¼Œ å¹¶ä¸”è®©ä»£ä»·å‡½æ•°æœ€ä¼˜åŒ–çš„è½¯ä»¶æ¥é€‰æ‹©è¿™äº›æƒ©ç½šçš„ç¨‹åº¦ã€‚è¿™æ ·çš„ç»“æœæ˜¯å¾—åˆ°äº†ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„èƒ½é˜²æ­¢è¿‡æ‹Ÿåˆé—®é¢˜çš„å‡è®¾ï¼š</p><script type="math/tex; mode=display">J(\theta)=\frac{1}{2 m}\left[\sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right)^{2}+\lambda \sum_{j=1}^{n} \theta_{j}^{2}\right]</script><p>å…¶ä¸­$\lambda$åˆç§°ä¸ºæ­£åˆ™åŒ–å‚æ•°ï¼ˆRegularization Parameter $ï¼‰$ ã€‚ æ³¨: æ ¹æ®æƒ¯ä¾‹ï¼Œæˆ‘ä»¬ä¸å¯¹ $\theta_{0}$ è¿›è¡Œæƒ©ç½šã€‚ç»è¿‡æ­£åˆ™åŒ–å¤„ç†çš„æ¨¡å‹ä¸åŸæ¨¡å‹çš„å¯èƒ½å¯¹æ¯”å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207113348.png" alt="å¯¹æ¯”å›¾"></p><p>å¦‚æœé€‰æ‹©çš„æ­£åˆ™åŒ–å‚æ•° $\lambda$ è¿‡å¤§ï¼Œåˆ™ä¼šæŠŠæ‰€æœ‰çš„å‚æ•°éƒ½æœ€å°åŒ–äº†ï¼Œå¯¼è‡´æ¨¡å‹å˜æˆ$h_ğœƒ(ğ‘¥) = ğœƒ_0$ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­çº¢è‰²ç›´çº¿æ‰€ç¤ºçš„æƒ…å†µï¼Œé€ æˆæ¬ æ‹Ÿåˆã€‚</p><p>é‚£ä¸ºä»€ä¹ˆå¢åŠ çš„ä¸€é¡¹ $\lambda=\sum_{j=1}^{n} \theta_{j}^{2}$ å¯ä»¥ä½¿ $\theta$ çš„å€¼å‡å°å‘¢?å› ä¸ºå¦‚æœæˆ‘ä»¬ä»¤ $\lambda$ çš„å€¼å¾ˆå¤§çš„è¯ï¼Œä¸ºäº†ä½¿ cost Function å°½å¯èƒ½çš„å°ï¼Œæ‰€æœ‰çš„ $\theta$ çš„å€¼ï¼ˆä¸åŒ…æ‹¬ $\theta_{0}$ ï¼‰éƒ½ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°ã€‚</p><p>ä½†è‹¥ $\lambda$ çš„å€¼å¤ªå¤§äº†ï¼Œé‚£ä¹ˆ $\theta$ ï¼ˆä¸åŒ…æ‹¬ $\theta_{0}$ ï¼‰ éƒ½ä¼šè¶‹è¿‘äº 0ï¼Œè¿™æ ·æˆ‘ä»¬æ‰€å¾—åˆ°çš„åªèƒ½æ˜¯ä¸€æ¡å¹³è¡Œäºxè½´çš„ç›´çº¿ã€‚æ‰€ä»¥å¯¹äºæ­£åˆ™åŒ–ï¼Œæˆ‘ä»¬è¦å–ä¸€ä¸ªåˆç†çš„ $\lambda$ çš„å€¼ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½çš„åº”ç”¨æ­£åˆ™åŒ–ã€‚å›é¡¾ä¸€ä¸‹ä»£ä»·å‡½æ•°ï¼Œä¸ºäº†ä½¿ç”¨æ­£åˆ™åŒ–ï¼Œè®©æˆ‘ä»¬æŠŠè¿™äº›æ¦‚å¿µåº”ç”¨åˆ°åˆ°çº¿æ€§å›å½’å’Œé€»è¾‘å›å½’ä¸­å»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®©ä»–ä»¬é¿å…è¿‡åº¦æ‹Ÿåˆäº†ã€‚</p><h2 id="3-æ­£åˆ™åŒ–çº¿æ€§å›å½’"><a href="#3-æ­£åˆ™åŒ–çº¿æ€§å›å½’" class="headerlink" title="3.æ­£åˆ™åŒ–çº¿æ€§å›å½’"></a>3.æ­£åˆ™åŒ–çº¿æ€§å›å½’</h2><p>æ­£åˆ™åŒ–çº¿æ€§å›å½’çš„ä»£ä»·å‡½æ•°ä¸º:</p><script type="math/tex; mode=display">J(\theta)=\frac{1}{2 m} \sum_{i=1}^{m}\left[\left(\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right)^{2}+\lambda \sum_{j=1}^{n} \theta_{j}^{2}\right)\right]</script><p>æ­¤æ—¶æ¢¯åº¦ä¸‹é™çš„å…¬å¼ä¸ºï¼š</p><script type="math/tex; mode=display">\theta_{j}:=\theta_{j}-a\left[\frac{1}{m} \sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right) x_{j}^{(i)}+\frac{\lambda}{m} \theta_{j}\right]</script><p>è°ƒæ•´åå¯å¾—ï¼š</p><script type="math/tex; mode=display">\theta_{j}:=\theta_{j}\left(1-a \frac{\lambda}{m}\right)-a \frac{1}{m} \sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right) x_{j}^{(i)}</script><p>å¯ä»¥çœ‹å‡ºï¼Œæ­£åˆ™åŒ–çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å˜åŒ–åœ¨äºï¼Œæ¯æ¬¡éƒ½åœ¨åŸæœ‰ç®—æ³•æ›´æ–°è§„åˆ™çš„ åŸºç¡€ä¸Šä»¤ğœƒå€¼å‡å°‘äº†ä¸€ä¸ªé¢å¤–çš„å€¼ã€‚</p><p>æˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥åˆ©ç”¨æ­£è§„æ–¹ç¨‹æ¥æ±‚è§£æ­£åˆ™åŒ–çº¿æ€§å›å½’æ¨¡å‹ï¼Œæ–¹æ³•å¦‚ä¸‹æ‰€ç¤º:</p><script type="math/tex; mode=display">\theta=\left(X^{T} X+\lambda\left[\begin{array}{ccc}0 \\& 1 \\& & 1 \\& & & \ddots \\& & & & 1 \\\end{array}\right]\right)^{-1} X^{T} y</script><h2 id="4-æ­£åˆ™åŒ–é€»è¾‘å›å½’"><a href="#4-æ­£åˆ™åŒ–é€»è¾‘å›å½’" class="headerlink" title="4.æ­£åˆ™åŒ–é€»è¾‘å›å½’"></a>4.æ­£åˆ™åŒ–é€»è¾‘å›å½’</h2><p>é’ˆå¯¹é€»è¾‘å›å½’é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„è¯¾ç¨‹å·²ç»å­¦ä¹ è¿‡ä¸¤ç§ä¼˜åŒ–ç®—æ³•: æˆ‘ä»¬é¦–å…ˆå­¦ä¹ äº†ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥ä¼˜åŒ–ä»£ä»·å‡½æ•° $J(\theta)$, æ¥ä¸‹æ¥å­¦ä¹ äº†æ›´é«˜çº§çš„ä¼˜åŒ–ç®—æ³•ï¼Œè¿™äº›é«˜çº§ä¼˜åŒ–ç®—æ³•éœ€è¦ä½ è‡ªå·±è®¾è®¡ä»£ä»·å‡½æ•° $J(\theta)$ ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201207154734.png" alt="é€»è¾‘å›å½’"></p><p>è‡ªå·±è®¡ç®—å¯¼æ•°åŒæ ·å¯¹äºé€»è¾‘å›å½’ï¼Œæˆ‘ä»¬ä¹Ÿç»™ä»£ä»·å‡½æ•°å¢åŠ ä¸€ä¸ªæ­£åˆ™åŒ–çš„è¡¨è¾¾å¼ï¼Œå¾—åˆ°ä»£ä»·å‡½æ•°:</p><script type="math/tex; mode=display">J(\theta)=\frac{1}{m} \sum_{i=1}^{m}\left[-y^{(i)} \log \left(h_{\theta}\left(x^{(i)}\right)\right)-\left(1-y^{(i)}\right) \log \left(1-h_{\theta}\left(x^{(i)}\right)\right)\right]+\frac{\lambda}{2 m} \sum_{j=1}^{n} \theta_{j}^{2}</script><p>Pythonä»£ç ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">def</span> <span class="token function">costReg</span><span class="token punctuation">(</span>theta<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> learningRate<span class="token punctuation">)</span><span class="token punctuation">:</span>  theta <span class="token operator">=</span> np<span class="token punctuation">.</span>matrix<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>  X <span class="token operator">=</span> np<span class="token punctuation">.</span>matrix<span class="token punctuation">(</span>X<span class="token punctuation">)</span>  y <span class="token operator">=</span> np<span class="token punctuation">.</span>matrix<span class="token punctuation">(</span>y<span class="token punctuation">)</span>  first <span class="token operator">=</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span><span class="token operator">-</span>y<span class="token punctuation">,</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>sigmoid<span class="token punctuation">(</span>X<span class="token operator">*</span>theta<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  second <span class="token operator">=</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> sigmoid<span class="token punctuation">(</span>X<span class="token operator">*</span>theta<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  reg <span class="token operator">=</span> <span class="token punctuation">(</span>learningRate <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>power<span class="token punctuation">(</span>theta<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span>the  ta<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>first <span class="token operator">-</span> second<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> reg<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¦æœ€å°åŒ–è¯¥ä»£ä»·å‡½æ•°ï¼Œé€šè¿‡æ±‚å¯¼ï¼Œå¾—å‡ºæ¢¯åº¦ä¸‹é™ç®—æ³•ä¸º:</p><script type="math/tex; mode=display">\begin{array}{l}\theta_{0}:=\theta_{0}-a \frac{1}{m} \sum_{i=1}^{m}\left(\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right) x_{0}^{(i)}\right) \\\theta_{j}:=\theta_{j}-a\left[\frac{1}{m} \sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right) x_{j}^{(i)}+\frac{\lambda}{m} \theta_{j}\right]\end{array}</script>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> æ­£åˆ™åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>02_é€»è¾‘å›å½’_Logistic_Regression</title>
      <link href="2020/12/04/machinelearning/wu-en-da-ji-qi-xue-xi/02-logistic-regression/"/>
      <url>2020/12/04/machinelearning/wu-en-da-ji-qi-xue-xi/02-logistic-regression/</url>
      
        <content type="html"><![CDATA[<h1 id="é€»è¾‘å›å½’ï¼ˆLogistic-Regressionï¼‰"><a href="#é€»è¾‘å›å½’ï¼ˆLogistic-Regressionï¼‰" class="headerlink" title="é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰"></a>é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰</h1><h2 id="1-åˆ†ç±»é—®é¢˜ï¼ˆClassificationï¼‰"><a href="#1-åˆ†ç±»é—®é¢˜ï¼ˆClassificationï¼‰" class="headerlink" title="1.åˆ†ç±»é—®é¢˜ï¼ˆClassificationï¼‰"></a>1.åˆ†ç±»é—®é¢˜ï¼ˆClassificationï¼‰</h2><p>åˆ†ç±»é—®é¢˜ä¸­ï¼Œéœ€è¦é¢„æµ‹çš„å˜é‡yæ˜¯ç¦»æ•£çš„å€¼</p><h2 id="2-å‡è¯´è¡¨ç¤º"><a href="#2-å‡è¯´è¡¨ç¤º" class="headerlink" title="2.å‡è¯´è¡¨ç¤º"></a>2.å‡è¯´è¡¨ç¤º</h2><p>é€»è¾‘å›å½’æ¨¡å‹çš„å‡è®¾æ˜¯: $\quad h_{\theta}(x)=g\left(\theta^{T} X\right)$ å…¶ä¸­: $\quad X$ ä»£è¡¨ç‰¹å¾å‘é‡ $g$ ä»£è¡¨é€»è¾‘å‡½æ•°ï¼ˆlogistic function)æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„é€»è¾‘å‡½æ•°ä¸º S å½¢å‡½æ•°(Sigmoid function)ï¼Œå…¬å¼ä¸º:</p><script type="math/tex; mode=display">g(z)=\frac{1}{1+e^{-z}}</script><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>$h_{\theta}(x)$ çš„ä½œç”¨æ˜¯ï¼Œå¯¹äºç»™å®šçš„è¾“å…¥å˜é‡ï¼Œæ ¹æ®é€‰æ‹©çš„å‚æ•°è®¡ç®—è¾“å‡ºå˜é‡=1 çš„å¯èƒ½æ€§(estimated probablity) å³ $h_{\theta}(x)=P(y=1 \mid x ; \theta)$<br>ä¾‹å¦‚ï¼Œå¦‚æœå¯¹äºç»™å®šçš„ $x,$ é€šè¿‡å·²ç»ç¡®å®šçš„å‚æ•°è®¡ç®—å¾—å‡º $h_{\theta}(x)=0.7,$ åˆ™è¡¨ç¤ºæœ‰ $70 \%$ çš„å‡ ç‡ $y$ ä¸ºæ­£å‘ç±»ï¼Œç›¸åº”åœ° $y$ ä¸ºè´Ÿå‘ç±»çš„å‡ ç‡ä¸º 1-0.7=0.3ã€‚</p><h2 id="3-åˆ¤å®šè¾¹ç•ŒDecision-Boundary"><a href="#3-åˆ¤å®šè¾¹ç•ŒDecision-Boundary" class="headerlink" title="3.åˆ¤å®šè¾¹ç•ŒDecision Boundary"></a>3.åˆ¤å®šè¾¹ç•ŒDecision Boundary</h2><p>0ç°åœ¨å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¨¡å‹:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201205224807.png" alt="image-20201205224807126"></p><p>å¯ä»¥é€‰ç›´çº¿ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201205224836.png" alt="image-20201205224836663"></p><p>ä½†å…¶ä»–çš„æ¯”å¦‚è¾¹ç•Œçš„åœ†å½¢ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201205224903.png" alt="image-20201205224903704"></p><p>æˆ‘ä»¬å¯ä»¥ç”¨éå¸¸å¤æ‚çš„æ¨¡å‹æ¥é€‚åº”éå¸¸å¤æ‚å½¢çŠ¶çš„åˆ¤å®šè¾¹ç•Œ</p><h2 id="4-ä»£ä»·å‡½æ•°Cost-Function"><a href="#4-ä»£ä»·å‡½æ•°Cost-Function" class="headerlink" title="4.ä»£ä»·å‡½æ•°Cost Function"></a>4.ä»£ä»·å‡½æ•°Cost Function</h2><p>å¦‚ä½•æ‹Ÿåˆé€»è¾‘å›å½’æ¨¡å‹çš„å‚æ•°ğœƒã€‚å…·ä½“æ¥è¯´ï¼Œæ‹Ÿåˆå‚æ•°çš„ä¼˜åŒ–ç›®æ ‡æˆ–è€…å«ä»£ä»·å‡½æ•°ï¼Œè¿™ä¾¿æ˜¯ç›‘ç£å­¦ä¹ é—®é¢˜ä¸­çš„é€»è¾‘å›å½’æ¨¡å‹çš„æ‹Ÿåˆé—®é¢˜ã€‚</p><p>å¯¹äºçº¿æ€§å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬å®šä¹‰çš„ä»£ä»·å‡½æ•°æ˜¯æ‰€æœ‰æ¨¡å‹è¯¯å·®çš„å¹³æ–¹å’Œã€‚ç†è®ºä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹é€»è¾‘å›å½’æ¨¡å‹æ²¿ç”¨è¿™ä¸ªå®šä¹‰ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºï¼Œå½“æˆ‘ä»¬å°† $h_{\theta}(x)=\frac{1}{1+e^{-\theta} T_{X}}$ å¸¦å…¥åˆ°è¿™æ ·å®šä¹‰äº†çš„ä»£ä»·å‡½æ•°ä¸­æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ä»£ä»·å‡½æ•°å°†æ˜¯ä¸€ä¸ªéå‡¸å‡½æ•°ï¼ˆnon-convexfunctionï¼‰ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„ä»£ä»·å‡½æ•°æœ‰è®¸å¤šå±€éƒ¨æœ€å°å€¼ï¼Œè¿™å°†å½±å“æ¢¯åº¦ä¸‹é™ç®—æ³•å¯»æ‰¾å…¨å±€æœ€å°å€¼ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201205225126.png" alt="image-20201205225126378"></p><p>çº¿æ€§å›å½’çš„ä»£ä»·å‡½æ•°ä¸º:</p><script type="math/tex; mode=display">J(\theta)=\frac{1}{m} \sum_{i=1}^{m} \frac{1}{2}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right)^{2}</script><p>æˆ‘ä»¬é‡æ–°å®šä¹‰é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ä¸º:</p><script type="math/tex; mode=display">J(\theta)=\frac{1}{m} \sum_{i=1}^{m} \operatorname{cost}\left(h_{\theta}\left(x^{(i)}\right), y^{(i)}\right)</script><p>å…¶ä¸­ï¼Œ</p><script type="math/tex; mode=display">\operatorname{cost}\left(h_{\theta}(x), y\right)=\left\{\begin{aligned}-\log \left(h_{\theta}(x)\right) & \text { if } y=1 \\-\log \left(1-h_{\theta}(x)\right) & \text { if } y=0\end{aligned}\right.</script><p>$h_{\theta}(x)$ ä¸ $\operatorname{cost}\left(h_{\theta}(x), y\right)$ ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201205225317.png" alt="image-20201205225317462"></p><p>è¿™æ ·æ„å»ºçš„ $\operatorname{cost}\left(h_{\theta}(x), y\right)$ å‡½æ•°çš„ç‰¹ç‚¹æ˜¯ï¼šå½“å®é™…çš„ $y=1$ ä¸” $h_{\theta}(x)$ ä¹Ÿä¸º 1 æ—¶è¯¯å·®ä¸º 0 ,å½“ $y=1$ ä½† $h_{\theta}(x)$ ä¸ä¸º 1 æ—¶è¯¯å·®éšç€ $h_{\theta}(x)$ å˜å°è€Œå˜å¤§; å½“å®é™…çš„ $y=0$ ä¸” $h_{\theta}(x)$ ä¹Ÿä¸º 0 æ—¶ä»£ä»·ä¸º $0,$ å½“ $y=0$ ä½† $h_{\theta}(x)$ ä¸ä¸º 0 æ—¶è¯¯å·®éšç€ $h_{\theta}(x)$ çš„å˜å¤§è€Œå˜å¤§ã€‚å°†æ„å»ºçš„ $\operatorname{cost}\left(h_{\theta}(x), y\right)$ ç®€åŒ–å¦‚ä¸‹:</p><script type="math/tex; mode=display">\operatorname{cost}\left(h_{\theta}(x), y\right)=-y \times \log \left(h_{\theta}(x)\right)-(1-y) \times \log \left(1-h_{\theta}(x)\right)</script><p>å¸¦å…¥ä»£ä»·å‡½æ•°å¾—åˆ°:</p><script type="math/tex; mode=display">J(\theta)=\frac{1}{m} \sum_{i=1}^{m}\left[-y^{(i)} \log \left(h_{\theta}\left(x^{(i)}\right)\right)-\left(1-y^{(i)}\right) \log \left(1-h_{\theta}\left(x^{(i)}\right)\right)\right]</script><p>å³: </p><script type="math/tex; mode=display">J(\theta)=-\frac{1}{m} \sum_{i=1}^{m}\left[y^{(i)} \log \left(h_{\theta}\left(x^{(i)}\right)\right)+\left(1-y^{(i)}\right) \log \left(1-h_{\theta}\left(x^{(i)}\right)\right)\right]</script><p>Pythonä»£ç å®ç°ä¸ºï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">def</span> <span class="token function">cost</span><span class="token punctuation">(</span>theta<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>  theta <span class="token operator">=</span> np<span class="token punctuation">.</span>matrix<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>  X <span class="token operator">=</span> np<span class="token punctuation">.</span>matrix<span class="token punctuation">(</span>X<span class="token punctuation">)</span>  y <span class="token operator">=</span> np<span class="token punctuation">.</span>matrix<span class="token punctuation">(</span>y<span class="token punctuation">)</span>  first <span class="token operator">=</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span><span class="token operator">-</span>y<span class="token punctuation">,</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>sigmoid<span class="token punctuation">(</span>X<span class="token operator">*</span> theta<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  second <span class="token operator">=</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> sigmoid<span class="token punctuation">(</span>X<span class="token operator">*</span> theta<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">return</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>first <span class="token operator">-</span> second<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨å¾—åˆ°è¿™æ ·ä¸€ä¸ªä»£ä»·å‡½æ•°ä»¥åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æ¥æ±‚å¾—èƒ½ä½¿ä»£ä»·å‡½æ•°æœ€å°çš„å‚æ•°äº†ã€‚ç®—æ³•ä¸º:</p><script type="math/tex; mode=display">\theta_{j}:=\theta_{j}-\alpha \frac{\partial}{\partial \theta_{j}} J(\theta)</script><p>æ±‚å¯¼åï¼š</p><script type="math/tex; mode=display">\theta_{j}:=\theta_{j}-\alpha \frac{1}{m} \sum_{i=1}^{m}\left(h_{\theta}\left(\mathrm{x}^{(i)}\right)-\mathrm{y}^{(i)}\right) \mathrm{x}_{j}^{(i)}</script><p>ä»£ä»·å‡½æ•°ğ½(ğœƒ)ä¼šæ˜¯ä¸€ ä¸ªå‡¸å‡½æ•°ï¼Œå¹¶ä¸”æ²¡æœ‰å±€éƒ¨æœ€ä¼˜å€¼ã€‚æ¨å¯¼è¿‡ç¨‹:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201205230522.png" alt="image-20201205230522918"></p><p>æ‰€ä»¥ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201205230500.png" alt="image-20201205230500427"></p><p>è™½ç„¶å¾—åˆ°çš„æ¢¯åº¦ä¸‹é™ç®—æ³•è¡¨é¢ä¸Šçœ‹ä¸Šå»ä¸çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸€æ ·ï¼Œä½†æ˜¯è¿™é‡Œçš„$h_ğœƒ(ğ‘¥) = ğ‘”(ğœƒ^ğ‘‡ğ‘‹)$ä¸çº¿æ€§å›å½’ä¸­ä¸åŒï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯ä¸ä¸€æ ·çš„ã€‚å¦å¤–ï¼Œåœ¨è¿è¡Œæ¢¯åº¦ä¸‹é™ç®—æ³• ä¹‹å‰ï¼Œè¿›è¡Œç‰¹å¾ç¼©æ”¾ä¾æ—§æ˜¯éå¸¸å¿…è¦çš„ã€‚ä¸€äº›æ¢¯åº¦ä¸‹é™ç®—æ³•ä¹‹å¤–çš„é€‰æ‹©: é™¤äº†æ¢¯åº¦ä¸‹é™ç®—æ³•ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€äº›å¸¸è¢«ç”¨æ¥ä»¤ä»£ä»·å‡½æ•°æœ€å°çš„ç®—æ³•ï¼Œè¿™äº›ç®—æ³•æ›´åŠ å¤æ‚å’Œä¼˜è¶Šï¼Œè€Œä¸”é€šå¸¸ä¸éœ€è¦äººå·¥é€‰æ‹©å­¦ä¹ ç‡ï¼Œé€šå¸¸æ¯”æ¢¯åº¦ä¸‹é™ç®—æ³•è¦æ›´åŠ å¿«é€Ÿã€‚è¿™äº›ç®—æ³•æœ‰:å…±è½­æ¢¯åº¦ï¼ˆConjugate Gradientï¼‰ï¼Œå±€éƒ¨ä¼˜åŒ–æ³•ï¼ˆBroyden fletcher goldfarb shann,BFGSï¼‰å’Œæœ‰é™å†…å­˜å±€éƒ¨ä¼˜åŒ–æ³•ï¼ˆLBFGSï¼‰</p><h2 id="5-æ¢¯åº¦ä¸‹é™"><a href="#5-æ¢¯åº¦ä¸‹é™" class="headerlink" title="5.æ¢¯åº¦ä¸‹é™"></a>5.æ¢¯åº¦ä¸‹é™</h2><p>å’Œä¹‹å‰çš„çº¿æ€§å›å½’ç±»ä¼¼:</p><script type="math/tex; mode=display">\theta_{j}:=\theta_{j}-\alpha \frac{1}{m} \sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right) x_{j}^{(i)}</script><p>ä½†æ˜¯ç°åœ¨é€»è¾‘å‡½æ•°å‡è®¾å‡½æ•°: $h_{\theta}(x)=\frac{1}{1+e^{-\theta} T_{X}}$ï¼Œå³ä½¿æ›´æ–°å‚æ•°çš„è§„åˆ™çœ‹èµ·æ¥åŸºæœ¬ç›¸åŒï¼Œä½†ç”±äºå‡è®¾çš„å®šä¹‰å‘ç”Ÿäº†å˜åŒ–ï¼Œæ‰€ä»¥é€»è¾‘å‡½æ•°çš„æ¢¯åº¦ä¸‹é™ï¼Œè·Ÿçº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™å®é™…ä¸Šæ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ä¸œè¥¿ã€‚</p><h2 id="6-é«˜çº§ä¼˜åŒ–"><a href="#6-é«˜çº§ä¼˜åŒ–" class="headerlink" title="6.é«˜çº§ä¼˜åŒ–"></a>6.é«˜çº§ä¼˜åŒ–</h2><p>ç„¶è€Œæ¢¯åº¦ä¸‹é™å¹¶ä¸æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„å”¯ä¸€ç®—æ³•ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›ç®—æ³•ï¼Œæ›´é«˜çº§ã€æ›´å¤æ‚ã€‚å¦‚æœæˆ‘ä»¬èƒ½ç”¨è¿™äº›æ–¹æ³•æ¥è®¡ç®—ä»£ä»·å‡½æ•° $J(\theta)$ å’Œåå¯¼æ•°é¡¹ $\frac{\partial}{\partial \theta_{j}} J(\theta)$ ä¸¤ä¸ªé¡¹çš„è¯ï¼Œé‚£ä¹ˆè¿™äº›ç®—æ³•å°±æ˜¯ä¸ºæˆ‘ä»¬ä¼˜åŒ–ä»£ä»·å‡½æ•°çš„ä¸åŒæ–¹æ³•ï¼Œå…±è½©æ¢¯åº¦æ³• BFGS ï¼ˆå˜å°ºåº¦æ³•ï¼‰å’Œ L-BFGS ï¼ˆé™åˆ¶å˜å°ºåº¦æ³•ï¼‰å°±æ˜¯å…¶ä¸­ä¸€äº›æ›´é«˜çº§çš„ä¼˜åŒ–ç®—æ³•ï¼Œå®ƒä»¬éœ€è¦æœ‰ä¸€ç§æ–¹æ³•æ¥è®¡ç®— ğ½(ğœƒ)ï¼Œä»¥åŠéœ€è¦ä¸€ç§æ–¹æ³• è®¡ç®—å¯¼æ•°é¡¹ï¼Œç„¶åä½¿ç”¨æ¯”æ¢¯åº¦ä¸‹é™æ›´å¤æ‚çš„ç®—æ³•æ¥æœ€å°åŒ–ä»£ä»·å‡½æ•°ã€‚</p><h2 id="7-å¤šç±»åˆ«åˆ†ç±»-ä¸€å¯¹å¤š"><a href="#7-å¤šç±»åˆ«åˆ†ç±»-ä¸€å¯¹å¤š" class="headerlink" title="7.å¤šç±»åˆ«åˆ†ç±»:ä¸€å¯¹å¤š"></a>7.å¤šç±»åˆ«åˆ†ç±»:ä¸€å¯¹å¤š</h2><p>ç„¶è€Œå¯¹äºä¹‹å‰çš„ä¸€ä¸ªï¼ŒäºŒå…ƒåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬çš„æ•°æ®çœ‹èµ·æ¥å¯èƒ½æ˜¯åƒè¿™æ ·:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206000542.png" alt="image-20201206000542702"></p><p>å¯¹äºä¸€ä¸ªå¤šç±»åˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†æˆ–è®¸çœ‹èµ·æ¥åƒè¿™æ ·:</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206000556.png" alt="image-20201206000556885"></p><p>æˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“å¦‚ä½•è¿›è¡ŒäºŒå…ƒåˆ†ç±»ï¼Œå¯ä»¥ä½¿ç”¨é€»è¾‘å›å½’ï¼Œå¯¹äºç›´çº¿æˆ–è®¸ä½ ä¹ŸçŸ¥é“ï¼Œå¯ä»¥å°†æ•°æ®é›†ä¸€åˆ†ä¸ºäºŒä¸ºæ­£ç±»å’Œè´Ÿç±»ã€‚ç”¨ä¸€å¯¹å¤šçš„åˆ†ç±»æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç”¨åœ¨å¤šç±»åˆ†ç±»é—®é¢˜ ä¸Šã€‚ä¸‹é¢å°†ä»‹ç»å¦‚ä½•è¿›è¡Œä¸€å¯¹å¤šçš„åˆ†ç±»å·¥ä½œï¼Œæœ‰æ—¶è¿™ä¸ªæ–¹æ³•ä¹Ÿè¢«ç§°ä¸ºâ€ä¸€å¯¹ä½™â€æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206000949.png" alt="image-20201206000949232"></p><p>æ–¹æ³•å°±æ˜¯å°†å¤šåˆ†ç±»é—®é¢˜è½¬åŒ–æˆå¤šä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œä¾‹å¦‚ä¸Šå›¾å…ˆæŠŠé™¤äº†ä¸‰è§’å½¢çš„å…¨è§†ä¸ºä¸€ç±»ï¼Œè½¬åŒ–æˆä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ã€‚ä¸ºäº†èƒ½å®ç°è¿™æ ·çš„è½¬å˜ï¼Œæˆ‘ä»¬å°†å¤šä¸ªç±»ä¸­çš„ä¸€ä¸ªç±»æ ‡è®°ä¸ºæ­£å‘ç±»ï¼ˆ $y=1$ï¼‰ ï¼Œç„¶åå°†å…¶ä»–æ‰€æœ‰ç±»éƒ½æ ‡è®°ä¸ºè´Ÿå‘ç±»ï¼Œè¿™ä¸ªæ¨¡å‹è®°ä½œ $h_{\theta}^{(1)}(x)_{\circ}$ æ¥ç€ï¼Œç±»ä¼¼åœ°ç¬¬æˆ‘ä»¬é€‰æ‹©å¦ä¸€ä¸ªç±»æ ‡è®°ä¸ºæ­£å‘ç±» $(y=2)$ ï¼Œå†å°†å…¶å®ƒç±»éƒ½æ ‡è®°ä¸ºè´Ÿå‘ç±»ï¼Œå°†è¿™ä¸ªæ¨¡å‹è®°ä½œ $h_{\theta}^{(2)}(x)$,ä¾æ­¤ç±»æ¨ã€‚æœ€åæˆ‘ä»¬å¾—åˆ°ä¸€ç³»åˆ—çš„æ¨¡å‹ç®€è®°ä¸º: $\quad h_{\theta}^{(i)}(x)=p(y=i \mid x ; \theta)$ å…¶ä¸­: $i=(1,2,3 \ldots k)$</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206001229.png" alt="image-20201206001229747"></p><p>æœ€åï¼Œå°†æ‰€æœ‰çš„åˆ†ç±»æœºéƒ½è¿è¡Œä¸€éï¼Œç„¶åå¯¹æ¯ä¸€ä¸ªè¾“å…¥å˜é‡ï¼Œ éƒ½é€‰æ‹©æœ€é«˜å¯èƒ½æ€§çš„è¾“å‡ºå˜é‡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> é€»è¾‘å›å½’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>01_çº¿æ€§å›å½’_Linear_Regression</title>
      <link href="2020/12/03/machinelearning/wu-en-da-ji-qi-xue-xi/01-linear-regression/"/>
      <url>2020/12/03/machinelearning/wu-en-da-ji-qi-xue-xi/01-linear-regression/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¿æ€§å›å½’"><a href="#çº¿æ€§å›å½’" class="headerlink" title="çº¿æ€§å›å½’"></a>çº¿æ€§å›å½’</h1><p>å›å½’æœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨ç¦»æ•£çš„å€¼æ¥è¯•ç€æ¨æµ‹å‡ºä¸€ä¸ªè¿ç»­å€¼çš„ç»“æœï¼Œå¯¹å…¶ä»–å€¼è¿›è¡Œé¢„æµ‹</p><h2 id="1-å•å˜é‡çº¿æ€§å›å½’ï¼ˆLinear-Regression-with-One-Variableï¼‰"><a href="#1-å•å˜é‡çº¿æ€§å›å½’ï¼ˆLinear-Regression-with-One-Variableï¼‰" class="headerlink" title="1 å•å˜é‡çº¿æ€§å›å½’ï¼ˆLinear Regression with One Variableï¼‰"></a>1 å•å˜é‡çº¿æ€§å›å½’ï¼ˆLinear Regression with One Variableï¼‰</h2><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201202232210.png" alt="image-20201202232210402"></p><h3 id="1-1-ä¾‹å­æˆ¿ä»·é¢„æµ‹é—®é¢˜ï¼š"><a href="#1-1-ä¾‹å­æˆ¿ä»·é¢„æµ‹é—®é¢˜ï¼š" class="headerlink" title="1.1 ä¾‹å­æˆ¿ä»·é¢„æµ‹é—®é¢˜ï¼š"></a>1.1 ä¾‹å­æˆ¿ä»·é¢„æµ‹é—®é¢˜ï¼š</h3><p>å‡ä½¿å›å½’é—®é¢˜çš„è®­ç»ƒé›†ï¼ˆTraining Setï¼‰å¦‚ä¸‹è¡¨æ‰€ç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201202232330.png" alt="image-20201202232330802"></p><p>æˆ‘ä»¬å°†è¦ç”¨æ¥æè¿°è¿™ä¸ªå›å½’é—®é¢˜çš„æ ‡è®°å¦‚ä¸‹: </p><ul><li><p>$ğ‘š$ä»£è¡¨è®­ç»ƒé›†ä¸­å®ä¾‹çš„æ•°é‡</p></li><li><p>$ğ‘¥$ ä»£è¡¨ç‰¹å¾/è¾“å…¥å˜é‡</p></li><li>$ğ‘¦$ ä»£è¡¨ç›®æ ‡å˜é‡/è¾“å‡ºå˜é‡</li><li>$(ğ‘¥,ğ‘¦)$ ä»£è¡¨è®­ç»ƒé›†ä¸­çš„å®ä¾‹</li><li>$(ğ‘¥^{(ğ‘–)},ğ‘¦^{(ğ‘–)})$ä»£è¡¨ç¬¬$ğ‘–$ ä¸ªè§‚å¯Ÿå®ä¾‹</li><li>$h$ ä»£è¡¨å­¦ä¹ ç®—æ³•çš„è§£å†³æ–¹æ¡ˆæˆ–å‡½æ•°ä¹Ÿç§°ä¸ºå‡è®¾(hypothesis)</li></ul><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201202232830.png" alt="image-20201202232830677"></p><p>æˆ‘ä»¬è¯¥å¦‚ä½•è¡¨è¾¾ h?</p><p>ä¸€ç§å¯èƒ½çš„è¡¨è¾¾æ–¹å¼ä¸º:$h_ğœƒ(ğ‘¥) = ğœƒ_0 + ğœƒ_1ğ‘¥$ï¼Œå› ä¸ºåªå«æœ‰ä¸€ä¸ªç‰¹å¾/è¾“å…¥å˜é‡ï¼Œå› æ­¤è¿™æ · çš„é—®é¢˜å«ä½œå•å˜é‡çº¿æ€§å›å½’é—®é¢˜ã€‚</p><h3 id="1-2-ä»£ä»·å‡½æ•°"><a href="#1-2-ä»£ä»·å‡½æ•°" class="headerlink" title="1.2 ä»£ä»·å‡½æ•°"></a>1.2 ä»£ä»·å‡½æ•°</h3><h4 id="è¯¯å·®å®šä¹‰ï¼š"><a href="#è¯¯å·®å®šä¹‰ï¼š" class="headerlink" title="è¯¯å·®å®šä¹‰ï¼š"></a>è¯¯å·®å®šä¹‰ï¼š</h4><p>é¢„æµ‹å€¼ä¸å®é™…å€¼çš„çš„å·®è·ã€‚$h_ğœƒ(x)-y$</p><h4 id="ä»£ä»·å‡½æ•°"><a href="#ä»£ä»·å‡½æ•°" class="headerlink" title="ä»£ä»·å‡½æ•°"></a>ä»£ä»·å‡½æ•°</h4><p>å¯¹äº$h_ğœƒ(ğ‘¥) = ğœƒ_0 + ğœƒ_1ğ‘¥$ï¼Œç›®çš„æ˜¯æ‰¾åˆ°ä¸¤ä¸ªå˜é‡$ğœƒ_0,ğœƒ_1$æ¥ä½¿å¾—æ•´ä½“è¯¯å·®çš„å€¼æœ€å°ï¼Œå³è¯¯å·®å¹³æ–¹å’Œæœ€å°ï¼Œä»£ä»·å…¬å¼ä¸ºï¼š</p><script type="math/tex; mode=display">MSE=J\left(\theta_{0}, \theta_{1}\right)=\frac{1}{2 m} \sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right)^{2}</script><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201202233929.png" alt="image-20201202233929481"></p><h3 id="1-3-æ¢¯åº¦ä¸‹é™"><a href="#1-3-æ¢¯åº¦ä¸‹é™" class="headerlink" title="1.3 æ¢¯åº¦ä¸‹é™"></a>1.3 æ¢¯åº¦ä¸‹é™</h3><p>æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼ˆbatch gradient descentï¼‰:</p><script type="math/tex; mode=display">\begin{aligned}&\text { repeat until convergence \{}\\&\theta_{j}:=\theta_{j}-\alpha \frac{\partial}{\partial \theta_{j}} J\left(\theta_{0}, \theta_{1}\right) \quad(\text { for } j=0 \text { and } j=1)\\&\text{\}}\end{aligned}</script><p>å…¶ä¸­$ğ‘$æ˜¯å­¦ä¹ ç‡ï¼ˆlearning rateï¼‰ï¼Œå®ƒå†³å®šäº†æˆ‘ä»¬æ²¿ç€èƒ½è®©ä»£ä»·å‡½æ•°ä¸‹é™ç¨‹åº¦æœ€å¤§çš„æ–¹å‘ å‘ä¸‹è¿ˆå‡ºçš„æ­¥å­æœ‰å¤šå¤§ï¼Œåœ¨æ‰¹é‡æ¢¯åº¦ä¸‹é™ä¸­ï¼Œæˆ‘ä»¬æ¯ä¸€æ¬¡éƒ½åŒæ—¶è®©æ‰€æœ‰çš„å‚æ•°å‡å»å­¦ä¹ é€Ÿç‡ä¹˜ä»¥ä»£ä»·å‡½æ•°çš„å¯¼æ•°ï¼Œå‚æ•°æ›´æ–°çš„æ­¥éª¤å¦‚ä¸‹</p><script type="math/tex; mode=display">\begin{array}{l}\text { temp } 0:=\theta_{0}-\alpha \frac{\partial}{\partial \theta_{0}} J\left(\theta_{0}, \theta_{1}\right) \\\text { templ }:=\theta_{1}-\alpha \frac{\partial}{\partial \theta_{1}} J\left(\theta_{0}, \theta_{1}\right) \\\theta_{0}:=\text { temp } 0 \\\theta_{1}:=\text { temp } 1\end{array}</script><ul><li>$a$å¤ªå°æ”¶æ•›é€Ÿåº¦å¤ªæ…¢</li><li>$a$å¤ªå¤§å¯èƒ½ä¸æ”¶æ•›</li></ul><h3 id="1-4-æ¢¯åº¦ä¸‹é™çš„çº¿æ€§å›å½’"><a href="#1-4-æ¢¯åº¦ä¸‹é™çš„çº¿æ€§å›å½’" class="headerlink" title="1.4 æ¢¯åº¦ä¸‹é™çš„çº¿æ€§å›å½’"></a>1.4 æ¢¯åº¦ä¸‹é™çš„çº¿æ€§å›å½’</h3><script type="math/tex; mode=display">\begin{array}{c}\frac{\partial}{\partial \theta_{j}} J\left(\theta_{0}, \theta_{1}\right)=\frac{\partial}{\partial \theta_{j}} \frac{1}{2 m} \sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right)^{2} \\j=0 \text { æ—¶: } \frac{\partial}{\partial \theta_{0}} J\left(\theta_{0}, \theta_{1}\right)=\frac{1}{m} \sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right) \\j=1 \text { æ—¶: } \quad \frac{\partial}{\partial \theta_{1}} J\left(\theta_{0}, \theta_{1}\right)=\frac{1}{m} \sum_{i=1}^{m}\left(\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right) \cdot x^{(i)}\right)\end{array}</script><h2 id="2-å¤šå˜é‡çº¿æ€§å›å½’ï¼ˆLinear-Regression-with-Multiple-Variablesï¼‰"><a href="#2-å¤šå˜é‡çº¿æ€§å›å½’ï¼ˆLinear-Regression-with-Multiple-Variablesï¼‰" class="headerlink" title="2 å¤šå˜é‡çº¿æ€§å›å½’ï¼ˆLinear Regression with Multiple Variablesï¼‰"></a>2 å¤šå˜é‡çº¿æ€§å›å½’ï¼ˆLinear Regression with Multiple Variablesï¼‰</h2><p>å¯¹ä¸Šé¢çš„æ¨¡å‹å¢åŠ æ›´å¤šçš„ç‰¹å¾ï¼Œæ¨¡å‹ä¸­çš„ç‰¹å¾ä¸º$(x_1,x_2,â€¦.,x_n)$</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201203163630.png" alt="image-20201203150333545"></p><p>å¢æ·»æ›´å¤šç‰¹å¾åï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ç³»åˆ—æ–°çš„æ³¨é‡Š:</p><ul><li><p>$ğ‘›$ ä»£è¡¨ç‰¹å¾çš„æ•°é‡</p></li><li><p>$ğ‘¥^{(ğ‘–)}$ä»£è¡¨ç¬¬ $ğ‘–$ ä¸ªè®­ç»ƒå®ä¾‹ï¼Œæ˜¯ç‰¹å¾çŸ©é˜µä¸­çš„ç¬¬$ğ‘–$è¡Œï¼Œæ˜¯ä¸€ä¸ªå‘é‡(vector)ã€‚</p></li><li><p>æ¯”æ–¹è¯´ï¼Œä¸Šå›¾çš„</p><script type="math/tex; mode=display">x^{(2)}=\left[\begin{array}{c}1416 \\3 \\2 \\40\end{array}\right]</script></li><li><p>$ğ‘¥^{(ğ‘–)}_j$ä»£è¡¨ç‰¹å¾çŸ©é˜µä¸­ç¬¬$ ğ‘–$ è¡Œçš„ç¬¬$ğ‘—$ä¸ªç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯ç¬¬ ğ‘– ä¸ªè®­ç»ƒå®ä¾‹çš„ç¬¬ ğ‘— ä¸ªç‰¹å¾ã€‚</p></li><li><p>å¦‚ä¸Šå›¾çš„$\mid x_{2}^{(2)}=3, x_{3}^{(2)}=2$</p></li><li><p>æ”¯æŒå¤šå˜é‡çš„å‡è®¾ h è¡¨ç¤ºä¸º:$h_{\theta}(x)=\theta_{0}+\theta_{1} x_{1}+\theta_{2} x_{2}+\ldots+\theta_{n} x_{n}$</p></li><li><p>è¿™ä¸ªå…¬å¼ä¸­æœ‰ğ‘› + 1ä¸ªå‚æ•°å’Œğ‘›ä¸ªå˜é‡ï¼Œä¸ºäº†ä½¿å¾—å…¬å¼èƒ½å¤Ÿç®€åŒ–ä¸€äº›ï¼Œå¼•å…¥$ğ‘¥_0 = 1$ï¼Œåˆ™å…¬ å¼è½¬åŒ–ä¸º:$h_{\theta}(x)=\theta_{0} x_{0}+\theta_{1} x_{1}+\theta_{2} x_{2}+\ldots+\theta_{n} x_{n}$</p></li><li><p>æ­¤æ—¶æ¨¡å‹ä¸­çš„å‚æ•°æ˜¯ä¸€ä¸ª$ğ‘› + 1$ç»´çš„å‘é‡ï¼Œä»»ä½•ä¸€ä¸ªè®­ç»ƒå®ä¾‹ä¹Ÿéƒ½æ˜¯ğ‘› + 1ç»´çš„å‘é‡ï¼Œç‰¹ å¾çŸ©é˜µğ‘‹çš„ç»´åº¦æ˜¯ $ğ‘š âˆ— (ğ‘› + 1)$ã€‚ å› æ­¤å…¬å¼å¯ä»¥ç®€åŒ–ä¸º:$h_ğœƒ(ğ‘¥) = ğœƒ^ğ‘‡ğ‘‹$ï¼Œå…¶ä¸­ä¸Šæ ‡ğ‘‡ä»£è¡¨çŸ©é˜µè½¬ç½®ã€‚</p></li></ul><h3 id="2-1-å¤šå˜é‡æ¢¯åº¦ä¸‹é™Gradient-Descent-for-Multiple-Variables"><a href="#2-1-å¤šå˜é‡æ¢¯åº¦ä¸‹é™Gradient-Descent-for-Multiple-Variables" class="headerlink" title="2.1 å¤šå˜é‡æ¢¯åº¦ä¸‹é™Gradient Descent for Multiple Variables"></a>2.1 å¤šå˜é‡æ¢¯åº¦ä¸‹é™Gradient Descent for Multiple Variables</h3><p>ä¸å•å˜é‡çº¿æ€§å›å½’ç±»ä¼¼ï¼Œåœ¨å¤šå˜é‡çº¿æ€§å›å½’ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæ„å»ºä¸€ä¸ªä»£ä»·å‡½æ•°ï¼Œåˆ™è¿™ä¸ªä»£ä»· å‡½æ•°æ˜¯æ‰€æœ‰å»ºæ¨¡è¯¯å·®çš„å¹³æ–¹å’Œï¼Œå³:</p><script type="math/tex; mode=display">J\left(\theta_{0}, \theta_{1} \ldots \theta_{n}\right)=\frac{1}{2 m} \sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right)^{2}</script><p>æ¢¯åº¦ä¸‹é™ç®—æ³•æ±‚å¯¼åï¼š</p><p>Repeatï¼š</p><script type="math/tex; mode=display">\theta_{j}:=\theta_{j}-\alpha \frac{1}{m} \sum_{i=1}^{m}\left(\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right) \cdot x_{j}^{(i)}\right)</script><p>( simultaneously update  $\theta_{j}$$ \text { for } \mathrm{j}=0,1, \ldots, \mathrm{n})$</p><p>è®¡ç®—Costå‡½æ•°Pythonä»£ç ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">computeCost</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">:</span>  inner <span class="token operator">=</span> np<span class="token punctuation">.</span>power<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>X <span class="token operator">*</span> theta<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>   <span class="token keyword">return</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>inner<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="2-2-æ¢¯åº¦ä¸‹é™æ³•å®è·µ-1-ç‰¹å¾ç¼©æ”¾"><a href="#2-2-æ¢¯åº¦ä¸‹é™æ³•å®è·µ-1-ç‰¹å¾ç¼©æ”¾" class="headerlink" title="2.2 æ¢¯åº¦ä¸‹é™æ³•å®è·µ 1-ç‰¹å¾ç¼©æ”¾"></a>2.2 æ¢¯åº¦ä¸‹é™æ³•å®è·µ 1-ç‰¹å¾ç¼©æ”¾</h3><p>Gradient Descent in Practice I - Feature Scaling</p><p>åœ¨æˆ‘ä»¬é¢å¯¹å¤šç»´ç‰¹å¾é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦ä¿è¯è¿™äº›ç‰¹å¾éƒ½å…·æœ‰ç›¸è¿‘çš„å°ºåº¦ï¼Œè¿™å°†å¸®åŠ©æ¢¯åº¦ä¸‹é™ç®—æ³•æ›´å¿«åœ°æ”¶æ•›ï¼Œè§£å†³çš„æ–¹æ³•æ˜¯å°è¯•å°†æ‰€æœ‰ç‰¹å¾çš„å°ºåº¦éƒ½å°½é‡ç¼©æ”¾åˆ°-1åˆ°1ä¹‹é—´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201203153342.png" alt="image-20201203153342751"></p><p>æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä»¤:$x_{n}=\frac{x_{n}-\mu_{n}}{s_{n}},$ å…¶ä¸­ $\mu_{n}$ æ˜¯å¹³å‡å€¼, $s_{n}$ æ˜¯æ ‡å‡†å·®ã€‚</p><h3 id="2-3-æ¢¯åº¦ä¸‹é™æ³•å®è·µ-2-å­¦ä¹ ç‡"><a href="#2-3-æ¢¯åº¦ä¸‹é™æ³•å®è·µ-2-å­¦ä¹ ç‡" class="headerlink" title="2.3 æ¢¯åº¦ä¸‹é™æ³•å®è·µ 2-å­¦ä¹ ç‡"></a>2.3 æ¢¯åº¦ä¸‹é™æ³•å®è·µ 2-å­¦ä¹ ç‡</h3><p>Gradient Descent in Practice II - Learning Rate</p><p>æ¢¯åº¦ä¸‹é™ç®—æ³•çš„æ¯æ¬¡è¿­ä»£å—åˆ°å­¦ä¹ ç‡çš„å½±å“ï¼Œå¦‚æœå­¦ä¹ ç‡ğ‘è¿‡å°ï¼Œåˆ™è¾¾åˆ°æ”¶æ•›æ‰€éœ€çš„è¿­ ä»£æ¬¡æ•°ä¼šéå¸¸é«˜;å¦‚æœå­¦ä¹ ç‡ğ‘è¿‡å¤§ï¼Œæ¯æ¬¡è¿­ä»£å¯èƒ½ä¸ä¼šå‡å°ä»£ä»·å‡½æ•°ï¼Œå¯èƒ½ä¼šè¶Šè¿‡å±€éƒ¨æœ€ å°å€¼å¯¼è‡´æ— æ³•æ”¶æ•›ã€‚</p><h3 id="2-4-ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’"><a href="#2-4-ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’" class="headerlink" title="2.4 ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’"></a>2.4 ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’</h3><p>çº¿æ€§å›å½’å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰æ•°æ®ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦æ›²çº¿æ¥é€‚åº”æˆ‘ä»¬çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸€ä¸ªäºŒæ¬¡æ–¹æ¨¡å‹: $h_{\theta}(x)=\theta_{0}+\theta_{1} x_{1}+\theta_{2} x_{2}^{2}$<br>æˆ–è€…ä¸‰æ¬¡æ–¹æ¨¡å‹: $\quad h_{\theta}(x)=\theta_{0}+\theta_{1} x_{1}+\theta_{2} x_{2}^{2}+\theta_{3} x_{3}^{3}$</p><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201203155639.png" alt="image-20201203155639868"></p><p>é€šå¸¸æˆ‘ä»¬éœ€è¦å…ˆè§‚å¯Ÿæ•°æ®ç„¶åå†å†³å®šå‡†å¤‡å°è¯•æ€æ ·çš„æ¨¡å‹ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä»¤ï¼š$x_{2}=x_{2}^{2}, x_{3}=x_{3}^{3},$ ä»è€Œå°†æ¨¡å‹è½¬åŒ–ä¸ºçº¿æ€§å›å½’æ¨¡å‹ã€‚</p><p>ä»è€Œå°†æ¨¡å‹è½¬åŒ–ä¸ºçº¿æ€§å›å½’æ¨¡å‹ã€‚</p><h3 id="2-5-æ­£è§„æ–¹ç¨‹"><a href="#2-5-æ­£è§„æ–¹ç¨‹" class="headerlink" title="2.5 æ­£è§„æ–¹ç¨‹"></a>2.5 æ­£è§„æ–¹ç¨‹</h3><p>æ­£è§„æ–¹ç¨‹æ˜¯é€šè¿‡æ±‚è§£ä¸‹é¢çš„æ–¹ç¨‹æ¥æ‰¾å‡ºä½¿å¾—ä»£ä»·å‡½æ•°æœ€å°çš„å‚æ•°çš„ $ï¼š \frac{\partial}{\partial \theta_{j}} J\left(\theta_{j}\right)=0$ï¼Œå‡è®¾æˆ‘ä»¬çš„è®­ç»ƒé›†ç‰¹å¾çŸ©é˜µä¸º Xï¼ˆåŒ…å«äº† $x_{0}=1$ ï¼‰å¹¶ä¸”æˆ‘ä»¬çš„è®­ç»ƒé›†ç»“æœä¸ºå‘é‡ yï¼Œåˆ™åˆ©ç”¨æ­£è§„æ–¹ç¨‹è§£å‡ºå‘é‡ $\theta=\left(X^{T} X\right)^{-1} X^{T} y$ ã€‚ä¸Šæ ‡ T ä»£è¡¨çŸ©é˜µè½¬ç½®ï¼Œä¸Šæ ‡-1 ä»£è¡¨çŸ©é˜µçš„é€†ã€‚è®¾çŸ©é˜µ $A=X^{T} X,$ åˆ™: $\left(X^{T} X\right)^{-1}=A^{-1}$</p><p> æ¢¯åº¦ä¸‹é™ä¸æ­£è§„æ–¹ç¨‹çš„æ¯”è¾ƒ:</p><div class="table-container"><table><thead><tr><th style="text-align:left">æ¢¯åº¦ä¸‹é™</th><th>æ­£è§„æ–¹ç¨‹</th></tr></thead><tbody><tr><td style="text-align:left">éœ€è¦é€‰æ‹©å­¦ä¹ ç‡ğ›¼</td><td>ä¸éœ€è¦</td></tr><tr><td style="text-align:left">éœ€è¦å¤šæ¬¡è¿­ä»£</td><td>ä¸€æ¬¡è¿ç®—å¾—å‡º</td></tr><tr><td style="text-align:left">å½“ç‰¹å¾æ•°é‡ğ‘›å¤§æ—¶ä¹Ÿèƒ½è¾ƒå¥½é€‚ç”¨</td><td>éœ€è¦è®¡ç®— $\left(X^{T} X\right)^{-1}$ å¦‚æœç‰¹å¾æ•°é‡ $n$ è¾ƒå¤§åˆ™è¿ç®—ä»£ä»·å¤§, å› ä¸ºçŸ©é˜µé€†çš„è®¡ç®—æ—¶é—´å¤æ‚åº¦ ä¸º $O\left(n^{3}\right),$ é€šå¸¸æ¥è¯´å½“nå°äº10000 æ—¶è¿˜æ˜¯ å¯ä»¥æ¥å—çš„</td></tr><tr><td style="text-align:left">é€‚ç”¨äºå„ç§ç±»å‹çš„æ¨¡å‹</td><td>åªé€‚ç”¨äºçº¿æ€§æ¨¡å‹ï¼Œä¸é€‚åˆé€»è¾‘å›å½’æ¨¡å‹ç­‰ å…¶ä»–æ¨¡å‹</td></tr></tbody></table></div><p>æ­£è§„æ–¹ç¨‹çš„pythonå®ç°ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token keyword">def</span> <span class="token function">normalEqn</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>  theta <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T@X<span class="token punctuation">)</span>@X<span class="token punctuation">.</span>T@y <span class="token comment">#X.T@X ç­‰ä»·äº X.T.dot(X) </span>  <span class="token keyword">return</span> theta<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å´æ©è¾¾â€”â€”æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å´æ©è¾¾ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> çº¿æ€§å›å½’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter_03_Dictionaries_and_Sets</title>
      <link href="2020/12/03/python/fluentpython/chapter-03-dictionaries-and-sets/"/>
      <url>2020/12/03/python/fluentpython/chapter-03-dictionaries-and-sets/</url>
      
        <content type="html"><![CDATA[<h2 id="3-1-dict"><a href="#3-1-dict" class="headerlink" title="3.1 dict"></a>3.1 dict</h2><h3 id="æ³›æ˜ å°„ç±»å‹"><a href="#æ³›æ˜ å°„ç±»å‹" class="headerlink" title="æ³›æ˜ å°„ç±»å‹"></a>æ³›æ˜ å°„ç±»å‹</h3><ul><li>collections.abcä¸­æœ‰Mappingå’ŒMutableMappingè¿™ä¸¤ä¸ªæŠ½è±¡ç±»ï¼Œä½œç”¨dictçš„æ¥å£<br><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201201112313.png" alt="Mutable Mapping"></li><li>dictåªæœ‰<strong>å¯æ•£åˆ—çš„</strong>æ•°æ®ç±»å‹æ‰èƒ½ä½œç”¨è¿™äº›æ˜ å°„é‡Œçš„é”®</li><li>å¯æ•£åˆ—å¯¹è±¡éœ€è¦å®ç°__hash__,__eq__</li><li>strï¼Œbytesï¼Œfrozensetæ˜¯å¯æ•£åˆ—çš„ï¼Œå¦‚æœtupleä¸­æ‰€æœ‰å…ƒç´ æ˜¯å¯æ•£åˆ—çš„ï¼Œé‚£ä¹ˆtupleä¹Ÿæ˜¯å¯æ•£åˆ—çš„</li><li>ä¸€èˆ¬ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»å‹å¯¹è±¡éƒ½æ˜¯å¯æ•£åˆ—çš„ï¼Œid()å‡½æ•°çš„è¿”å›å€¼å°±æ˜¯æ•£åˆ—å€¼</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">tt<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hash</span><span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span class="token punctuation">)</span>tt<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hash</span><span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>-2725224101759650258</p><hr><p>TypeError Traceback (most recent call last)</p><p><ipython-input-1-083a0773f165> in <module>       2 print(hash(tt))<br>      3 tt=(1,2,[3,4])<br>â€”â€”&gt; 4 print(hash(tt))<br>TypeError: unhashable type: â€˜listâ€™</module></ipython-input-1-083a0773f165></p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># dictçš„åˆ›å»ºæ–¹å¼</span>a <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>one<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> two<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> three<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'one'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>c <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'three'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>a<span class="token operator">==</span>b<span class="token operator">==</span>c<span class="token operator">==</span>d<span class="token operator">==</span>e<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>True</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># dict æ¨å¯¼</span>DIAL_CODES <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">(</span><span class="token number">86</span><span class="token punctuation">,</span> <span class="token string">'China'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token number">91</span><span class="token punctuation">,</span> <span class="token string">'India'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'United States'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token string">'Indonesia'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token string">'Brazil'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token number">92</span><span class="token punctuation">,</span> <span class="token string">'Pakistan'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token number">880</span><span class="token punctuation">,</span> <span class="token string">'Bangladesh'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token number">234</span><span class="token punctuation">,</span> <span class="token string">'Nigeria'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'Russia'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token number">81</span><span class="token punctuation">,</span> <span class="token string">'Japan'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span>country_code <span class="token operator">=</span> <span class="token punctuation">{</span>country<span class="token punctuation">:</span> code <span class="token keyword">for</span> code<span class="token punctuation">,</span> country <span class="token keyword">in</span> DIAL_CODES<span class="token punctuation">}</span><span class="token keyword">print</span><span class="token punctuation">(</span>country_code<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>{â€˜Chinaâ€™: 86, â€˜Indiaâ€™: 91, â€˜United Statesâ€™: 1, â€˜Indonesiaâ€™: 62, â€˜Brazilâ€™: 55, â€˜Pakistanâ€™: 92, â€˜Bangladeshâ€™: 880, â€˜Nigeriaâ€™: 234, â€˜Russiaâ€™: 7, â€˜Japanâ€™: 81}</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#d.get(k,default)æ¥ä»£æ›¿d[k],å¦‚æœæ²¡æœ‰æŸ¥æ‰¾åˆ°å°±è¿”å›é»˜è®¤å€¼</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> reWORD_RE <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'\w+'</span><span class="token punctuation">)</span>index <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'poetry.txt'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    <span class="token keyword">for</span> line_no<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> match <span class="token keyword">in</span> WORD_RE<span class="token punctuation">.</span>finditer<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">:</span>            word <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span>            column_no <span class="token operator">=</span> match<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>            location <span class="token operator">=</span> <span class="token punctuation">(</span>line_no<span class="token punctuation">,</span> column_no<span class="token punctuation">)</span>            occurrences <span class="token operator">=</span> index<span class="token punctuation">.</span>get<span class="token punctuation">(</span>word<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#</span>            occurrences<span class="token punctuation">.</span>append<span class="token punctuation">(</span>location<span class="token punctuation">)</span>            index<span class="token punctuation">[</span>word<span class="token punctuation">]</span> <span class="token operator">=</span> occurrences<span class="token keyword">for</span> word <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> index<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>a [(1, 22), (2, 7), (3, 6), (8, 7), (8, 27), (10, 19), (12, 6), (17, 20), (21, 19)]<br>A [(17, 1)]<br>above [(34, 34)]<br>ago [(1, 29), (15, 36)]<br>all [(26, 30), (43, 9)]<br>and [(1, 13), (6, 17), (8, 15), (11, 6), (13, 16), (25, 21), (29, 13), (44, 37)]<br>And [(5, 1), (15, 1), (20, 4), (34, 1), (41, 1), (43, 1)]<br>angels [(24, 5), (34, 17)]<br>Annabel [(4, 19), (11, 13), (18, 17), (29, 28), (37, 21), (40, 21), (42, 21)]<br>as [(26, 27)]<br>away [(20, 17)]<br>be [(6, 21)]<br>beams [(39, 20)]<br>beautiful [(18, 7), (37, 11), (40, 11), (42, 11)]<br>blew [(17, 8)]<br>bore [(20, 8)]<br>bride [(44, 44)]<br>bright [(41, 42)]<br>bringing [(39, 35)]<br>But [(10, 1), (31, 1)]<br>but [(41, 27)]<br>by [(2, 17), (6, 30), (9, 20), (16, 20), (22, 20), (27, 20), (28, 37), (31, 30), (43, 40), (45, 27), (46, 16)]<br>By [(4, 4)]<br>came [(19, 30), (28, 15)]<br>Can [(36, 1)]<br>child [(8, 9), (8, 29)]<br>chilling [(17, 29)]<br>Chilling [(29, 4)]<br>cloud [(17, 22), (28, 31)]<br>Coveted [(13, 4)]<br>darling [(44, 10), (44, 21)]<br>demons [(35, 12)]<br>dissever [(36, 10)]<br>down [(35, 19), (43, 35)]<br>dreams [(39, 47)]<br>envying [(25, 9)]<br>ever [(36, 5)]<br>eyes [(41, 49)]<br>far [(31, 33), (33, 12)]<br>feel [(41, 33)]<br>For [(39, 1)]<br>from [(20, 22), (36, 27)]<br>half [(24, 17)]<br>happy [(24, 25)]<br>Heaven [(12, 40), (24, 34), (34, 27)]<br>her [(13, 12), (19, 9), (20, 13), (21, 9), (25, 17), (45, 7), (46, 7)]<br>highborn [(19, 13)]<br>I [(8, 1), (11, 4), (41, 31), (43, 29)]<br>In [(2, 4), (9, 4), (16, 4), (22, 4), (27, 4), (45, 4), (46, 4)]<br>in [(21, 16), (24, 31), (34, 24)]<br>It [(1, 1)]<br>it [(31, 14)]<br>killing [(29, 17)]<br>kingdom [(2, 9), (9, 12), (16, 12), (22, 12), (27, 12)]<br>kinsmen [(19, 22)]<br>know [(3, 40), (26, 38)]<br>Lee [(4, 27), (11, 21), (18, 25), (29, 36), (37, 29), (40, 29), (42, 29)]<br>lie [(43, 31)]<br>life [(44, 32)]<br>lived [(3, 21), (5, 21)]<br>long [(15, 31)]<br>love [(6, 12), (10, 21), (10, 45), (12, 8), (31, 9), (31, 46)]<br>loved [(6, 24), (10, 8)]<br>maiden [(3, 8), (5, 10)]<br>many [(1, 8), (1, 17), (33, 7)]<br>may [(3, 36)]<br>me [(6, 33), (13, 20), (20, 27), (25, 25), (39, 44)]<br>men [(26, 34)]<br>moon [(39, 9)]<br>more [(10, 35)]<br>my [(11, 10), (29, 25), (36, 19), (44, 7), (44, 18), (44, 29), (44, 41)]<br>My [(18, 4)]<br>name [(4, 11)]<br>neither [(34, 5)]<br>never [(39, 14), (41, 15)]<br>night [(28, 40), (43, 17)]<br>no [(5, 32)]<br>Nor [(35, 4)]<br>not [(24, 13)]<br>of [(4, 16), (12, 37), (17, 17), (28, 24)]<br>Of [(32, 4), (33, 4), (37, 4), (40, 4), (42, 4), (44, 4)]<br>older [(32, 22)]<br>other [(5, 35)]<br>our [(31, 5)]<br>out [(17, 13), (28, 20)]<br>reason [(15, 18), (26, 19)]<br>rise [(41, 21)]<br>sea [(2, 24), (9, 27), (16, 27), (22, 27), (27, 27), (35, 34), (45, 34), (46, 32)]<br>sepulchre [(21, 21), (45, 11)]<br>seraphs [(12, 29)]<br>she [(5, 17), (8, 19)]<br>shut [(21, 4)]<br>side [(43, 47)]<br>So [(19, 1)]<br>so [(24, 22), (43, 5)]<br>soul [(36, 22), (36, 36)]<br>sounding [(46, 23)]<br>stars [(41, 9)]<br>stronger [(31, 21)]<br>Than [(6, 4)]<br>than [(10, 40), (31, 37), (32, 28), (33, 22)]<br>That [(3, 1), (28, 1)]<br>that [(10, 26), (12, 13), (15, 25), (19, 4), (26, 6)]<br>the [(2, 20), (4, 7), (9, 23), (12, 18), (15, 14), (16, 23), (22, 23), (26, 15), (27, 23), (28, 6), (28, 27), (31, 42), (34, 13), (35, 8), (35, 30), (36, 32), (37, 7), (39, 5), (40, 7), (41, 5), (41, 38), (42, 7), (43, 13), (43, 43), (45, 30), (46, 19)]<br>The [(24, 1)]<br>there [(3, 15), (45, 21)]<br>this [(5, 5), (9, 7), (15, 5), (16, 7), (22, 7), (27, 7)]<br>those [(32, 7)]<br>thought [(5, 41)]<br>tide [(43, 23)]<br>to [(6, 9)]<br>To [(21, 1)]<br>tomb [(46, 11)]<br>under [(35, 24)]<br>up [(21, 13)]<br>was [(1, 4), (8, 3), (8, 23), (10, 31), (15, 10), (26, 11), (31, 17)]<br>we [(10, 5), (32, 33), (33, 27)]<br>Went [(25, 4)]<br>were [(32, 17)]<br>who [(32, 13)]<br>whom [(3, 27)]<br>wind [(17, 3), (28, 10)]<br>wingÃ¨d [(12, 22)]<br>wiser [(33, 16)]<br>with [(5, 27), (10, 14)]<br>With [(12, 1)]<br>without [(39, 27)]<br>year [(1, 24)]<br>Yes [(26, 1)]<br>you [(3, 32)]</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#ç”¨setdefaultå¤„ç†æ‰¾ä¸åˆ°çš„é”®</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> reWORD_RE <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'\w+'</span><span class="token punctuation">)</span>index <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'poetry.txt'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    <span class="token keyword">for</span> line_no<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> match <span class="token keyword">in</span> WORD_RE<span class="token punctuation">.</span>finditer<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">:</span>            word <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span>            column_no <span class="token operator">=</span> match<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>            location <span class="token operator">=</span> <span class="token punctuation">(</span>line_no<span class="token punctuation">,</span> column_no<span class="token punctuation">)</span>            index<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span>word<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token keyword">for</span> word <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> index<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>a [(1, 22), (2, 7), (3, 6), (8, 7), (8, 27), (10, 19), (12, 6), (17, 20), (21, 19)]<br>A [(17, 1)]<br>above [(34, 34)]<br>ago [(1, 29), (15, 36)]<br>all [(26, 30), (43, 9)]<br>and [(1, 13), (6, 17), (8, 15), (11, 6), (13, 16), (25, 21), (29, 13), (44, 37)]<br>And [(5, 1), (15, 1), (20, 4), (34, 1), (41, 1), (43, 1)]<br>angels [(24, 5), (34, 17)]<br>Annabel [(4, 19), (11, 13), (18, 17), (29, 28), (37, 21), (40, 21), (42, 21)]<br>as [(26, 27)]<br>away [(20, 17)]<br>be [(6, 21)]<br>beams [(39, 20)]<br>beautiful [(18, 7), (37, 11), (40, 11), (42, 11)]<br>blew [(17, 8)]<br>bore [(20, 8)]<br>bride [(44, 44)]<br>bright [(41, 42)]<br>bringing [(39, 35)]<br>But [(10, 1), (31, 1)]<br>but [(41, 27)]<br>by [(2, 17), (6, 30), (9, 20), (16, 20), (22, 20), (27, 20), (28, 37), (31, 30), (43, 40), (45, 27), (46, 16)]<br>By [(4, 4)]<br>came [(19, 30), (28, 15)]<br>Can [(36, 1)]<br>child [(8, 9), (8, 29)]<br>chilling [(17, 29)]<br>Chilling [(29, 4)]<br>cloud [(17, 22), (28, 31)]<br>Coveted [(13, 4)]<br>darling [(44, 10), (44, 21)]<br>demons [(35, 12)]<br>dissever [(36, 10)]<br>down [(35, 19), (43, 35)]<br>dreams [(39, 47)]<br>envying [(25, 9)]<br>ever [(36, 5)]<br>eyes [(41, 49)]<br>far [(31, 33), (33, 12)]<br>feel [(41, 33)]<br>For [(39, 1)]<br>from [(20, 22), (36, 27)]<br>half [(24, 17)]<br>happy [(24, 25)]<br>Heaven [(12, 40), (24, 34), (34, 27)]<br>her [(13, 12), (19, 9), (20, 13), (21, 9), (25, 17), (45, 7), (46, 7)]<br>highborn [(19, 13)]<br>I [(8, 1), (11, 4), (41, 31), (43, 29)]<br>In [(2, 4), (9, 4), (16, 4), (22, 4), (27, 4), (45, 4), (46, 4)]<br>in [(21, 16), (24, 31), (34, 24)]<br>It [(1, 1)]<br>it [(31, 14)]<br>killing [(29, 17)]<br>kingdom [(2, 9), (9, 12), (16, 12), (22, 12), (27, 12)]<br>kinsmen [(19, 22)]<br>know [(3, 40), (26, 38)]<br>Lee [(4, 27), (11, 21), (18, 25), (29, 36), (37, 29), (40, 29), (42, 29)]<br>lie [(43, 31)]<br>life [(44, 32)]<br>lived [(3, 21), (5, 21)]<br>long [(15, 31)]<br>love [(6, 12), (10, 21), (10, 45), (12, 8), (31, 9), (31, 46)]<br>loved [(6, 24), (10, 8)]<br>maiden [(3, 8), (5, 10)]<br>many [(1, 8), (1, 17), (33, 7)]<br>may [(3, 36)]<br>me [(6, 33), (13, 20), (20, 27), (25, 25), (39, 44)]<br>men [(26, 34)]<br>moon [(39, 9)]<br>more [(10, 35)]<br>my [(11, 10), (29, 25), (36, 19), (44, 7), (44, 18), (44, 29), (44, 41)]<br>My [(18, 4)]<br>name [(4, 11)]<br>neither [(34, 5)]<br>never [(39, 14), (41, 15)]<br>night [(28, 40), (43, 17)]<br>no [(5, 32)]<br>Nor [(35, 4)]<br>not [(24, 13)]<br>of [(4, 16), (12, 37), (17, 17), (28, 24)]<br>Of [(32, 4), (33, 4), (37, 4), (40, 4), (42, 4), (44, 4)]<br>older [(32, 22)]<br>other [(5, 35)]<br>our [(31, 5)]<br>out [(17, 13), (28, 20)]<br>reason [(15, 18), (26, 19)]<br>rise [(41, 21)]<br>sea [(2, 24), (9, 27), (16, 27), (22, 27), (27, 27), (35, 34), (45, 34), (46, 32)]<br>sepulchre [(21, 21), (45, 11)]<br>seraphs [(12, 29)]<br>she [(5, 17), (8, 19)]<br>shut [(21, 4)]<br>side [(43, 47)]<br>So [(19, 1)]<br>so [(24, 22), (43, 5)]<br>soul [(36, 22), (36, 36)]<br>sounding [(46, 23)]<br>stars [(41, 9)]<br>stronger [(31, 21)]<br>Than [(6, 4)]<br>than [(10, 40), (31, 37), (32, 28), (33, 22)]<br>That [(3, 1), (28, 1)]<br>that [(10, 26), (12, 13), (15, 25), (19, 4), (26, 6)]<br>the [(2, 20), (4, 7), (9, 23), (12, 18), (15, 14), (16, 23), (22, 23), (26, 15), (27, 23), (28, 6), (28, 27), (31, 42), (34, 13), (35, 8), (35, 30), (36, 32), (37, 7), (39, 5), (40, 7), (41, 5), (41, 38), (42, 7), (43, 13), (43, 43), (45, 30), (46, 19)]<br>The [(24, 1)]<br>there [(3, 15), (45, 21)]<br>this [(5, 5), (9, 7), (15, 5), (16, 7), (22, 7), (27, 7)]<br>those [(32, 7)]<br>thought [(5, 41)]<br>tide [(43, 23)]<br>to [(6, 9)]<br>To [(21, 1)]<br>tomb [(46, 11)]<br>under [(35, 24)]<br>up [(21, 13)]<br>was [(1, 4), (8, 3), (8, 23), (10, 31), (15, 10), (26, 11), (31, 17)]<br>we [(10, 5), (32, 33), (33, 27)]<br>Went [(25, 4)]<br>were [(32, 17)]<br>who [(32, 13)]<br>whom [(3, 27)]<br>wind [(17, 3), (28, 10)]<br>wingÃ¨d [(12, 22)]<br>wiser [(33, 16)]<br>with [(5, 27), (10, 14)]<br>With [(12, 1)]<br>without [(39, 27)]<br>year [(1, 24)]<br>Yes [(26, 1)]<br>you [(3, 32)]</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># æ˜ å°„çš„å¼¹æ€§é”®é€‰æ‹©ã€</span><span class="token comment"># åˆ©ç”¨defaultdict</span><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict<span class="token keyword">import</span> reWORD_RE <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'\w+'</span><span class="token punctuation">)</span>index <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'poetry.txt'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    <span class="token keyword">for</span> line_no<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> match <span class="token keyword">in</span> WORD_RE<span class="token punctuation">.</span>finditer<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">:</span>            word <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span>            column_no <span class="token operator">=</span> match<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>            location <span class="token operator">=</span> <span class="token punctuation">(</span>line_no<span class="token punctuation">,</span> column_no<span class="token punctuation">)</span>            index<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token keyword">for</span> word <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> index<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>a [(1, 22), (2, 7), (3, 6), (8, 7), (8, 27), (10, 19), (12, 6), (17, 20), (21, 19)]<br>A [(17, 1)]<br>above [(34, 34)]<br>ago [(1, 29), (15, 36)]<br>all [(26, 30), (43, 9)]<br>and [(1, 13), (6, 17), (8, 15), (11, 6), (13, 16), (25, 21), (29, 13), (44, 37)]<br>And [(5, 1), (15, 1), (20, 4), (34, 1), (41, 1), (43, 1)]<br>angels [(24, 5), (34, 17)]<br>Annabel [(4, 19), (11, 13), (18, 17), (29, 28), (37, 21), (40, 21), (42, 21)]<br>as [(26, 27)]<br>away [(20, 17)]<br>be [(6, 21)]<br>beams [(39, 20)]<br>beautiful [(18, 7), (37, 11), (40, 11), (42, 11)]<br>blew [(17, 8)]<br>bore [(20, 8)]<br>bride [(44, 44)]<br>bright [(41, 42)]<br>bringing [(39, 35)]<br>But [(10, 1), (31, 1)]<br>but [(41, 27)]<br>by [(2, 17), (6, 30), (9, 20), (16, 20), (22, 20), (27, 20), (28, 37), (31, 30), (43, 40), (45, 27), (46, 16)]<br>By [(4, 4)]<br>came [(19, 30), (28, 15)]<br>Can [(36, 1)]<br>child [(8, 9), (8, 29)]<br>chilling [(17, 29)]<br>Chilling [(29, 4)]<br>cloud [(17, 22), (28, 31)]<br>Coveted [(13, 4)]<br>darling [(44, 10), (44, 21)]<br>demons [(35, 12)]<br>dissever [(36, 10)]<br>down [(35, 19), (43, 35)]<br>dreams [(39, 47)]<br>envying [(25, 9)]<br>ever [(36, 5)]<br>eyes [(41, 49)]<br>far [(31, 33), (33, 12)]<br>feel [(41, 33)]<br>For [(39, 1)]<br>from [(20, 22), (36, 27)]<br>half [(24, 17)]<br>happy [(24, 25)]<br>Heaven [(12, 40), (24, 34), (34, 27)]<br>her [(13, 12), (19, 9), (20, 13), (21, 9), (25, 17), (45, 7), (46, 7)]<br>highborn [(19, 13)]<br>I [(8, 1), (11, 4), (41, 31), (43, 29)]<br>In [(2, 4), (9, 4), (16, 4), (22, 4), (27, 4), (45, 4), (46, 4)]<br>in [(21, 16), (24, 31), (34, 24)]<br>It [(1, 1)]<br>it [(31, 14)]<br>killing [(29, 17)]<br>kingdom [(2, 9), (9, 12), (16, 12), (22, 12), (27, 12)]<br>kinsmen [(19, 22)]<br>know [(3, 40), (26, 38)]<br>Lee [(4, 27), (11, 21), (18, 25), (29, 36), (37, 29), (40, 29), (42, 29)]<br>lie [(43, 31)]<br>life [(44, 32)]<br>lived [(3, 21), (5, 21)]<br>long [(15, 31)]<br>love [(6, 12), (10, 21), (10, 45), (12, 8), (31, 9), (31, 46)]<br>loved [(6, 24), (10, 8)]<br>maiden [(3, 8), (5, 10)]<br>many [(1, 8), (1, 17), (33, 7)]<br>may [(3, 36)]<br>me [(6, 33), (13, 20), (20, 27), (25, 25), (39, 44)]<br>men [(26, 34)]<br>moon [(39, 9)]<br>more [(10, 35)]<br>my [(11, 10), (29, 25), (36, 19), (44, 7), (44, 18), (44, 29), (44, 41)]<br>My [(18, 4)]<br>name [(4, 11)]<br>neither [(34, 5)]<br>never [(39, 14), (41, 15)]<br>night [(28, 40), (43, 17)]<br>no [(5, 32)]<br>Nor [(35, 4)]<br>not [(24, 13)]<br>of [(4, 16), (12, 37), (17, 17), (28, 24)]<br>Of [(32, 4), (33, 4), (37, 4), (40, 4), (42, 4), (44, 4)]<br>older [(32, 22)]<br>other [(5, 35)]<br>our [(31, 5)]<br>out [(17, 13), (28, 20)]<br>reason [(15, 18), (26, 19)]<br>rise [(41, 21)]<br>sea [(2, 24), (9, 27), (16, 27), (22, 27), (27, 27), (35, 34), (45, 34), (46, 32)]<br>sepulchre [(21, 21), (45, 11)]<br>seraphs [(12, 29)]<br>she [(5, 17), (8, 19)]<br>shut [(21, 4)]<br>side [(43, 47)]<br>So [(19, 1)]<br>so [(24, 22), (43, 5)]<br>soul [(36, 22), (36, 36)]<br>sounding [(46, 23)]<br>stars [(41, 9)]<br>stronger [(31, 21)]<br>Than [(6, 4)]<br>than [(10, 40), (31, 37), (32, 28), (33, 22)]<br>That [(3, 1), (28, 1)]<br>that [(10, 26), (12, 13), (15, 25), (19, 4), (26, 6)]<br>the [(2, 20), (4, 7), (9, 23), (12, 18), (15, 14), (16, 23), (22, 23), (26, 15), (27, 23), (28, 6), (28, 27), (31, 42), (34, 13), (35, 8), (35, 30), (36, 32), (37, 7), (39, 5), (40, 7), (41, 5), (41, 38), (42, 7), (43, 13), (43, 43), (45, 30), (46, 19)]<br>The [(24, 1)]<br>there [(3, 15), (45, 21)]<br>this [(5, 5), (9, 7), (15, 5), (16, 7), (22, 7), (27, 7)]<br>those [(32, 7)]<br>thought [(5, 41)]<br>tide [(43, 23)]<br>to [(6, 9)]<br>To [(21, 1)]<br>tomb [(46, 11)]<br>under [(35, 24)]<br>up [(21, 13)]<br>was [(1, 4), (8, 3), (8, 23), (10, 31), (15, 10), (26, 11), (31, 17)]<br>we [(10, 5), (32, 33), (33, 27)]<br>Went [(25, 4)]<br>were [(32, 17)]<br>who [(32, 13)]<br>whom [(3, 27)]<br>wind [(17, 3), (28, 10)]<br>wingÃ¨d [(12, 22)]<br>wiser [(33, 16)]<br>with [(5, 27), (10, 14)]<br>With [(12, 1)]<br>without [(39, 27)]<br>year [(1, 24)]<br>Yes [(26, 1)]<br>you [(3, 32)]</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ç”¨__missing__å¤„ç†</span><span class="token keyword">import</span> collections<span class="token keyword">class</span> <span class="token class-name">StrKeyDict</span><span class="token punctuation">(</span>collections<span class="token punctuation">.</span>UserDict<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__missing__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">raise</span> KeyError<span class="token punctuation">(</span>key<span class="token punctuation">)</span>        <span class="token keyword">return</span> self<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">__contains__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>data    <span class="token keyword">def</span> <span class="token function">__setitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å­—å…¸çš„å˜ç§</span><span class="token comment"># collections.OrderedDictï¼Œé”®å€¼ä¼šæ’åºï¼Œå¯ä»¥ç”¨popitem</span><span class="token comment"># collections.ChainMapï¼Œå¯ä»¥å®¹çº³å¤šä¸ªdictï¼Œä¸€å¹¶æŸ¥è¯¢</span><span class="token comment"># collections.Counter,è®¡æ•°å™¨</span><span class="token comment"># collection.UserDict çº¯pythonå®ç°çš„dictï¼Œæ›´æ–¹ä¾¿æˆ‘ä»¬åšdictæ‰©å±•</span><span class="token keyword">from</span> collections <span class="token keyword">import</span> Counterct <span class="token operator">=</span> Counter<span class="token punctuation">(</span><span class="token string">"sdsadcsadsadaaasdsac"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>ct<span class="token punctuation">)</span>ct<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">'wewqewq'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>ct<span class="token punctuation">)</span>ct<span class="token punctuation">.</span>most_common<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#æ’åº</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>Counter({â€˜aâ€™: 7, â€˜sâ€™: 6, â€˜dâ€™: 5, â€˜câ€™: 2})<br>Counter({â€˜aâ€™: 7, â€˜sâ€™: 6, â€˜dâ€™: 5, â€˜wâ€™: 3, â€˜câ€™: 2, â€˜eâ€™: 2, â€˜qâ€™: 2})</p><p>[(â€˜aâ€™, 7), (â€˜sâ€™, 6), (â€˜dâ€™, 5), (â€˜wâ€™, 3), (â€˜câ€™, 2), (â€˜eâ€™, 2), (â€˜qâ€™, 2)]</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ä¸å¯å˜æ˜ å°„ç±»å‹</span><span class="token keyword">from</span> types <span class="token keyword">import</span> MappingProxyTyped <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'A'</span><span class="token punctuation">}</span>d_proxy <span class="token operator">=</span> MappingProxyType<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d_proxy<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d_proxy<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>A</p><hr><p>KeyError Traceback (most recent call last)</p><p><ipython-input-12-d4ae1d057cd0> in <module>       4 d_proxy = MappingProxyType(d)<br>      5 print(d_proxy[1])<br>â€”â€”&gt; 6 print(d_proxy[2])</module></ipython-input-12-d4ae1d057cd0></p><p>KeyError: 2</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">d<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'B'</span><span class="token keyword">print</span><span class="token punctuation">(</span>d_proxy<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>B</p></blockquote><h2 id="3-2-set"><a href="#3-2-set" class="headerlink" title="3.2 set"></a>3.2 set</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#é›†åˆçš„æœ¬è´¨æ˜¯è®¸å¤šå”¯ä¸€å¯¹è±¡çš„èšé›†ï¼Œå¯ä»¥ç”¨äºå»é‡</span>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token builtin">set</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>&gt;</p><blockquote><p>{â€˜aâ€™, â€˜bâ€™, â€˜câ€™}</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#é›†åˆçš„è¿ç®—ç¬¦</span>a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span>b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">|</span> b<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">^</span> b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>{1, 2, 3, 4, 5, 6}<br>{3, 4}<br>{1, 2}<br>{1, 2, 5, 6}</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> unicodedata <span class="token keyword">import</span> name<span class="token punctuation">{</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">236</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token string">'SIGN'</span> <span class="token keyword">in</span> name<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>{â€˜#â€™,<br>â€˜$â€™,<br>â€˜%â€™,<br>â€˜+â€™,<br>â€˜&lt;â€™,<br>â€˜=â€™,<br>â€˜&gt;â€™,<br>â€˜Â¢â€™,<br>â€˜Â£â€™,<br>â€˜Â¤â€™,<br>â€˜Â¥â€™,<br>â€˜Â§â€™,<br>â€˜Â©â€™,<br>â€˜Â¬â€™,<br>â€˜Â®â€™,<br>â€˜Â°â€™,<br>â€˜Â±â€™,<br>â€˜Âµâ€™,<br>â€˜Â¶â€™,<br>â€˜Ã—â€™}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> FluentPython </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter_02_An_Array_of_Sequences</title>
      <link href="2020/12/02/python/fluentpython/chapter-02-an-array-of-sequences/"/>
      <url>2020/12/02/python/fluentpython/chapter-02-an-array-of-sequences/</url>
      
        <content type="html"><![CDATA[<h1 id="Chapter-02-An-Array-of-Sequences"><a href="#Chapter-02-An-Array-of-Sequences" class="headerlink" title="Chapter_02_An_Array_of_Sequences"></a>Chapter_02_An_Array_of_Sequences</h1><h2 id="2-1-tuple"><a href="#2-1-tuple" class="headerlink" title="2.1 tuple"></a>2.1 tuple</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åˆ—è¡¨æ¨å¯¼å¼</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'black'</span><span class="token punctuation">,</span> <span class="token string">'white'</span><span class="token punctuation">]</span>sizes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'S'</span><span class="token punctuation">,</span> <span class="token string">'M'</span><span class="token punctuation">,</span> <span class="token string">'L'</span><span class="token punctuation">]</span>tshirts<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span>color<span class="token punctuation">,</span> size<span class="token punctuation">)</span> <span class="token keyword">for</span> color <span class="token keyword">in</span> colors <span class="token keyword">for</span> size <span class="token keyword">in</span> sizes<span class="token punctuation">]</span>tshirts<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>[(â€˜blackâ€™, â€˜Sâ€™),<br> (â€˜blackâ€™, â€˜Mâ€™),<br> (â€˜blackâ€™, â€˜Lâ€™),<br> (â€˜whiteâ€™, â€˜Sâ€™),<br> (â€˜whiteâ€™, â€˜Mâ€™),<br> (â€˜whiteâ€™, â€˜Lâ€™)]</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åˆ—è¡¨ç”Ÿæˆå™¨ å°±æ˜¯å§[]å˜æˆ()å¯ä»¥è°ƒç”¨nextç”Ÿæˆ</span>tshirts <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>color<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>size<span class="token punctuation">}</span></span><span class="token string">"</span></span> <span class="token keyword">for</span> color <span class="token keyword">in</span> colors <span class="token keyword">for</span> size <span class="token keyword">in</span> sizes<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>tshirts<span class="token punctuation">)</span><span class="token keyword">for</span> tshirt <span class="token keyword">in</span> tshirts<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>tshirt<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>&lt; generator object &lt; genexpr &gt; at 0x7fb438de0228 &gt; black S<br>black M<br>black L<br>white S<br>white M<br>white L</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å…ƒç»„çš„ç”¨æ³•</span>lax_coordinates <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">33.9425</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">118.408056</span><span class="token punctuation">)</span>city<span class="token punctuation">,</span> year<span class="token punctuation">,</span> pop<span class="token punctuation">,</span> chg<span class="token punctuation">,</span> area <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'Tokyo'</span><span class="token punctuation">,</span> <span class="token number">2003</span><span class="token punctuation">,</span> <span class="token number">32450</span><span class="token punctuation">,</span> <span class="token number">0.66</span><span class="token punctuation">,</span> <span class="token number">8014</span><span class="token punctuation">)</span>traveler_ids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'USA'</span><span class="token punctuation">,</span> <span class="token string">'31195855'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'BRA'</span><span class="token punctuation">,</span> <span class="token string">'CE342567'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'ESP'</span><span class="token punctuation">,</span> <span class="token string">'XDA205856'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">for</span> passport <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>traveler_ids<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%s/%s'</span> <span class="token operator">%</span> passport<span class="token punctuation">)</span><span class="token keyword">for</span> country<span class="token punctuation">,</span> _ <span class="token keyword">in</span> traveler_ids<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>BRA/CE342567<br>ESP/XDA205856<br>USA/31195855<br>USA<br>BRA<br>ESP</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å…ƒç»„æ‹†åŒ…</span>lax_coordinates <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">33.9425</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">118.408056</span><span class="token punctuation">)</span>latitude<span class="token punctuation">,</span> longitude <span class="token operator">=</span> lax_coordinates <span class="token comment"># tuple unpacking</span><span class="token keyword">print</span><span class="token punctuation">(</span>latitude<span class="token punctuation">,</span> longitude<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>33.9425 -118.408056</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>quotient<span class="token punctuation">,</span> remainder <span class="token operator">=</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span><span class="token operator">*</span>t<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>quotient<span class="token punctuation">,</span> remainder<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>2 4</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os_<span class="token punctuation">,</span> filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/home/ctios/.ssh/idrsa.pub'</span><span class="token punctuation">)</span>filename<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>â€˜idrsa.pubâ€™</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">a<span class="token punctuation">,</span> <span class="token operator">*</span>body<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span> body<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>(0, [1, 2, 3, 4, 5, 6, 7], 8, 9)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">metro_areas <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">(</span><span class="token string">'Tokyo'</span><span class="token punctuation">,</span><span class="token string">'JP'</span><span class="token punctuation">,</span><span class="token number">36.933</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">35.689722</span><span class="token punctuation">,</span><span class="token number">139.691667</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">'Delhi NCR'</span><span class="token punctuation">,</span> <span class="token string">'IN'</span><span class="token punctuation">,</span> <span class="token number">21.935</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">28.613889</span><span class="token punctuation">,</span> <span class="token number">77.208889</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>     <span class="token punctuation">(</span><span class="token string">'Mexico City'</span><span class="token punctuation">,</span> <span class="token string">'MX'</span><span class="token punctuation">,</span> <span class="token number">20.142</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">19.433333</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">99.133333</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">'New York-Newark'</span><span class="token punctuation">,</span> <span class="token string">'US'</span><span class="token punctuation">,</span> <span class="token number">20.104</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">40.808611</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">74.020386</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">'Sao Paulo'</span><span class="token punctuation">,</span> <span class="token string">'BR'</span><span class="token punctuation">,</span> <span class="token number">19.649</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">23.547778</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">46.635833</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'{:15} | {:^9} | {:^9}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'lat.'</span><span class="token punctuation">,</span> <span class="token string">'long.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> fmt <span class="token operator">=</span> <span class="token string">'{:15} | {:9.4f} | {:9.4f}'</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> cc<span class="token punctuation">,</span> pop<span class="token punctuation">,</span> <span class="token punctuation">(</span>latitude<span class="token punctuation">,</span> longitude<span class="token punctuation">)</span> <span class="token keyword">in</span> metro_areas<span class="token punctuation">:</span>     <span class="token keyword">if</span> longitude <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>         <span class="token keyword">print</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> latitude<span class="token punctuation">,</span> longitude<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="table-container"><table><thead><tr><th></th><th>lat.</th><th>long.</th></tr></thead><tbody><tr><td>Mexico City</td><td>19.4333</td><td>-99.1333</td></tr><tr><td>New York-Newark</td><td>40.8086</td><td>-74.0204</td></tr><tr><td>Sao Paulo</td><td>-23.5478</td><td>-46.6358</td></tr></tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å…·åå…ƒç»„ namedtuple</span><span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtupleCity <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'City'</span><span class="token punctuation">,</span> <span class="token string">'name country population coordinates'</span><span class="token punctuation">)</span>tokyo <span class="token operator">=</span> City<span class="token punctuation">(</span><span class="token string">'Tokyo'</span><span class="token punctuation">,</span> <span class="token string">'JP'</span><span class="token punctuation">,</span> <span class="token number">36.933</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">35.689722</span><span class="token punctuation">,</span> <span class="token number">139.691667</span><span class="token punctuation">)</span><span class="token punctuation">)</span>City<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Tokyo'</span><span class="token punctuation">,</span> country<span class="token operator">=</span><span class="token string">'JP'</span><span class="token punctuation">,</span> population<span class="token operator">=</span><span class="token number">36.933</span><span class="token punctuation">,</span> coordinates<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">35.689722</span><span class="token punctuation">,</span> <span class="token number">139.691667</span><span class="token punctuation">)</span><span class="token punctuation">)</span>tokyo<span class="token punctuation">,</span> tokyo<span class="token punctuation">.</span>population<span class="token punctuation">,</span> tokyo<span class="token punctuation">.</span>coordinates<span class="token punctuation">,</span> tokyo<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>(City(name=â€™Tokyoâ€™, country=â€™JPâ€™, population=36.933, coordinates=(35.689722, 139.691667)),<br> 36.933,<br> (35.689722, 139.691667),<br> â€˜JPâ€™)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å…·åå…ƒç»„çš„å±æ€§å’Œæ–¹æ³•</span>City<span class="token punctuation">.</span>_fields<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'population'</span><span class="token punctuation">,</span> <span class="token string">'coordinates'</span><span class="token punctuation">)</span>LatLong <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'LatLong'</span><span class="token punctuation">,</span> <span class="token string">'lat long'</span><span class="token punctuation">)</span>delhi_data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'Delhi NCR'</span><span class="token punctuation">,</span> <span class="token string">'IN'</span><span class="token punctuation">,</span> <span class="token number">21.935</span><span class="token punctuation">,</span> LatLong<span class="token punctuation">(</span><span class="token number">28.613889</span><span class="token punctuation">,</span> <span class="token number">77.208889</span><span class="token punctuation">)</span><span class="token punctuation">)</span>delhi <span class="token operator">=</span> City<span class="token punctuation">.</span>_make<span class="token punctuation">(</span>delhi_data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>delhi<span class="token punctuation">)</span><span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> delhi<span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">':'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>City(name=â€™Delhi NCRâ€™, country=â€™INâ€™, population=21.935, coordinates=LatLong(lat=28.613889, long=77.208889))<br>name: Delhi NCR<br>country: IN<br>population: 21.935<br>coordinates: LatLong(lat=28.613889, long=77.208889)</p></blockquote><h2 id="2-2-slice"><a href="#2-2-slice" class="headerlink" title="2.2 slice"></a>2.2 slice</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åˆ‡ç‰‡</span>s <span class="token operator">=</span> <span class="token string">'bicycle'</span>s<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>(â€˜byeâ€™, â€˜elcycibâ€™)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åˆ‡ç‰‡sliceå¯¹è±¡ï¼Œä¼ å…¥seq.__getitem__()</span>invoice <span class="token operator">=</span> <span class="token triple-quoted-string string">"""0.....6.................................40........52...55........1909 Pimoroni PiBrella                      $17.50    3    $52.501489 6mm Tactile Switch x20                 $4.95     2     $9.901510 Panavise Jr. - PV-201                  $28.00    1    $28.001601 PiTFT Mini Kit 320x240                 $34.95    1    $34.95"""</span>SKU <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>DESCRIPTION <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>UNIT_PRICE <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">)</span>QUANTITY <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">)</span>ITEM_TOTAL <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>line_items <span class="token operator">=</span> invoice<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">for</span> item <span class="token keyword">in</span> line_items<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>UNIT_PRICE<span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span>DESCRIPTION<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>$17.50 imoroni PiBrella<br>$4.95 6mm Tactile Switch x20<br>$28.00 anavise Jr. - PV-201<br>$34.95 iTFT Mini Kit 320x240             </p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ç»™åˆ‡ç‰‡èµ‹å€¼</span>l <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token keyword">del</span> l<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>l<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]<br>[0, 1, 20, 30, 5, 6, 7, 8, 9]<br>[0, 1, 20, 30, 5, 8, 9]<br>[0, 1, 20, 11, 5, 22, 9]<br>[0, 1, 100, 22, 9]</p></blockquote><h2 id="2-3"><a href="#2-3" class="headerlink" title="2.3 +,,+=,="></a>2.3 +,<em>,+=,</em>=</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å¯¹åºåˆ—ä½¿ç”¨+ï¼Œ*</span><span class="token comment"># å½“a*n è¿™ä¸ªè¯­å¥ä¸­ï¼Œå½“åºåˆ—aé‡Œé¢çš„å…ƒç´ æ˜¯å¯¹å…¶ä»–å¯å˜å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹˜æ³•åªæ˜¯èµ‹å€¼å¤šä¸ªå¼•ç”¨ï¼Œå…¶ä¸­çš„è¿™äº›å¼•ç”¨éƒ½æ˜¯æŒ‡å‘åŒä¸€ä¸ªåˆ—è¡¨ï¼Œä¾‹å¦‚</span>board <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'_'</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>board<span class="token punctuation">)</span>board<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'X'</span><span class="token keyword">print</span><span class="token punctuation">(</span>board<span class="token punctuation">)</span>weird_board <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'_'</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">3</span>weird_board<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0'</span><span class="token keyword">print</span><span class="token punctuation">(</span>weird_board<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>[[â€˜_â€™, â€˜_â€™, â€˜_â€™], [â€˜_â€™, â€˜_â€™, â€˜_â€™], [â€˜_â€™, â€˜_â€™, â€˜_â€™]]<br>[[â€˜_â€™, â€˜_â€™, â€˜_â€™], [â€˜_â€™, â€˜_â€™, â€˜Xâ€™], [â€˜_â€™, â€˜_â€™, â€˜_â€™]]<br>[[â€˜_â€™, â€˜_â€™, â€˜0â€™], [â€˜_â€™, â€˜_â€™, â€˜0â€™], [â€˜_â€™, â€˜_â€™, â€˜0â€™]]</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å¢é‡èµ‹å€¼ +=,*=</span><span class="token comment"># å¦‚æœå¯¹è±¡å®ç°äº†__iadd__,__imul__çš„è¯ï¼Œå°±æ˜¯åœ¨åŸåŸºç¡€ä¸Šå¢åŠ </span><span class="token comment"># å¦åˆ™å°±æ˜¯è°ƒç”¨__add__ï¼Œ__mul__ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¾‹å¦‚</span>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'l={}, id={}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>l <span class="token operator">*=</span> <span class="token number">2</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'l={}, id={}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>t<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'t={}, id={}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>t<span class="token operator">*=</span><span class="token number">2</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'t={}, id={}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># lçš„idæ²¡å˜ï¼Œtçš„idå˜äº†</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>l=[1, 2, 3], id=140216592790216<br>l=[1, 2, 3, 1, 2, 3], id=140216592790216<br>t=(1, 2, 3), id=140216592745168<br>t=(1, 2, 3, 1, 2, 3), id=140216592237672</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å…³äº+=çš„è°œé¢˜</span>t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span>t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><hr><p>TypeError raceback (most recent call last)</p><p>&lt; ipython-input-6-b2fc2439c603 &gt; in &lt; module &gt;   1 # å…³äº+=çš„è°œé¢˜<br>  2 t = (1, 2, [30, 40])<br>â€”â€”&gt; 3 t[2] += [50, 60]</p><p>TypeError: â€˜tupleâ€™ object does not support item assignment</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>(1, 2, [30, 40, 50, 60])</p></blockquote><h2 id="2-4-sort-and-bisect"><a href="#2-4-sort-and-bisect" class="headerlink" title="2.4 sort and bisect"></a>2.4 sort and bisect</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># list.sort()å’Œsorted()</span>fruits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'grape'</span><span class="token punctuation">,</span> <span class="token string">'raspberry'</span><span class="token punctuation">,</span> <span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'banana'</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span><span class="token punctuation">,</span> fruits<span class="token punctuation">)</span>fruits<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span>fruits<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span><span class="token comment"># pythonä¸­çš„sortæ˜¯ç¨³å®šçš„ï¼Œå¤§å°ä¸€è‡´æ—¶ï¼Œä½ç½®ä¸å˜</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># bisect_left, bisect, bisect_rightæ˜¯æŸ¥æ‰¾ä½ç½®ï¼Œä¸æ’å…¥</span><span class="token keyword">from</span> bisect <span class="token keyword">import</span> bisect_left<span class="token punctuation">,</span> bisect<span class="token punctuation">,</span> bisect_righta <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>index <span class="token operator">=</span> bisect_left<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> index<span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>index <span class="token operator">=</span> bisect<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> index<span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>index <span class="token operator">=</span> bisect_right<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>[1, 2, 3, 4] 1<br>[1, 2, 3, 4] 2<br>[1, 2, 3, 4] 2</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># bisect å¯ä»¥ä½œä¸ºç´¢å¼•æŸ¥è¯¢è¡¨æ ¼</span><span class="token keyword">import</span> bisect<span class="token keyword">def</span> <span class="token function">grade</span><span class="token punctuation">(</span>score<span class="token punctuation">,</span> breakpoints<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grades<span class="token operator">=</span><span class="token string">'FDCBA'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> bisect<span class="token punctuation">.</span>bisect<span class="token punctuation">(</span>breakpoints<span class="token punctuation">,</span> score<span class="token punctuation">)</span>    <span class="token keyword">return</span> grades<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>grade<span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">for</span> score <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>[â€˜Fâ€™, â€˜Aâ€™, â€˜Câ€™, â€˜Câ€™, â€˜Bâ€™, â€˜Aâ€™, â€˜Aâ€™]</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ç”¨bisect.insortæ’å…¥æ–°å…ƒç´ </span><span class="token keyword">import</span> bisect<span class="token keyword">import</span> randomSIZE <span class="token operator">=</span> <span class="token number">7</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1997</span><span class="token punctuation">)</span>my_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>SIZE<span class="token punctuation">)</span><span class="token punctuation">:</span>    new_item <span class="token operator">=</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span>SIZE <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>    bisect<span class="token punctuation">.</span>insort<span class="token punctuation">(</span>my_list<span class="token punctuation">,</span> new_item<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%2d -&gt;'</span> <span class="token operator">%</span> new_item<span class="token punctuation">,</span> my_list<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>12 -&gt; [12]<br> 3 -&gt; [3, 12]<br> 1 -&gt; [1, 3, 12]<br> 3 -&gt; [1, 3, 3, 12]<br> 2 -&gt; [1, 2, 3, 3, 12]<br>10 -&gt; [1, 2, 3, 3, 10, 12]<br> 3 -&gt; [1, 2, 3, 3, 3, 10, 12]</p></blockquote><h2 id="2-5-array-and-memoryview"><a href="#2-5-array-and-memoryview" class="headerlink" title="2.5 array and memoryview"></a>2.5 array and memoryview</h2><p>æ­¤æ¨¡å—å®šä¹‰äº†ä¸€ç§å¯¹è±¡ç±»å‹ï¼Œå¯ä»¥ç´§å‡‘åœ°è¡¨ç¤ºåŸºæœ¬ç±»å‹å€¼çš„æ•°ç»„ï¼šå­—ç¬¦ã€æ•´æ•°ã€æµ®ç‚¹æ•°ç­‰ã€‚ æ•°ç»„å±äºåºåˆ—ç±»å‹ï¼Œå…¶è¡Œä¸ºä¸åˆ—è¡¨éå¸¸ç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå…¶ä¸­å­˜å‚¨çš„å¯¹è±¡ç±»å‹æ˜¯å—é™çš„ã€‚ ç±»å‹åœ¨å¯¹è±¡åˆ›å»ºæ—¶ä½¿ç”¨å•ä¸ªå­—ç¬¦çš„ <em>ç±»å‹ç </em> æ¥æŒ‡å®šã€‚ å·²å®šä¹‰çš„ç±»å‹ç å¦‚ä¸‹ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:left">ç±»å‹ç </th><th style="text-align:left">C ç±»å‹</th><th style="text-align:left">Python ç±»å‹</th><th style="text-align:left">ä»¥å­—èŠ‚è¡¨ç¤ºçš„æœ€å°å°ºå¯¸</th><th style="text-align:left">æ³¨é‡Š</th></tr></thead><tbody><tr><td style="text-align:left"><code>'b'</code></td><td style="text-align:left">signed char</td><td style="text-align:left">int</td><td style="text-align:left">1</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>'B'</code></td><td style="text-align:left">unsigned char</td><td style="text-align:left">int</td><td style="text-align:left">1</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>'u'</code></td><td style="text-align:left">Py_UNICODE</td><td style="text-align:left">Unicode å­—ç¬¦</td><td style="text-align:left">2</td><td style="text-align:left">(1)</td></tr><tr><td style="text-align:left"><code>'h'</code></td><td style="text-align:left">signed short</td><td style="text-align:left">int</td><td style="text-align:left">2</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>'H'</code></td><td style="text-align:left">unsigned short</td><td style="text-align:left">int</td><td style="text-align:left">2</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>'i'</code></td><td style="text-align:left">signed int</td><td style="text-align:left">int</td><td style="text-align:left">2</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>'I'</code></td><td style="text-align:left">unsigned int</td><td style="text-align:left">int</td><td style="text-align:left">2</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>'l'</code></td><td style="text-align:left">signed long</td><td style="text-align:left">int</td><td style="text-align:left">4</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>'L'</code></td><td style="text-align:left">unsigned long</td><td style="text-align:left">int</td><td style="text-align:left">4</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>'q'</code></td><td style="text-align:left">signed long long</td><td style="text-align:left">int</td><td style="text-align:left">8</td><td style="text-align:left">(2)</td></tr><tr><td style="text-align:left"><code>'Q'</code></td><td style="text-align:left">unsigned long long</td><td style="text-align:left">int</td><td style="text-align:left">8</td><td style="text-align:left">(2)</td></tr><tr><td style="text-align:left"><code>'f'</code></td><td style="text-align:left">float</td><td style="text-align:left">float</td><td style="text-align:left">4</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>'d'</code></td><td style="text-align:left">double</td><td style="text-align:left">float</td><td style="text-align:left">8</td></tr></tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> array <span class="token keyword">import</span> array<span class="token keyword">from</span> random <span class="token keyword">import</span> randomfloats<span class="token operator">=</span>array<span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">**</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>floats<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>0.4585058847207508</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">fp<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'floats.bin'</span><span class="token punctuation">,</span><span class="token string">'wb+'</span><span class="token punctuation">)</span>floats<span class="token punctuation">.</span>tofile<span class="token punctuation">(</span>fp<span class="token punctuation">)</span>fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>floats2<span class="token operator">=</span>array<span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">)</span>fp<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'floats.bin'</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span>floats2<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span>fp<span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">**</span><span class="token number">7</span><span class="token punctuation">)</span>fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>floats2<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>0.4585058847207508</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">floats<span class="token operator">=</span>array<span class="token punctuation">(</span>floats<span class="token punctuation">.</span>typecode<span class="token punctuation">,</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>floats<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>floats<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>array(â€˜dâ€™, [3.67431575165611e-08, 3.475699940080901e-07, 3.7822653908836656e-07, 4.061706841973489e-07, 6.074053917615174e-07, 6.484837163922563e-07, 6.683984088429185e-07, 7.039884853954348e-07, 7.172446871983595e-07, 7.357147590036917e-07])</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># memeryview</span><span class="token keyword">import</span> this<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>The Zen of Python, by Tim Peters</p><p>Beautiful is better than ugly.<br>Explicit is better than implicit.<br>Simple is better than complex.<br>Complex is better than complicated.<br>Flat is better than nested.<br>Sparse is better than dense.<br>Readability counts.<br>Special cases arenâ€™t special enough to break the rules.<br>Although practicality beats purity.<br>Errors should never pass silently.<br>Unless explicitly silenced.<br>In the face of ambiguity, refuse the temptation to guess.<br>There should be oneâ€” and preferably only one â€”obvious way to do it.<br>Although that way may not be obvious at first unless youâ€™re Dutch.<br>Now is better than never.<br>Although never is often better than <em>right</em> now.<br>If the implementation is hard to explain, itâ€™s a bad idea.<br>If the implementation is easy to explain, it may be a good idea.<br>Namespaces are one honking great idea â€” letâ€™s do more of those!</p></blockquote><h2 id="2-6-queue"><a href="#2-6-queue" class="headerlink" title="2.6 queue"></a>2.6 queue</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># deque åŒå‘é˜Ÿåˆ—</span><span class="token keyword">from</span> collections <span class="token keyword">import</span> dequedq <span class="token operator">=</span> deque<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> maxlen<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dq<span class="token punctuation">)</span>dq<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dq<span class="token punctuation">)</span>dq<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dq<span class="token punctuation">)</span>dq<span class="token punctuation">.</span>appendleft<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dq<span class="token punctuation">)</span>dq<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dq<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>deque([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], maxlen=10)<br>deque([7, 8, 9, 0, 1, 2, 3, 4, 5, 6], maxlen=10)<br>deque([1, 2, 3, 4, 5, 6, 7, 8, 9, 0], maxlen=10)<br>deque([-1, 1, 2, 3, 4, 5, 6, 7, 8, 9], maxlen=10)<br>deque([3, 4, 5, 6, 7, 8, 9, 20, 30, 40], maxlen=10)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ä¼˜å…ˆé˜Ÿåˆ—</span><span class="token keyword">import</span> heapq<span class="token keyword">import</span> randoma <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>heapq<span class="token punctuation">.</span>heapify<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    heapq<span class="token punctuation">.</span>heappush<span class="token punctuation">(</span>a<span class="token punctuation">,</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>    x <span class="token operator">=</span> heapq<span class="token punctuation">.</span>heappop<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>[403, 433, 459, 476, 541, 985, 821, 855, 822, 855]<br>403<br>433<br>459<br>476<br>541<br>821<br>822<br>855<br>855<br>985</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> FluentPython </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter_01_The_Python_Data_Model</title>
      <link href="2020/12/01/python/fluentpython/chapter-01-the-python-data-model/"/>
      <url>2020/12/01/python/fluentpython/chapter-01-the-python-data-model/</url>
      
        <content type="html"><![CDATA[<h1 id="Chapter-01-The-Python-Data-Model"><a href="#Chapter-01-The-Python-Data-Model" class="headerlink" title="Chapter_01_The_Python_Data_Model"></a>Chapter_01_The_Python_Data_Model</h1><h2 id="1-1-Playing-Cards"><a href="#1-1-Playing-Cards" class="headerlink" title="1.1 Playing Cards"></a>1.1 Playing Cards</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> collectionsCard <span class="token operator">=</span> collections<span class="token punctuation">.</span>namedtuple<span class="token punctuation">(</span><span class="token string">'Card'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">,</span> <span class="token string">'suit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">FrenchDesk</span><span class="token punctuation">:</span>    ranks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'JQKA'</span><span class="token punctuation">)</span>    suits <span class="token operator">=</span> <span class="token string">'spades diamonds clubs hearts'</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>_cards <span class="token operator">=</span> <span class="token punctuation">[</span>Card<span class="token punctuation">(</span>rank<span class="token punctuation">,</span> suit<span class="token punctuation">)</span>                       <span class="token keyword">for</span> suit <span class="token keyword">in</span> self<span class="token punctuation">.</span>suits <span class="token keyword">for</span> rank <span class="token keyword">in</span> self<span class="token punctuation">.</span>ranks<span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_cards<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> position<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_cards<span class="token punctuation">[</span>position<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#è®¿é—®çº¸ç‰Œå¯¹è±¡</span>beer_card <span class="token operator">=</span> Card<span class="token punctuation">(</span><span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'diamonds'</span><span class="token punctuation">)</span>beer_card<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>   Card(rank=â€™7â€™, suit=â€™diamondsâ€™)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å®šä¹‰äº†lenä¹‹åå¯ä»¥æŸ¥çœ‹len</span>desk <span class="token operator">=</span> FrenchDesk<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">len</span><span class="token punctuation">(</span>desk<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>   52</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å®šä¹‰äº†getitemå¯ä»¥è®©å¯¹è±¡å˜æˆå¯è¿­ä»£çš„</span>desk<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>   Card(rank=â€™2â€™, suit=â€™spadesâ€™)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">desk<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>   Card(rank=â€™Aâ€™, suit=â€™heartsâ€™)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> choicechoice<span class="token punctuation">(</span>desk<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>   Card(rank=â€™6â€™, suit=â€™clubsâ€™)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">desk<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>[Card(rank=â€™2â€™, suit=â€™spadesâ€™),<br> Card(rank=â€™3â€™, suit=â€™spadesâ€™),<br> Card(rank=â€™4â€™, suit=â€™spadesâ€™)]</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> card <span class="token keyword">in</span> desk<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>Card(rank=â€™2â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™3â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™4â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™5â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™6â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™7â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™8â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™9â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™10â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™Jâ€™, suit=â€™spadesâ€™)<br>Card(rank=â€™Qâ€™, suit=â€™spadesâ€™)<br>Card(rank=â€™Kâ€™, suit=â€™spadesâ€™)<br>Card(rank=â€™Aâ€™, suit=â€™spadesâ€™)<br>Card(rank=â€™2â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™3â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™4â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™5â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™6â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™7â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™8â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™9â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™10â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™Jâ€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™Qâ€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™Kâ€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™Aâ€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™2â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™3â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™4â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™5â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™6â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™7â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™8â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™9â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™10â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™Jâ€™, suit=â€™clubsâ€™)<br>Card(rank=â€™Qâ€™, suit=â€™clubsâ€™)<br>Card(rank=â€™Kâ€™, suit=â€™clubsâ€™)<br>Card(rank=â€™Aâ€™, suit=â€™clubsâ€™)<br>Card(rank=â€™2â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™3â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™4â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™5â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™6â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™7â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™8â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™9â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™10â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™Jâ€™, suit=â€™heartsâ€™)<br>Card(rank=â€™Qâ€™, suit=â€™heartsâ€™)<br>Card(rank=â€™Kâ€™, suit=â€™heartsâ€™)<br>Card(rank=â€™Aâ€™, suit=â€™heartsâ€™)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">Card<span class="token punctuation">(</span><span class="token string">'Q'</span><span class="token punctuation">,</span> <span class="token string">'hearts'</span><span class="token punctuation">)</span> <span class="token keyword">in</span> desk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>True</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åŠ ä¸Šæ’åºçš„key</span>suits_value <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>spades<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> hearts<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> diamonds<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> clubs<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">spades_high</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">:</span>    rank_value <span class="token operator">=</span> FrenchDesk<span class="token punctuation">.</span>ranks<span class="token punctuation">.</span>index<span class="token punctuation">(</span>card<span class="token punctuation">.</span>rank<span class="token punctuation">)</span>    <span class="token keyword">return</span> rank_value<span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>suits_value<span class="token punctuation">)</span><span class="token operator">+</span>suits_value<span class="token punctuation">[</span>card<span class="token punctuation">.</span>suit<span class="token punctuation">]</span><span class="token keyword">for</span> card <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>desk<span class="token punctuation">,</span> key<span class="token operator">=</span>spades_high<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>Card(rank=â€™2â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™2â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™2â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™2â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™3â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™3â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™3â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™3â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™4â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™4â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™4â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™4â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™5â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™5â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™5â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™5â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™6â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™6â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™6â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™6â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™7â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™7â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™7â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™7â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™8â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™8â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™8â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™8â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™9â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™9â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™9â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™9â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™10â€™, suit=â€™clubsâ€™)<br>Card(rank=â€™10â€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™10â€™, suit=â€™heartsâ€™)<br>Card(rank=â€™10â€™, suit=â€™spadesâ€™)<br>Card(rank=â€™Jâ€™, suit=â€™clubsâ€™)<br>Card(rank=â€™Jâ€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™Jâ€™, suit=â€™heartsâ€™)<br>Card(rank=â€™Jâ€™, suit=â€™spadesâ€™)<br>Card(rank=â€™Qâ€™, suit=â€™clubsâ€™)<br>Card(rank=â€™Qâ€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™Qâ€™, suit=â€™heartsâ€™)<br>Card(rank=â€™Qâ€™, suit=â€™spadesâ€™)<br>Card(rank=â€™Kâ€™, suit=â€™clubsâ€™)<br>Card(rank=â€™Kâ€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™Kâ€™, suit=â€™heartsâ€™)<br>Card(rank=â€™Kâ€™, suit=â€™spadesâ€™)<br>Card(rank=â€™Aâ€™, suit=â€™clubsâ€™)<br>Card(rank=â€™Aâ€™, suit=â€™diamondsâ€™)<br>Card(rank=â€™Aâ€™, suit=â€™heartsâ€™)<br>Card(rank=â€™Aâ€™, suit=â€™spadesâ€™)</p></blockquote><h2 id="1-2-A-simple-two-dimensional-vector-class"><a href="#1-2-A-simple-two-dimensional-vector-class" class="headerlink" title="1.2 A simple two-dimensional vector class"></a>1.2 A simple two-dimensional vector class</h2><p><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206232143.png" alt="Special method names (operators excluded)"><br><img src="https://cdn.jsdelivr.net/gh/ZqtCtios/Image/img/20201206232143.png" alt="Special method names for operators"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> math <span class="token keyword">import</span> hypot<span class="token keyword">class</span> <span class="token class-name">Vector</span><span class="token punctuation">:</span>        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y        <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'Vector(</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>y<span class="token punctuation">}</span></span><span class="token string">)'</span></span>        <span class="token keyword">def</span> <span class="token function">__abs__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> hypot<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">__bool__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token builtin">bool</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">__add__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x        y <span class="token operator">=</span> self<span class="token punctuation">.</span>y <span class="token operator">+</span> other<span class="token punctuation">.</span>y        <span class="token keyword">return</span> Vector<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">__mul__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> scalar<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> Vector<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token operator">*</span>scalar<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token operator">*</span>scalar<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">v1 <span class="token operator">=</span> Vector<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>v2 <span class="token operator">=</span> Vector<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> v2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>Vector(3, 6)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">abs</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>2.23606797749979</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">v1<span class="token operator">*</span><span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>Vector(3, 6)</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> FluentPython </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter_04_Text_versus_Bytes</title>
      <link href="2020/12/01/python/fluentpython/chapter-04-text-versus-bytes/"/>
      <url>2020/12/01/python/fluentpython/chapter-04-text-versus-bytes/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ç¼–ç å’Œè§£ç </span>s <span class="token operator">=</span> <span class="token string">'cafä¸­å›½'</span><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>b <span class="token operator">=</span> s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>s <span class="token operator">=</span> b<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>cafä¸­å›½ 5<br>bâ€™caf\xe4\xb8\xad\xe5\x9b\xbdâ€™ 9<br>cafä¸­å›½ 5</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">s1 <span class="token operator">=</span> <span class="token string">'cafeÌ'</span><span class="token keyword">print</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>b <span class="token operator">=</span> s1<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>s2 <span class="token operator">=</span> <span class="token string">'cafÃ©'</span><span class="token keyword">print</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span>b <span class="token operator">=</span> s2<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>cafeÌ 5<br>bâ€™cafe\xcc\x81â€™ 6<br>cafÃ© 4<br>bâ€™caf\xc3\xa9â€™ 5</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> unicodedata <span class="token keyword">import</span> normalize<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>normalize<span class="token punctuation">(</span><span class="token string">'NFC'</span><span class="token punctuation">,</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>normalize<span class="token punctuation">(</span><span class="token string">'NFC'</span><span class="token punctuation">,</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>4 4</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># byteså’Œbytearrayï¼Œbyteså­˜å‚¨çš„æ˜¯æ•´æ•°</span><span class="token comment"># bytesåˆ‡ç‰‡è¿˜æ˜¯byteså¯¹è±¡ï¼ŒbytearrayåŒæ ·</span>cafe <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">'cafÃ©'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cafe<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cafe<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">for</span> b <span class="token keyword">in</span> cafe<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>cafe_arr <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>cafe<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cafe_arr<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cafe_arr<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>bâ€™caf\xc3\xa9â€™<br>bâ€™câ€™<br>99<br>97<br>102<br>195<br>169<br>bytearray(bâ€™caf\xc3\xa9â€™)<br>bytearray(bâ€™\xa9â€™)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> arraynumbers<span class="token operator">=</span>array<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>octets<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>octets<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>b'\xfe\xff\xff\xff\x00\x00\x01\x00\x02\x00'</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># é»˜è®¤ç¼–ç </span><span class="token keyword">import</span> sys<span class="token punctuation">,</span> localeexpressions <span class="token operator">=</span> <span class="token triple-quoted-string string">"""        locale.getpreferredencoding()        type(my_file)        my_file.encoding        sys.stdout.isatty()        sys.stdout.encoding        sys.stdin.isatty()        sys.stdin.encoding        sys.stderr.isatty()        sys.stderr.encoding        sys.getdefaultencoding()        sys.getfilesystemencoding()"""</span>my_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'dummy'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token keyword">for</span> expression <span class="token keyword">in</span> expressions<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    value <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>expression<span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'-&gt;'</span><span class="token punctuation">,</span> <span class="token builtin">repr</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p> locale.getpreferredencoding() -&gt; â€˜UTF-8â€™<br>                 type(my_file) -&gt; <class '_io.textiowrapper'=""><br>              my_file.encoding -&gt; â€˜UTF-8â€™<br>           sys.stdout.isatty() -&gt; False<br>           sys.stdout.encoding -&gt; â€˜UTF-8â€™<br>            sys.stdin.isatty() -&gt; False<br>            sys.stdin.encoding -&gt; â€˜UTF-8â€™<br>           sys.stderr.isatty() -&gt; False<br>           sys.stderr.encoding -&gt; â€˜UTF-8â€™<br>      sys.getdefaultencoding() -&gt; â€˜utf-8â€™<br>   sys.getfilesystemencoding() -&gt; â€˜utf-8â€™</class></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> FluentPython </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
